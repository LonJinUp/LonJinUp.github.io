<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://lonjinup.github.io</id>
    <title>é™‡é”¦</title>
    <updated>2025-07-03T11:43:39.573Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://lonjinup.github.io"/>
    <link rel="self" href="https://lonjinup.github.io/atom.xml"/>
    <subtitle>è®°å½•å­¦ä¹  è®°å½•ç”Ÿæ´»</subtitle>
    <logo>https://lonjinup.github.io/images/avatar.png</logo>
    <icon>https://lonjinup.github.io/favicon.ico</icon>
    <rights>All rights reserved 2025, é™‡é”¦</rights>
    <entry>
        <title type="html"><![CDATA[å°ç¨‹åºè‡ªåŠ¨ä¸Šä¼ è„šæœ¬]]></title>
        <id>https://lonjinup.github.io/mpweixin-upload/</id>
        <link href="https://lonjinup.github.io/mpweixin-upload/">
        </link>
        <updated>2025-07-03T02:08:08.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å°ç¨‹åºè‡ªåŠ¨ä¸Šä¼ è„šæœ¬">å°ç¨‹åºè‡ªåŠ¨ä¸Šä¼ è„šæœ¬</h1>
<blockquote>
<p>å¹³æ—¶å¤šäººå¼€å‘å°ç¨‹åºç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šAå¼€å‘å®Œæˆåï¼Œä¸Šä¼ äº†ä½“éªŒç‰ˆï¼Œç„¶åBä¹Ÿè¿›è¡Œå¼€å‘ï¼Œå¼€å‘å®Œæˆåä¸Šä¼ ä½“éªŒç‰ˆï¼Œè¿˜éœ€è¦å»åå°è®¾ç½®ä½“éªŒç‰ˆä¸ºBçš„ä»£ç ï¼Œè¿™æ ·å°±å¾ˆéº»çƒ¦äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾®ä¿¡å°ç¨‹åºæä¾›çš„<code>miniprogram-ci</code>åŒ…æ¥å®ç°è‡ªåŠ¨ä¸Šä¼ ã€‚ç”±äºæˆ‘ç»å¸¸ä½¿ç”¨<code>uni-app</code>æ¥å¼€å‘å°ç¨‹åºï¼Œæ‰€ä»¥æˆ‘æŠŠè„šæœ¬æ”¾åœ¨äº†<code>uni-app</code>çš„<code>/upload</code>ç›®å½•ä¸‹ï¼Œé…åˆæ‰“åŒ…å‘½ä»¤å³å¯å®ç°æ‰“åŒ…åè‡ªåŠ¨ä¸Šä¼ ä»£ç ã€‚</p>
</blockquote>
<h2 id="ä»£ç å®ç°">ä»£ç å®ç°</h2>
<pre><code class="language-js">const { execSync } = require('child_process');
const ci = require('miniprogram-ci');
const packageJson = require('../package.json');
const fs = require('fs');
const path = require('path');

/**
 * è·å–å½“å‰ Gitç”¨æˆ·å
 * @returns {string} è¿”å› Git ç”¨æˆ·å
 */
function getGitInfo() {
    try {
        const branch = execSync('git rev-parse --abbrev-ref HEAD').toString().trim();
        const user = execSync('git config user.name').toString().trim();
        return { branch, user };
    } catch (error) {
        console.error('è·å– Git ä¿¡æ¯å¤±è´¥:', error);
        return null;
    }
}

/**
 * ä¿®æ”¹ç‰ˆæœ¬å·
 */
function changeVersion() {
    const packageJsonPath = path.join(__dirname, '../package.json');
    const packageJson = JSON.parse(fs.readFileSync(packageJsonPath, 'utf8'));
    const version = packageJson.version;
    const versionParts = version.split('.').map(Number);
    const env = process.env.NODE_ENV || 'test';
    if (env === 'master') {
        versionParts[2] += 1;
        if (versionParts[2] &gt; 9) {
            versionParts[2] = 0;
            versionParts[1] += 1;
        }
        if (versionParts[1] &gt; 9) {
            versionParts[1] = 0;
            versionParts[0] += 1;
        }
    }
    packageJson.version = versionParts.join('.');
    fs.writeFileSync(packageJsonPath, JSON.stringify(packageJson, null, 4), 'utf8');
    console.log('æœ€æ–°ç‰ˆæœ¬å·ä¸ºï¼š', packageJson.version);
    return version;
}

/**
 * åˆå§‹åŒ–é¡¹ç›®ä¿¡æ¯
 * @returns {ci.Project} è¿”å› ci.Project å¯¹è±¡
 */
function initProjectInfo() {
    return new ci.Project({
        appid: packageJson.appid,
        type: 'miniProgram',
        projectPath: './dist/build/mp-weixin',
        privateKeyPath: './upload/private.xxxxxxxxxx.key',
    });
}

async function upload() {
    try {
        const project = initProjectInfo();
        const { user, branch } = getGitInfo();
        const version = changeVersion();
        console.log('â³å¼€å§‹ä¸Šä¼ ');
        const uploadResult = await ci.upload({
            project,
            version,
            desc: `${user}åœ¨${branch}åˆ†æ”¯ä¸Šä¼ äº†ä½“éªŒç‰ˆæœ¬: ${version}`,
            robot: 10,
            setting: {
                es6: true,
            },
            onProgressUpdate: console.log,
        });
        console.log('âœ…ä¸Šä¼ æˆåŠŸ');
        process.exit(0);
    } catch (e) {
        console.error('âŒä¸Šä¼ å¤±è´¥:', e);
    }
}
upload();
</code></pre>
<p><code>package.json</code>ä¸­æ·»åŠ ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="language-js">{
    &quot;name&quot;: &quot;uni-preset-vue&quot;,
    &quot;version&quot;: &quot;0.0.3&quot;,
    &quot;appid&quot;: &quot;xxxxxxxxxx&quot;,
    &quot;scripts&quot;: {
        &quot;buildTest:mp-weixin&quot;: &quot;uni build -p mp-weixin --mode test &amp;&amp; node upload/index.js&quot;,
        &quot;buildPre:mp-weixin&quot;: &quot;uni build -p mp-weixin --mode pre &amp;&amp; node upload/index.js&quot;,
        &quot;buildMaster:mp-weixin&quot;: &quot;uni build -p mp-weixin --mode master &amp;&amp; node upload/index.js&quot;
    },
}
</code></pre>
<h2 id="è¿è¡Œ">è¿è¡Œ</h2>
<pre><code class="language-bash">npm run buildTest:mp-weixin
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è·¨æ ‡ç­¾é¡µé€šä¿¡ç¥å™¨ï¼šæ·±å…¥äº†è§£BroadcastChannelçš„å¦™ç”¨]]></title>
        <id>https://lonjinup.github.io/BroadcastChannel-study/</id>
        <link href="https://lonjinup.github.io/BroadcastChannel-study/">
        </link>
        <updated>2024-07-15T09:22:05.000Z</updated>
        <content type="html"><![CDATA[<h3 id="è·¨æ ‡ç­¾é¡µé€šä¿¡ç¥å™¨æ·±å…¥äº†è§£-broadcastchannel-çš„å¦™ç”¨">è·¨æ ‡ç­¾é¡µé€šä¿¡ç¥å™¨ï¼šæ·±å…¥äº†è§£ <code>BroadcastChannel</code> çš„å¦™ç”¨</h3>
<blockquote>
<p>æœ€è¿‘åœ¨åšé¡¹ç›®é‡åˆ°ä¸€ä¸ªåœºæ™¯ï¼šåœ¨é¡¹ç›®æ‰“å¼€æ—¶å€™è¿æ¥ä¸€ä¸ª websocketï¼Œåœ¨åˆå§‹åŒ–ã€æ”¶åˆ°æ¨é€æ¶ˆæ¯ç­‰åœºæ™¯ä¸‹ï¼Œå…¶ä»–é¡µé¢éœ€è¦åŒæ­¥è¿›è¡Œä¸€äº›æ“ä½œï¼Œæ‰€ä»¥éœ€è¦å»ºç«‹æ¶ˆæ¯å¹¿æ’­é€šçŸ¥ç»™éœ€è¦çš„é¡µé¢ã€‚ä¸‹é¢æ˜¯æˆ‘æƒ³åˆ°çš„ä¸€äº›å®ç°æ–¹æ¡ˆã€‚</p>
</blockquote>
<h2 id="æ–¹æ¡ˆå¯¹æ¯”">æ–¹æ¡ˆå¯¹æ¯”</h2>
<table>
<thead>
<tr>
<th>æ–¹æ¡ˆ</th>
<th>å®ç°æ€è·¯</th>
<th>æ¨èæŒ‡æ•°</th>
<th>ä¼˜ç‚¹</th>
<th>ç¼ºç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Pinia (Vue é¡¹ç›®)</strong></td>
<td>ä½¿ç”¨ Vue çš„çŠ¶æ€ç®¡ç†å·¥å…· Piniaï¼Œåœ¨ä¸€ä¸ªæ ‡ç­¾é¡µä¸­æ›´æ–°çŠ¶æ€ï¼Œå…¶ä»–æ ‡ç­¾é¡µè®¢é˜…çŠ¶æ€å˜åŒ–å¹¶ä½œå‡ºå“åº”ã€‚</td>
<td>â­â­â­â­</td>
<td>é›†æˆ Vue é¡¹ç›®æ–¹ä¾¿ï¼ŒçŠ¶æ€ç®¡ç†å¼ºå¤§</td>
<td>ä»…é€‚ç”¨äº Vue é¡¹ç›®ï¼Œéœ€è¦é¢å¤–é…ç½®</td>
</tr>
<tr>
<td><strong>localStorage æˆ– sessionStorage</strong></td>
<td>ä½¿ç”¨ <code>localStorage</code> æˆ– <code>sessionStorage</code> å­˜å‚¨äº‹ä»¶æ•°æ®ï¼Œå¹¶é€šè¿‡ç›‘å¬ <code>storage</code> äº‹ä»¶åœ¨å…¶ä»–æ ‡ç­¾é¡µä¸­æ¥æ”¶æ¶ˆæ¯ã€‚</td>
<td>â­â­â­</td>
<td>ç®€å•æ˜“ç”¨ï¼Œæ— éœ€é¢å¤–åº“</td>
<td>äº‹ä»¶å¤„ç†è¾ƒä¸ºå¤æ‚ï¼Œä¼ é€’å¤æ‚æ•°æ®æœ‰å±€é™æ€§</td>
</tr>
<tr>
<td><strong>BroadcastChannel</strong></td>
<td>ä½¿ç”¨ <code>BroadcastChannel</code> åˆ›å»ºé¢‘é“ï¼Œåœ¨ä¸åŒæ ‡ç­¾é¡µä¸­å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚</td>
<td>â­â­â­â­â­</td>
<td>åŸç”Ÿæ”¯æŒï¼Œå¤šæµè§ˆä¸Šä¸‹æ–‡é€šä¿¡ç®€å•ç›´è§‚</td>
<td>ä»…æ”¯æŒåŒæºé¡µé¢ï¼Œéœ€è¦è¾ƒæ–°æµè§ˆå™¨æ”¯æŒ</td>
</tr>
</tbody>
</table>
<p>è€ƒè™‘åˆ°é¡¹ç›®ä¸­åŠŸèƒ½æ¨¡å—å¤ç”¨æ€§ï¼Œå¤šä¸ªé¡¹ç›®å¯èƒ½éƒ½ä¼šç”¨åˆ°ï¼Œæ‰€ä»¥æ–¹æ¡ˆ1ç›´æ¥passï¼›å»ç›‘å¬<strong>localStorageæˆ–sessionStorage</strong>ä¹Ÿè¿‡äºç¹çï¼Œæ‰€ä»¥ä¹Ÿç›´æ¥passï¼›ç”±äºæ˜¯bç«¯é¡¹ç›®ï¼Œæ— éœ€è€ƒè™‘æµè§ˆå™¨å…¼å®¹çš„é—®é¢˜ï¼Œè€Œä¸”<strong>BroadcastChannel</strong> åœ¨ç»å¤§éƒ¨åˆ†æµè§ˆå™¨ä¸Šæ˜¯æ”¯æŒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥é‡‡ç”¨æ–¹æ¡ˆ3å³å¯ã€‚</p>
<h2 id="broadcastchannelä»‹ç»">BroadcastChannelä»‹ç»</h2>
<p><code>BroadcastChannel</code> æ˜¯ä¸€ç§ Web APIï¼Œå…è®¸åŒä¸€æ¥æºçš„ä¸åŒæµè§ˆä¸Šä¸‹æ–‡ï¼ˆå¦‚æ ‡ç­¾é¡µã€iframe æˆ– Web workerï¼‰ä¹‹é—´è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚è¿™ç§æœºåˆ¶ä½¿å¾—åœ¨åŒä¸€ç«™ç‚¹çš„ä¸åŒé¡µé¢ä¹‹é—´åŒæ­¥æ•°æ®å˜å¾—éå¸¸ç®€å•å’Œé«˜æ•ˆã€‚</p>
<h4 id="ç‰¹æ€§">ç‰¹æ€§</h4>
<ul>
<li><strong>åŒæºç­–ç•¥</strong>ï¼š<code>BroadcastChannel</code> åªå…è®¸åŒä¸€æ¥æºçš„é¡µé¢ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚</li>
<li><strong>å®æ—¶é€šä¿¡</strong>ï¼šæ¶ˆæ¯ä¼ é€’æ˜¯å³æ—¶çš„ï¼Œæ²¡æœ‰æ˜¾è‘—å»¶è¿Ÿã€‚</li>
<li><strong>ç®€æ´æ˜“ç”¨</strong>ï¼šAPI ç®€å•ç›´è§‚ï¼Œæ˜“äºä¸Šæ‰‹ã€‚</li>
</ul>
<h4 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</h4>
<ul>
<li><strong>å¤šæ ‡ç­¾é¡µåŒæ­¥</strong>ï¼šç”¨æˆ·åœ¨ä¸€ä¸ªæ ‡ç­¾é¡µä¸­è¿›è¡Œçš„æ“ä½œå¯ä»¥å®æ—¶åŒæ­¥åˆ°å…¶ä»–æ ‡ç­¾é¡µã€‚</li>
<li><strong>è·¨ iframe é€šä¿¡</strong>ï¼šåœ¨ä¸åŒçš„ iframe ä¹‹é—´ä¼ é€’æ¶ˆæ¯ï¼Œæ— éœ€é€šè¿‡çˆ¶é¡µé¢ä¸­è½¬ã€‚</li>
<li><strong>Web worker é€šä¿¡</strong>ï¼šåœ¨ä¸»çº¿ç¨‹å’Œå¤šä¸ª Web worker ä¹‹é—´å®ç°é«˜æ•ˆé€šä¿¡ã€‚</li>
</ul>
<h4 id="ç¤ºä¾‹">ç¤ºä¾‹</h4>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>BroadcastChannel</code> è¿›è¡Œæ¶ˆæ¯ä¼ é€’çš„åŸºæœ¬ç¤ºä¾‹ï¼š</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;BroadcastChannel - Sender&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;input type=&quot;text&quot; id=&quot;inputBox&quot;&gt;
    &lt;button id=&quot;sendMessageButton&quot;&gt;å‘é€&lt;/button&gt;
    &lt;script&gt;
        const channel = new BroadcastChannel('example_channel');
        document.getElementById('sendMessageButton').addEventListener('click', () =&gt; {
            const message = { type: 'update', content: document.getElementById('inputBox').value };
            channel.postMessage(message);
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
<p>é¡µé¢Bæ¥æ”¶æ¶ˆæ¯ï¼š</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;BroadcastChannel - Receiver&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;æ¥æ”¶æ¶ˆæ¯&lt;/h1&gt;
    &lt;div id=&quot;messages&quot;&gt;&lt;/div&gt;
    &lt;button id=&quot;closeMessage&quot;&gt;æ–­å¼€&lt;/button&gt;
    &lt;script&gt;
        const channel = new BroadcastChannel('example_channel');
        channel.onmessage = function(event) {
            const message = event.data;
            const messagesDiv = document.getElementById('messages');
            const messageElement = document.createElement('div');
            messageElement.textContent = `Type: ${message.type}, Content: ${message.content}`;
            messagesDiv.appendChild(messageElement);
        };
        document.getElementById('closeMessage').addEventListener('click', () =&gt; {
           channel.close();
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
<p>é€šè¿‡ä»¥ä¸Šä»£ç ï¼Œä¸åŒçš„æµè§ˆä¸Šä¸‹æ–‡ï¼ˆå¦‚ä¸åŒæ ‡ç­¾é¡µï¼‰å¯ä»¥åœ¨åŒä¸€ç«™ç‚¹å†…é€šè¿‡ <code>example_channel</code> é¢‘é“è¿›è¡Œæ¶ˆæ¯ä¼ é€’ï¼Œä»è€Œå®ç°æ•°æ®åŒæ­¥å’Œé€šä¿¡ï¼›å¦‚æœä¸å†ä½¿ç”¨å¯ä»¥è°ƒç”¨<code>close()</code>æ–¹æ³•è¿›è¡Œå…³é—­ï¼Œè¿™æ ·å°±å¯ä»¥è®©å…¶è¢«åƒåœ¾å›æ”¶ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<blockquote>
<p>é€šè¿‡å¯¹æ¯”ä¸åŒçš„å®ç°æ–¹æ¡ˆï¼Œæœ€ç»ˆé€‰æ‹©ä½¿ç”¨ <code>BroadcastChannel</code> ä½œä¸ºè·¨æ ‡ç­¾é¡µé€šä¿¡çš„è§£å†³æ–¹æ¡ˆã€‚<code>BroadcastChannel</code> çš„ä¼˜åŠ¿åœ¨äºå…¶åŸç”Ÿæ”¯æŒï¼Œèƒ½å¤Ÿå®ç°å¤šæµè§ˆä¸Šä¸‹æ–‡ä¹‹é—´çš„ç®€å•ç›´è§‚çš„é€šä¿¡ï¼Œç‰¹åˆ«é€‚ç”¨äºéœ€è¦é«˜æ•ˆå®æ—¶é€šä¿¡çš„åœºæ™¯ã€‚å°½ç®¡åªæ”¯æŒåŒæºé¡µé¢ä¸”éœ€è¦è¾ƒæ–°çš„æµè§ˆå™¨æ”¯æŒï¼Œä½†åœ¨å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨ä¸Šéƒ½èƒ½æ­£å¸¸è¿è¡Œã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ ¹æ®é¡¹ç›®éœ€æ±‚å»å¯»æ‰¾æœ€é€‚åˆçš„æŠ€æœ¯æ–¹æ¡ˆï¼Œä»é¡¹ç›®è§’åº¦å‡ºå‘ã€‚</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA["WebSocketæ¶ˆæ¯æ¨é€ï¼šå‰ç«¯å®ç°å®æ—¶é€šçŸ¥åŠŸèƒ½å…¨è¿‡ç¨‹è§£æ"]]></title>
        <id>https://lonjinup.github.io/WebSocketManager/</id>
        <link href="https://lonjinup.github.io/WebSocketManager/">
        </link>
        <updated>2024-01-15T08:03:08.000Z</updated>
        <content type="html"><![CDATA[<h1 id="websocketæ¶ˆæ¯æ¨é€">WebSocketæ¶ˆæ¯æ¨é€</h1>
<blockquote>
<p>åœ¨åšä¸€äº›åå°é¡¹ç›®çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™éœ€è¦å‰ç«¯å»å®æ—¶æ¥æ”¶æ¶ˆæ¯ï¼›ä¸€ç§æ¯”è¾ƒåŸå§‹çš„åšæ³•å°±æ˜¯å‰ç«¯æ¯éš”ä¸€æ®µæ—¶é—´ä¸»åŠ¨å»è½®è¯¢æœåŠ¡å™¨ï¼Œå¦‚æœç”¨æˆ·è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œä¼šç»™æœåŠ¡å™¨é€ æˆä¸€å®šçš„å‹åŠ›ï¼Œè€Œä¸”è®¿é—®çš„é¢‘ç‡ä¹Ÿæ— æ³•å‡†ç¡®æŠŠæ¡ï¼Œæ‰€ä»¥è¿™ç§éœ€æ±‚è¿˜æ˜¯ä½¿ç”¨<code>websocket</code>æ¥è§£å†³ã€‚ ä¸‹é¢æˆ‘ä»¬å°±ä»0åˆ°1å°è£…ä¸€å¥—<code>websocket</code>æ¶ˆæ¯æ¨é€åŠŸèƒ½æ¨¡å—ã€‚æ–‡ç« æ¶‰åŠåˆ°çš„çŸ¥è¯†å‡ä¸ºå‰ç«¯éƒ¨åˆ†ï¼Œåç«¯éƒ¨åˆ†æˆ‘ä»¬å°±ä¸å±•å¼€æ¥è¯´äº†ã€‚å¦‚æœæ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ğŸ‘ç‚¹èµğŸŒŸæ”¶è—ï¼</p>
</blockquote>
<h2 id="éœ€æ±‚æ¢³ç†">éœ€æ±‚æ¢³ç†</h2>
<p>æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨<code>class</code>æ¥å°è£…ï¼Œè¯¥æ¨¡å—éœ€è¦æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li><code>WebSocket</code>å¯¹è±¡çš„åˆ›å»º</li>
<li><code>WebSocket</code>å¯¹è±¡çš„å…³é—­</li>
<li>å¯ç”¨å¿ƒè·³æœºåˆ¶ï¼Œé¿å…æ–­è¿</li>
<li>æ¶ˆæ¯æ¨é€ï¼Œæ¥æ”¶åˆ°æ¶ˆæ¯åè¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†</li>
<li>é‡è¿æœºåˆ¶ï¼Œå¦‚æœæ–­è¿åå°è¯•ä¸€å®šæ¬¡æ•°çš„é‡è¿ï¼Œè¶…è¿‡æœ€å¤§æ¬¡æ•°åä»ç„¶å¤±è´¥åˆ™å…³é—­è¿æ¥</li>
</ul>
<p>ä¸‹é¢æˆ‘ä»¬å°±é€ä¸€å®ç°è¿™äº›åŠŸèƒ½ã€‚</p>
<h2 id="åŠŸèƒ½å®ç°">åŠŸèƒ½å®ç°</h2>
<h3 id="åˆ›å»ºwebsocketç±»">åˆ›å»ºWebSocketç±»</h3>
<p>æ–°å»º<code>WebSocketManager.js</code>æ–‡ä»¶ï¼Œåˆ›å»ºä¸€ä¸ª<code>WebSocketManager</code>ç±»ï¼ŒåŒæ—¶åˆå§‹åŒ–ä¸€äº›å‚æ•°ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">export default class WebSocketManager {
    constructor(url = null, userId = null, receiveMessageCallback = null) {
        this.socket = null // WebSocket å¯¹è±¡
        this.pingTimeout = null // å¿ƒè·³è®¡æ—¶å™¨
        this.reconnectTimeout = 5000 // é‡è¿é—´éš”ï¼Œå•ä½ï¼šæ¯«ç§’
        this.maxReconnectAttempts = 10 // æœ€å¤§é‡è¿å°è¯•æ¬¡æ•°
        this.reconnectAttempts = 0; // å½“å‰é‡è¿å°è¯•æ¬¡æ•°
        this.id = userId //ç”¨æˆ·IDï¼ˆä¸šåŠ¡é€»è¾‘ï¼Œæ ¹æ®è‡ªå·±ä¸šåŠ¡éœ€æ±‚è°ƒæ•´ï¼‰
        this.url = url // WebSocket è¿æ¥åœ°å€
        this.receiveMessageCallback = receiveMessageCallback // æ¥æ”¶æ¶ˆæ¯å›è°ƒå‡½æ•°
    }
}
</code></pre>
<h3 id="åˆå§‹åŒ–websocketå¯¹è±¡">åˆå§‹åŒ–WebSocketå¯¹è±¡</h3>
<p>åˆå§‹åŒ–å®Œæˆåï¼Œæˆ‘ä»¬å…ˆå®ç°ä¸€ä¸ª<code>initialize</code>æ–¹æ³•ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬è¦ç›‘æµ‹ä¸€ä¸‹ä½¿ç”¨æ—¶å€™æ˜¯å¦ä¼ å…¥äº†<code>webSocket</code>è¿æ¥çš„æœåŠ¡å™¨åœ°å€ã€ç”¨æˆ·<code>id</code>ç­‰ï¼›å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œåˆ™è¿æ¥<code>WebSocket</code>ã€‚</p>
<pre><code class="language-js">export default class WebSocketManager {
    constructor() {
        // ...çœç•¥
    }
    /**
     * åˆå§‹åŒ–
     */
    async start() {
        if( this.url &amp;&amp; this.id){
            // è¿æ¥WebSocket
            this.connectWebSocket()
        }else{
            console.error('WebSocketManager erros: è¯·ä¼ å…¥è¿æ¥åœ°å€å’Œç”¨æˆ·id')
        }
    }
}
</code></pre>
<h3 id="åˆ›å»ºwebsocketè¿æ¥">åˆ›å»ºWebSocketè¿æ¥</h3>
<p>åˆå§‹åŒ–å®Œæˆåï¼Œæˆ‘ä»¬å°±å¼€å§‹æ¥å®ç°ä¸€ä¸‹<code>WebSocket</code>è¿æ¥ï¼Œæ ‡å‡†çš„<code>WebSocket</code>æ„é€ å‡½æ•°ä»¥<code>url</code>ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œè¿™é‡Œæ ¹æ®æœåŠ¡ç«¯é‚£è¾¹çš„çº¦å®šå»è¿›è¡Œå¤„ç†å³å¯ï¼Œè¿™é‡Œè¦æ±‚ä¼ å…¥<code>ç”¨æˆ·id+ä¸€ä¸ªéšæœºå€¼</code>å»ç”Ÿæˆå”¯ä¸€æ ‡è¯†ç¬¦ã€‚</p>
<pre><code class="language-js">export default class WebSocketManager {
    constructor() {
        // ...çœç•¥
    }
    /**
     * åˆ›å»ºWebSocketè¿æ¥
     */
    connectWebSocket() {
        // é€šè¿‡idç”Ÿæˆå”¯ä¸€å€¼ï¼ˆæœåŠ¡ç«¯è¦æ±‚ï¼Œå…·ä½“æ ¹æ®è‡ªå·±ä¸šåŠ¡å»è°ƒæ•´ï¼‰
        let id = `${this.id}-${Math.random()}`
        // åˆ›å»º WebSocket å¯¹è±¡
        this.socket = new WebSocket(this.url, id)

        // å¤„ç†è¿æ¥æ‰“å¼€äº‹ä»¶
        this.socket.addEventListener('open', event =&gt; {
            // å¿ƒè·³æœºåˆ¶
            this.startHeartbeat()
        })

        // å¤„ç†æ¥æ”¶åˆ°æ¶ˆæ¯äº‹ä»¶
        this.socket.addEventListener('message', event =&gt; {
            this.receiveMessage(event)
        })

        // å¤„ç†è¿æ¥å…³é—­äº‹ä»¶
        this.socket.addEventListener('close', event =&gt; {
            // æ¸…é™¤å®šæ—¶å™¨
            clearTimeout(this.pingTimeout)
            clearTimeout(this.reconnectTimeout)
            // å°è¯•é‡è¿
            if (this.reconnectAttempts &lt; this.maxReconnectAttempts) {
                this.reconnectAttempts++
                this.reconnectTimeout = setTimeout(() =&gt; {
                    this.connectWebSocket()
                }, this.reconnectTimeout)
            } else {
                // é‡ç½®é‡è¿æ¬¡æ•°
                this.reconnectAttempts = 0
                console.error('WebSocketManager erros: Max reconnect attempts reached. Unable to reconnect.')
            }
        })

        // å¤„ç† WebSocket é”™è¯¯äº‹ä»¶
        this.socket.addEventListener('error', event =&gt; {
            console.error('WebSocketManager error:', event)
        })
    }
}
</code></pre>
<h3 id="å¿ƒè·³æœºåˆ¶">å¿ƒè·³æœºåˆ¶</h3>
<p>å¿ƒè·³æœºåˆ¶ä¸»è¦ç”¨äºæ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦åœ¨çº¿ï¼Œå¦‚æœå®¢æˆ·ç«¯è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰å‘é€æ¶ˆæ¯ï¼ŒæœåŠ¡ç«¯å°±ä¼šæ–­å¼€è¿æ¥ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ¯éš”ä¸€æ®µæ—¶é—´å‘é€ä¸€ä¸ªå¿ƒè·³æ¶ˆæ¯ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…é•¿æ—¶é—´çš„è¿æ¥æ–­å¼€ã€‚å…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">export default class WebSocketManager {
    constructor() {
        // ...çœç•¥
    }

    /**
     * å¯åŠ¨å¿ƒè·³æœºåˆ¶
     */
    startHeartbeat() {
        this.pingTimeout = setInterval(() =&gt; {
            // å‘é€å¿ƒè·³æ¶ˆæ¯
            this.sendMessage('ping')
        }, 10000) // æ¯éš” 10 ç§’å‘é€ä¸€æ¬¡å¿ƒè·³
    }

    /**
     * å‘é€æ¶ˆæ¯
     * @param {String} message æ¶ˆæ¯å†…å®¹
     */
    sendMessage(message) {
       if (this.socket.readyState === WebSocket.OPEN) {
            this.socket.send(message);
        } else {
            console.error('WebSocketManager error: WebSocket connection is not open. Unable to send message.')
        }
    }
}
</code></pre>
<h3 id="æ¥æ”¶æ¶ˆæ¯">æ¥æ”¶æ¶ˆæ¯</h3>
<p>è¿™é‡Œæˆ‘ä»¬åªç®€å•å¤„ç†ä¸€ä¸‹ï¼Œæ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œæˆ‘ä»¬æ ¹æ®æ¶ˆæ¯å†…å®¹åšä¸åŒçš„å¤„ç†ã€‚</p>
<pre><code class="language-js">export default class WebSocketManager {
    constructor() {
        // ...çœç•¥
    }
    /**
     * æ¥æ”¶åˆ°æ¶ˆæ¯
     */
    receiveMessage(event) {
        // æ ¹æ®ä¸šåŠ¡è‡ªè¡Œå¤„ç†
        console.log('receiveMessage:', event.data)
        this.receiveMessageCallback &amp;&amp; receiveMessageCallback(event.data)
    }
}
</code></pre>
<h3 id="å…³é—­è¿æ¥">å…³é—­è¿æ¥</h3>
<p>å¦‚æœç”¨æˆ·è¦é€€å‡ºç™»å½•ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªæ–¹æ³•æ¥å®ç°å…³é—­è¿æ¥ï¼ŒåŒæ—¶æ¸…é™¤å®šæ—¶å™¨ä»¥åŠå½“å‰é‡è¿å°è¯•æ¬¡æ•°ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">export default class WebSocketManager {
    constructor() {
        // ...çœç•¥
    }
    /**
     * å…³é—­è¿æ¥
     */
    closeWebSocket() {
        this.socket.close()
        // æ¸…é™¤å®šæ—¶å™¨ é‡ç½®é‡è¿æ¬¡æ•°
        clearTimeout(this.pingTimeout)
        clearTimeout(this.reconnectTimeout)
        this.reconnectAttempts = 0
    }
}
</code></pre>
<h3 id="ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</h3>
<p>å¯¼å…¥<code>WebSocketManager</code>åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å®ƒäº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="language-js">/**
 * æ¥æ”¶æ¶ˆæ¯å›è°ƒ
 */
const receiveMessage = (res)=&gt;{
    console.log('æ¥æ”¶æ¶ˆæ¯å›è°ƒï¼š'res)
}

const socketManager = new WebSocketManager('ws://example.com/socket', 'userid292992', receiveMessage)
socketManager.start()
</code></pre>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<blockquote>
<p>ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨<code>WebSocket</code>çš„ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œå…·ä½“å®ç°æ ¹æ®ä¸šåŠ¡éœ€æ±‚è¿›è¡Œè°ƒæ•´å³å¯ã€‚å…¨éƒ¨ä»£ç æ¯”è¾ƒå¤šï¼Œå°±ä¸åœ¨è¿™é‡Œå±•ç¤ºäº†ï¼Œéœ€è¦çš„å¯ä»¥åˆ°<a href="https://github.com/LonJinUp/webSocketManager">GitHub</a>ä¸‹è½½ã€‚</p>
</blockquote>
<h2 id="å¾€æœŸæ¨èæ–‡ç« ">å¾€æœŸæ¨èæ–‡ç« ğŸ“š</h2>
<p>ğŸ·ï¸<a href="https://lonjinup.github.io/weixin-onNetworkStatusChange/">å°ç¨‹åºç½‘ç»œç›‘æ§å¤§æ­ç§˜ï¼šå¦‚ä½•å®æ—¶ç›‘å¬ç½‘ç»œå˜åŒ–</a></p>
<p>ğŸ·ï¸<a href="https://lonjinup.github.io/weixn-image-time/">&quot;5.25ç§’å˜0.023ç§’ï¼šå°ç¨‹åºå›¾ç‰‡ä¼˜åŒ–å…¨æ”»ç•¥&quot;</a></p>
<p>ğŸ·ï¸<a href="https://lonjinup.github.io/uni-request/">å¦‚ä½•å°è£…ä¼˜é›…ã€é«˜æ•ˆçš„uni-appè¯·æ±‚ï¼šè®©å¼€å‘æ›´è½»æ¾</a></p>
<p>ğŸ·ï¸<a href="https://lonjinup.github.io/uni-app-template-01/">uni-appå¼€å‘å°ç¨‹åºï¼šé¡¹ç›®æ¶æ„ä»¥åŠç»éªŒåˆ†äº«</a></p>
<p>ğŸ·ï¸<a href="https://lonjinup.github.io/wxtabbar/">å°ç¨‹åºTabBaråˆ›æ„åŠ¨ç”»(æ–‡æœ«é™„å®Œæ•´æºä»£ç )</a></p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äº<a href="https://lonjinup.github.io">é™‡é”¦çš„ä¸ªäººåšå®¢</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å°ç¨‹åºç½‘ç»œç›‘æ§å¤§æ­ç§˜ï¼šå¦‚ä½•å®æ—¶ç›‘å¬ç½‘ç»œå˜åŒ–]]></title>
        <id>https://lonjinup.github.io/weixin-onNetworkStatusChange/</id>
        <link href="https://lonjinup.github.io/weixin-onNetworkStatusChange/">
        </link>
        <updated>2024-01-12T07:48:12.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å°ç¨‹åºç½‘ç»œç›‘æ§å¤§æ­ç§˜å¦‚ä½•å®ç°å®æ—¶ç›‘å¬ç½‘ç»œå˜åŒ–">å°ç¨‹åºç½‘ç»œç›‘æ§å¤§æ­ç§˜ï¼šå¦‚ä½•å®ç°å®æ—¶ç›‘å¬ç½‘ç»œå˜åŒ–</h1>
<blockquote>
<p>å‰å‡ å¤©å†™äº†ä¸€ç¯‡<a href="https://lonjinup.github.io/weixn-image-time/">&quot;5.25ç§’å˜0.023ç§’ï¼šå°ç¨‹åºå›¾ç‰‡ä¼˜åŒ–å…¨æ”»ç•¥&quot;<br>
</a>ï¼›ä»‹ç»äº†ä¸€äº›å°ç¨‹åºå›¾ç‰‡ä¼˜åŒ–æŠ€å·§ï¼Œåœ¨æ–‡ç« ä¸­æåˆ°æˆ‘ä»¬å¯ä»¥å€ŸåŠ©å½“å‰ç”¨æˆ·çš„ç½‘ç»œçŠ¶æ€å»åŠ è½½å¯¹åº”åˆ†è¾¨ç‡çš„å›¾ç‰‡ã€‚ä¸‹é¢æˆ‘ä»¬å°±å®ç°ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½ã€‚</p>
</blockquote>
<h2 id="éœ€æ±‚åˆ†æ">éœ€æ±‚åˆ†æ</h2>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å»å†™ä¸€ä¸ªä¸‹è½½æ–¹æ³•ï¼Œé€šè¿‡ä¸‹è½½æ¥è®¡ç®—è¯·æ±‚è€—æ—¶ï¼Œç„¶åé€šè¿‡æ‰€éœ€è€—æ—¶æ¥åˆ¤æ–­ç½‘ç»œçŠ¶æ€ï¼Œå¦‚æœç½‘ç»œçŠ¶æ€ä¸å¥½ï¼Œåˆ™è¿›è¡Œå‡ æ¬¡é‡è¯•ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰æ›´å¥½çš„ç½‘ç»œçŠ¶æ€ã€‚åŒæ—¶æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨<code>wx.onNetworkStatusChange</code>è¿™ä¸ªapiæ¥ç›‘å¬ç½‘ç»œçŠ¶æ€çš„å˜åŒ–ï¼›è¯¥apiä¼šåœ¨ç”¨æˆ·ç½‘ç»œåˆ‡æ¢æ—¶å€™è§¦å‘ï¼Œä¸€æ—¦è§¦å‘ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°æ‰§è¡Œä¸‹è½½æ–¹æ³•æ¥åˆ¤æ–­å½“å‰çš„ç½‘ç»œçŠ¶æ€ã€‚</p>
<h2 id="åŠŸèƒ½å®ç°">åŠŸèƒ½å®ç°</h2>
<p>æˆ‘è¿™é‡Œdemoä½¿ç”¨<code>uni-app</code>å¼€å‘ï¼Œæ‰€ä»¥æœ‰äº›apiå¯èƒ½æ˜¯<code>uni.</code>å¼€å¤´ï¼Œå¦‚æœä½ ä½¿ç”¨å°ç¨‹åºåŸç”Ÿå¼€å‘ï¼Œæ¢æˆ<code>wx.</code>å³å¯ã€‚</p>
<p>æ–°å»º<code>/utils/networkManager.js</code>ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€äº›åŸºæœ¬çš„å‚æ•°ï¼š</p>
<pre><code class="language-js">class NetworkManager {
    constructor() {
        // æœ€å¤§é‡è¯•æ¬¡æ•°
        this.MAX_RETRY_COUNT = 3
        // å½“å‰é‡è¯•æ¬¡æ•°
        this.retryCount = 0
        // å½“å‰ç½‘ç»œçŠ¶æ€
        this.currentNetworkStatus = ''
        // ç½‘ç»œçŠ¶æ€æ”¹å˜å›è°ƒ
        this.statusChangeCallback = null
        // å›¾ç‰‡åœ°å€
        this.url = ''
    }
}
</code></pre>
<p>ç„¶åæˆ‘ä»¬å»æ·»åŠ ä¸¤ä¸ªå‡½æ•°ï¼Œç”¨æ¥è®¾ç½®å›¾ç‰‡åœ°å€å’Œç½‘ç»œçŠ¶æ€æ”¹å˜çš„å›è°ƒå‡½æ•°ï¼š</p>
<pre><code class="language-js">class NetworkManager {
    constructor() {
        // ...çœç•¥
    }
    /**
     * è®¾ç½®ç½‘ç»œçŠ¶æ€å˜åŒ–çš„å›è°ƒå‡½æ•°
     * @param {*} callback 
     */
    setChangeCallback(callback) {
        this.statusChangeCallback = callback
    }

    // è®¾ç½®è¯·æ±‚çš„url
    setRequestUrl(url) {
        this.url = url
    }
}
</code></pre>
<p>å¦‚ä½•åˆ¤æ–­å½“å‰ç½‘ç»œåˆ°åº•å¥½ä¸å¥½å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>uni.downloadFile</code>æ¥ä¸‹è½½ä¸€å¼ <code>1M-2M</code>å¤§å°çš„å›¾ç‰‡ï¼Œé€šè¿‡ä¸‹è½½æ—¶é—´æ¥åˆ¤æ–­ç½‘ç»œæƒ…å†µã€‚å½“è¯·æ±‚è€—æ—¶åœ¨<code>1000ms</code>ä»¥å†…ï¼Œåˆ™è®¤ä¸ºç½‘ç»œæå¥½ï¼Œå¦‚æœä»‹äº<code>1000-1500ms</code>ä¹‹é—´ï¼Œåˆ™è®¤ä¸ºç½‘ç»œå¥½ï¼Œå¦‚æœå¤§äº<code>1500ms</code>ï¼Œåˆ™è®¤ä¸ºç½‘ç»œå·®ã€‚å¦‚æœç½‘ç»œéå¸¸å·®çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¤šè¯·æ±‚å‡ æ¬¡ï¼Œæ¥æŒç»­åˆ¤æ–­ç½‘ç»œæ˜¯å¦æœ‰å¥½è½¬ï¼Œå¦‚æœè¶…è¿‡æˆ‘ä»¬å®šä¹‰çš„æœ€å¤§é‡è¯•æ¬¡æ•°å°±åœæ­¢è¯·æ±‚ã€‚</p>
<pre><code class="language-js">class NetworkManager {
    constructor() {
        // ...çœç•¥
    }
    // è¯·æ±‚æ–¹æ³•
    request() {
        return new Promise((resolve, reject) =&gt; {
            // è®°å½•å½“å‰æ—¶é—´
            const startTime = Date.now()
            uni.downloadFile({
                url: `${this.url}?timer=${startTime}`,
                success: (res) =&gt; {
                    // è®°å½•ç»“æŸæ—¶é—´
                    const endTime = Date.now()
                    // æ—¶é—´å·®
                    const duration = endTime - startTime
                    // åˆ¤æ–­ç½‘ç»œæƒ…å†µ
                    this.checkNetworkStatus(duration)
                    resolve(res)
                },
                fail: (res) =&gt; {
                    // è¿›è¡Œé‡è¯•
                    this.retryCount++
                    if (this.retryCount &lt; this.MAX_RETRY_COUNT) {
                        this.request()
                    } else {
                        console.log('ç½‘ç»œçŠ¶æ€ä¸ä½³ï¼Œå·²åœæ­¢')
                        // é‡è¯•æ¬¡æ•°å½’é›¶
                        this.retryCount = 0
                        reject(res)
                    }
                },
            })
        })
    }

    /**
     * åˆ¤æ–­ç½‘ç»œçŠ¶æ€
     * @param {*} duration è¯·æ±‚è€—æ—¶ms
     */
    checkNetworkStatus(duration) {
        const previousStatus = this.currentNetworkStatus
        if (duration &lt; 1000) {
            this.currentNetworkStatus = 'veryGood'
        } else if (duration &gt;= 1000 &amp;&amp; duration &lt;= 1500) {
            this.currentNetworkStatus = 'good'
        } else {
            this.currentNetworkStatus = 'poor'
            // è¯·æ±‚å¤±è´¥ï¼Œå¼€å§‹åˆ¤æ–­
            if (this.retryCount &lt; this.MAX_RETRY_COUNT) {
                this.retryCount++
                this.request()
            } else {
                // è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œåœæ­¢é€’å½’
                this.retryCount = 0
                console.log('ç½‘ç»œçŠ¶æ€ä¸ä½³ï¼Œå·²åœæ­¢')
            }
        }

        // åˆ¤æ–­ç½‘ç»œçŠ¶æ€æ˜¯å¦å‘ç”Ÿå˜åŒ–,å¦‚æœæœ‰å˜åŒ–ï¼Œå°±é€šçŸ¥å›è°ƒå‡½æ•°
        if (previousStatus !== this.currentNetworkStatus &amp;&amp; this.statusChangeCallback) {
            this.statusChangeCallback(this.currentNetworkStatus)
        }
    }
}
</code></pre>
<p>æœ€åæˆ‘ä»¬è¿˜éœ€è¦å†™ä¸€ä¸ªå¼€å¯å‡½æ•°ï¼Œç”¨æ¥å¯åŠ¨ç½‘ç»œç›‘å¬ï¼ŒåŒæ—¶ä½¿ç”¨<code>uni.onNetworkStatusChange</code>æ¥ç›‘å¬ç”¨æˆ·ç½‘ç»œç¯å¢ƒå˜åŒ–ï¼Œå¦‚æœæœ‰å˜åŒ–åˆ™è¿›è¡Œä¸€æ¬¡è¯·æ±‚ã€‚</p>
<pre><code class="language-js">class NetworkManager {
    constructor() {
        // ...çœç•¥
    }
    /**
     * å¼€å¯ç›‘å¬
     * @returns 
     */
    start() {
        if (!this.url) {
            console.error('è¯·è®¾ç½®è¯·æ±‚çš„url')
            return
        }
        // æ‰§è¡Œè¯·æ±‚
        this.request()
        // ç½‘ç»œç¯å¢ƒå˜æ¢åï¼Œé‡æ–°è¯·æ±‚
        uni.onNetworkStatusChange(() =&gt; {
            this.request()
        })
    }
}
</code></pre>
<h2 id="ä½¿ç”¨æ–¹å¼">ä½¿ç”¨æ–¹å¼</h2>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æœ€ç»ˆçš„ä½¿ç”¨æ–¹å¼ï¼š</p>
<pre><code class="language-js">// ä½¿ç”¨ç¤ºä¾‹
const networkManager = new NetworkManager()
// è®¾ç½®è¯·æ±‚çš„url
networkManager.setRequestUrl('https://lonjin.oss-cn-beijing.aliyuncs.com/weixin-test/wallhaven-o5g125.jpeg')
// è®¾ç½®ç½‘ç»œçŠ¶æ€å˜åŒ–çš„å›è°ƒå‡½æ•°
networkManager.setChangeCallback((newStatus) =&gt; {
    // è¿™é‡Œå¯ä»¥æŠŠç»“æœå­˜åˆ°å…¨å±€å˜é‡ä¸­ï¼Œåœ¨å…¶ä»–é¡µé¢æ–¹ä¾¿ä½¿ç”¨
    console.log('ç½‘ç»œçŠ¶æ€å˜åŒ–:', newStatus)
})
// å¯åŠ¨
networkManager.start()
</code></pre>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<blockquote>
<p>æˆ‘ä»¬é€šè¿‡<code>uni.downloadFile</code>æ¥ä¸‹è½½ä¸€å¼ å›¾ç‰‡ï¼Œé€šè¿‡ä¸‹è½½æ—¶é—´æ¥åˆ¤æ–­ç½‘ç»œæƒ…å†µï¼Œç„¶åé€šè¿‡<code>uni.onNetworkStatusChange</code>ç›‘å¬ç½‘ç»œç¯å¢ƒå˜åŒ–ï¼Œå½“ç½‘ç»œç¯å¢ƒå˜åŒ–æ—¶ï¼Œé‡æ–°è¯·æ±‚ï¼›ä»è€Œå»æ ¹æ®ç½‘ç»œçŠ¶æ€å»è¯·æ±‚ä¸åŒå¤§å°çš„èµ„æºæ–‡ä»¶ï¼Œå‡å°‘ç™½å±æ—¶é—´ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p>
</blockquote>
<p>å¾€æœŸæ¨èæ–‡ç« ğŸ“šï¼š</p>
<p>ğŸ·ï¸<a href="https://lonjinup.github.io/weixn-image-time/">&quot;5.25ç§’å˜0.023ç§’ï¼šå°ç¨‹åºå›¾ç‰‡ä¼˜åŒ–å…¨æ”»ç•¥&quot;</a></p>
<p>ğŸ·ï¸<a href="https://lonjinup.github.io/uni-request/">å¦‚ä½•å°è£…ä¼˜é›…ã€é«˜æ•ˆçš„uni-appè¯·æ±‚ï¼šè®©å¼€å‘æ›´è½»æ¾</a></p>
<p>ğŸ·ï¸<a href="https://lonjinup.github.io/uni-app-template-01/">uni-appå¼€å‘å°ç¨‹åºï¼šé¡¹ç›®æ¶æ„ä»¥åŠç»éªŒåˆ†äº«</a></p>
<p>ğŸ·ï¸<a href="https://lonjinup.github.io/wxtabbar/">å°ç¨‹åºTabBaråˆ›æ„åŠ¨ç”»(æ–‡æœ«é™„å®Œæ•´æºä»£ç )</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA["5.25ç§’å˜0.023ç§’ï¼šå°ç¨‹åºå›¾ç‰‡ä¼˜åŒ–å…¨æ”»ç•¥"]]></title>
        <id>https://lonjinup.github.io/weixn-image-time/</id>
        <link href="https://lonjinup.github.io/weixn-image-time/">
        </link>
        <updated>2024-01-08T17:37:08.000Z</updated>
        <content type="html"><![CDATA[<h1 id="525ç§’å˜0023ç§’å°ç¨‹åºå›¾ç‰‡ä¼˜åŒ–å…¨æ”»ç•¥">&quot;5.25ç§’å˜0.023ç§’ï¼šå°ç¨‹åºå›¾ç‰‡ä¼˜åŒ–å…¨æ”»ç•¥&quot;</h1>
<blockquote>
<p>æœ€è¿‘åœ¨å…¬å¸åœ¨å†™å¾®ä¿¡å°ç¨‹åºï¼Œè¯¥å°ç¨‹åºä¸»è¦å±•ç¤ºä¸€äº›é«˜æ¸…å›¾ç‰‡ï¼Œæ‰€ä»¥å›¾ç‰‡æ•°é‡éå¸¸å¤šï¼Œè€Œä¸”å›¾ç‰‡å°ºå¯¸ä¹Ÿæ¯”è¾ƒå¤§ï¼Œå¯¼è‡´å°ç¨‹åºçš„åŠ è½½æ—¶é—´éå¸¸é•¿ã€‚æ‰€ä»¥è¿™é‡Œè®°å½•ä¸€ä¸‹å¦‚ä½•å‡å°‘å°ç¨‹åºå›¾ç‰‡çš„åŠ è½½æ—¶é—´ã€‚</p>
</blockquote>
<h2 id="ä¼˜åŒ–å‰">ä¼˜åŒ–å‰</h2>
<p>è¿™é‡Œæˆ‘æŒ‘é€‰äº†ä¸€äº›é¡¹ç›®é‡Œé¢æ¯”è¾ƒå¤§çš„å›¾ç‰‡ï¼Œè¿˜æœ‰æˆ‘ä¹‹å‰ä¿å­˜çš„ä¸€äº›èƒŒæ™¯å›¾ï¼Œå…±è®¡<code>12</code>å¼ ï¼Œä¸Šä¼ åˆ°<code>é˜¿é‡Œäº‘oss</code>ï¼Œç„¶åå†™äº†ä¸€ä¸ªdemoå»æ¸²æŸ“å›¾ç‰‡ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆçœ‹çœ‹åŠ è½½æ—¶é—´ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://s11.ax1x.com/2024/01/10/pFpoHTU.png" alt="pFpoHTU.png" loading="lazy"></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸€æ—¦æ–‡ä»¶å¤§å°åˆ°äº†<code>1M</code>ä»¥ä¸Šï¼ŒåŠ è½½åŸºæœ¬éƒ½åœ¨<code>1ç§’</code>ä»¥ä¸Šäº†ï¼Œè€Œä¸”åŠ è½½æœ€æ…¢çš„ä¸€å¼ å›¾ç‰‡å¤§å°ä¸º<code>2.4M</code>ï¼›åŠ è½½è€—æ—¶<code>5.27</code>ç§’ã€‚ç„¶è€Œåœ¨è¿™ä¸ªå°ç¨‹åºä¸­ï¼Œæœ‰éå¸¸å¤šçš„ç€‘å¸ƒæµå›¾ç‰‡å±•ç¤ºï¼Œéœ€è¦åŠ è½½çš„å›¾ç‰‡ä¹Ÿéå¸¸å¤šï¼Œè¿™å¯¹äºè¿™ç§å›¾ç‰‡å±•ç¤ºç±»çš„å°ç¨‹åºæ¥è¯´ï¼Œç®€ç›´æ˜¯éå¸¸ç³Ÿç³•çš„ä½“éªŒã€‚ä¸‹é¢æˆ‘ä»¬å°±åˆ†æä¸€ä¸‹ï¼Œå¦‚ä½•æå‡ç”¨æˆ·ä½“éªŒï¼Œç¼©çŸ­åŠ è½½æ—¶é—´ã€‚</p>
<h2 id="åˆ†æä¼˜åŒ–">åˆ†æä¼˜åŒ–</h2>
<p>è¿™é‡Œæˆ‘æ€»ç»“äº†ä¸€äº›å¸¸è§å›¾ç‰‡ä¼˜åŒ–ç­–ç•¥ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure data-type="image" tabindex="2"><a href="https://imgse.com/i/pFpojp9"><img src="https://s11.ax1x.com/2024/01/10/pFpojp9.png" alt="pFpojp9.png" loading="lazy"></a></figure>
<p>ä¸‹é¢æˆ‘ä»¬å°±æ ¹æ®æ€»ç»“çš„ä¼˜åŒ–ç­–ç•¥è¿›è¡Œä¼˜åŒ–ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<h3 id="ä¼˜åŒ–1ä½¿ç”¨webpæ ¼å¼çš„å›¾ç‰‡">ä¼˜åŒ–1ï¼šä½¿ç”¨<code>webp</code>æ ¼å¼çš„å›¾ç‰‡</h3>
<p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å°ç¨‹åºä¸­æ˜¯æ”¯æŒ<code>webp</code>æ ¼å¼çš„å›¾ç‰‡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å›¾ç‰‡è½¬æ¢ä¸º<code>webp</code>æ ¼å¼ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å›¾ç‰‡ä½“ç§¯ï¼Œæå‡åŠ è½½é€Ÿåº¦ã€‚<br>
å…¬å¸ä½¿ç”¨çš„<code>é˜¿é‡Œäº‘oss</code>è¿›è¡Œå›¾ç‰‡å­˜å‚¨ï¼Œé˜¿é‡Œäº‘ossæ˜¯æ”¯æŒæ ¼å¼è½¬æ¢çš„ï¼Œåªéœ€è¦åœ¨å›¾ç‰‡urlåé¢åŠ ä¸€å®šçš„å‚æ•°å³å¯ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å›¾ç‰‡åé¢åŠ ä¸Š<code>?x-oss-process=image/format,webp</code>å³å¯ã€‚</p>
<pre><code class="language-js">// åŸæœ¬å›¾ç‰‡è·¯å¾„ï¼š
let url =' https://lonjin.oss-cn-beijing.aliyuncs.com/weixin-test/3%20%282%2917047050403470042.png'

// è½¬åŒ–ä¸ºwebpæ ¼å¼çš„å›¾ç‰‡è·¯å¾„ï¼š
let url =' https://lonjin.oss-cn-beijing.aliyuncs.com/weixin-test/3%20%282%2917047050403470042.png?x-oss-process=image/format,webp'
</code></pre>
<p>æ¸…é™¤ç¼“å­˜ï¼Œåˆ·æ–°é¡µé¢ï¼Œå†æ¥çœ‹åŠ è½½æ—¶é—´ï¼š</p>
<figure data-type="image" tabindex="3"><a href="https://imgse.com/i/pFpoqkF"><img src="https://s11.ax1x.com/2024/01/10/pFpoqkF.png" alt="pFpoqkF.png" loading="lazy"></a></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒåŠ è½½æ—¶é—´å¤§å¹…ç¼©çŸ­ï¼Œå›¾ç‰‡æ ¼å¼è½¬åŒ–åï¼Œå›¾ç‰‡å¤§å°å·²ç»éå¸¸å°äº†ï¼Œæœ€å¤§çš„ä¸€å¼ å›¾ç‰‡ä»…ä»…æœ‰<code>730kb</code>ï¼›éšä¹‹åŠ è½½æ—¶é—´ä¹Ÿå¤§å¹…ç¼©çŸ­ï¼Œæœ€æ…¢çš„ä¸€å¼ å›¾ç‰‡ä»ä¹‹å‰çš„5.27ç§’ç¼©çŸ­ä¸º1.71ç§’ï¼ŒåŠ è½½é€Ÿåº¦æå‡äº†<code>3å€</code>ï¼å…¶ä»–çš„å›¾ç‰‡åŠ è½½åŸºæœ¬éƒ½åœ¨<code>500ms</code>å·¦å³ï¼ŒåŠ è½½é€Ÿåº¦æå‡ä¹Ÿæ˜¯æ¯”è¾ƒæ˜æ˜¾ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ä¸€ä¸‹<code>webp</code>å›¾ç‰‡æ ¼å¼çš„æ”¯æŒèŒƒå›´ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„<code>uni-app</code>åšä¸ºdemoï¼ŒæŸ¥äº†ä¸€ä¸‹æ–‡æ¡£ï¼Œæ”¯æŒèŒƒå›´å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>Android4ä»¥ä¸Šï¼ˆå«ï¼‰ã€iOS14ä»¥ä¸Šï¼ˆå«ï¼‰ç³»ç»Ÿå†…ç½®æ”¯æŒwebpï¼Œæ­¤æ—¶ï¼Œä¸ç®¡webã€å°ç¨‹åºã€appï¼Œä¹Ÿä¸ç®¡vue/nvue/uvueéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨webpï¼›<br>
iOS14ä»¥ä¸‹ï¼Œapp-vueä¸‹ï¼ŒiOSä¸æ”¯æŒï¼›app-nvue/uvueä¸‹ï¼ŒiOSæ”¯æŒï¼›å¾®ä¿¡å°ç¨‹åº2.9.0èµ·ï¼Œé…ç½®å±æ€§webpä¸ºtrueæ—¶iOSæ”¯æŒï¼›</p>
</blockquote>
<p>æ‰€ä»¥å¦‚æœè€ƒè™‘ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹çš„å¤„ç†ã€‚</p>
<p>å¦‚æœæ–‡ä»¶æ˜¯ç›´æ¥æ”¾åœ¨æœåŠ¡å™¨ä¸Šçš„ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸€äº›ç¬¬ä¸‰æ–¹å·¥å…·æ¥æŠŠå›¾ç‰‡æ‰¹é‡è½¬åŒ–ä¸º<code>webp</code>æ ¼å¼ï¼›æ¯”å¦‚<a href="https://convertio.co/zh/jpg-webp/">convertio.co</a></p>
<h3 id="ä¼˜åŒ–2æ ¹æ®éœ€æ±‚è®¾ç½®é€‚å½“çš„åˆ†è¾¨ç‡">ä¼˜åŒ–2ï¼šæ ¹æ®éœ€æ±‚è®¾ç½®é€‚å½“çš„åˆ†è¾¨ç‡</h3>
<p>é˜¿é‡Œäº‘ossæ”¯æŒåœ¨å›¾ç‰‡åé¢åŠ ä¸Šå‚æ•°æ¥è®¾ç½®å›¾ç‰‡çš„åˆ†è¾¨ç‡ï¼Œæˆ‘è¿™é‡Œå†™çš„demoä¸­ï¼Œ<code>image</code>æ ‡ç­¾å›¾ç‰‡å®½åº¦å‡ä¸ºå°ç¨‹åºå›¾ç‰‡é»˜è®¤å®½åº¦ï¼›å³ä¸º<code>width: 320px;</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»™å›¾ç‰‡urlåé¢åŠ ä¸Š<code>/resize,w_320</code>å³å¯ï¼Œå…¶ä¸­<code>w_320</code>è¡¨ç¤ºå›¾ç‰‡å®½åº¦ä¸º<code>320px</code>ã€‚</p>
<pre><code class="language-js">// åŸæœ¬å›¾ç‰‡è·¯å¾„ï¼š
let url =' https://lonjin.oss-cn-beijing.aliyuncs.com/weixin-test/3%20%282%2917047050403470042.png?x-oss-process=image/format,webp'

// è®¾ç½®å®½åº¦åçš„å›¾ç‰‡è·¯å¾„ï¼š
let url =' https://lonjin.oss-cn-beijing.aliyuncs.com/weixin-test/3%20%282%2917047050403470042.png?x-oss-process=image/format,webp/resize,w_320'
</code></pre>
<p>æ¸…é™¤ç¼“å­˜ï¼Œåˆ·æ–°é¡µé¢ï¼Œå†æ¥çœ‹åŠ è½½æ—¶é—´ï¼š</p>
<figure data-type="image" tabindex="4"><a href="https://imgse.com/i/pFpoLY4"><img src="https://s11.ax1x.com/2024/01/10/pFpoLY4.jpg" alt="pFpoLY4.jpg" loading="lazy"></a></figure>
<p>å›¾ç‰‡å¤§å°å¤§å¹…åº¦å‡å°‘ï¼Œæœ€å¤§çš„ä¸€å¼ å›¾ç‰‡ä»…ä»…æœ‰<code>15.4 kB</code>ï¼›éšä¹‹åŠ è½½æ—¶é—´ä¹Ÿå¤§å¹…ç¼©çŸ­ï¼Œæœ€æ…¢çš„ä¸€å¼ å›¾ç‰‡ä»ä¹‹å‰çš„1.71ç§’ç¼©çŸ­ä¸º316æ¯«ç§’ï¼ŒåŠ è½½é€Ÿåº¦æå‡äº†<code>5å€</code>ï¼è¿™æ—¶å€™æ‰€æœ‰å›¾ç‰‡çš„åŠ è½½é€Ÿåº¦å…¨éƒ¨æ²¡æœ‰è¶…è¿‡1ç§’ï¼Œæœ€å¤§ä¸è¶…è¿‡<code>350ms</code>ï¼›åŸºæœ¬ä¸Šç®—æ˜¯è´¨çš„é£è·ƒäº†ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå›¾ç‰‡åˆ†è¾¨ç‡è¿˜æ˜¯éœ€è¦ç»“åˆä¸šåŠ¡éœ€æ±‚è¿›è¡Œè°ƒæ•´çš„ï¼Œå¦‚æœè¦æ±‚å¿…é¡»é«˜æ¸…ï¼Œä¸å»ºè®®è®¾ç½®å¤ªå°çš„åˆ†è¾¨ç‡ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªæ£€æµ‹ç”¨æˆ·ç½‘ç»œçŠ¶æ€çš„æ–¹æ³•ï¼Œåœ¨ä¸åŒçš„ç½‘ç»œç¯å¢ƒä¸‹åŠ è½½ä¸åŒåˆ†è¾¨ç‡çš„å›¾ç‰‡ï¼›åé¢æˆ‘ä¼šä¸“é—¨æ¥å†™ä¸€ç¯‡æ–‡ç« æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<h3 id="ä¼˜åŒ–3ä½¿ç”¨é›ªç¢§å›¾">ä¼˜åŒ–3ï¼šä½¿ç”¨é›ªç¢§å›¾</h3>
<p>é›ªç¢§å›¾ï¼Œä¹Ÿå«<code>Sprite</code>ï¼Œæ˜¯å°†å¤šä¸ªå°å›¾ç‰‡åˆå¹¶æˆä¸€å¼ å¤§å›¾ï¼Œç„¶ååœ¨é¡µé¢ä¸­ä½¿ç”¨<code>background-image</code>å’Œ<code>background-position</code>å±æ€§æ¥æ˜¾ç¤ºå…¶ä¸­çš„æŸä¸€å¼ å›¾ç‰‡ã€‚è¿™æ ·å¯ä»¥å‡å°‘å›¾ç‰‡çš„åŠ è½½æ¬¡æ•°ï¼Œå‡å°‘å›¾ç‰‡çš„å¤§å°ï¼ŒåŒæ—¶å‡å°‘å›¾ç‰‡çš„åŠ è½½æ—¶é—´ã€‚åœ¨é¡¹ç›®ä¸­éš¾å…ä¼šæœ‰å¾ˆå¤šå°å›¾æ ‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨é›ªç¢§å›¾çš„æ–¹å¼æ¥ä½¿ç”¨ï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•°ã€‚è¿™é‡Œæˆ‘å°±ä¸åšå±•ç¤ºäº†ã€‚</p>
<h3 id="ä¼˜åŒ–4åˆç†ä½¿ç”¨å ä½å›¾ç‰‡">ä¼˜åŒ–4ï¼šåˆç†ä½¿ç”¨å ä½å›¾ç‰‡</h3>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸ºäº†å†…å®¹çš„åŠ¨æ€å±•ç¤ºï¼Œéœ€è¦é€šè¿‡ç½‘ç»œè¯·æ±‚ä»æ¥å£ä¸­è·å–å›¾ç‰‡çš„urlã€‚å¦‚æœåœ¨ç½‘ç»œæ…¢çš„æƒ…å†µä¸‹ï¼ŒimageåŠ è½½å›¾ç‰‡çš„è¿‡ç¨‹å¯èƒ½ä¼šéå¸¸æ…¢ï¼Œåœ¨è¯·æ±‚å®Œæˆä¹‹å‰é¡µé¢éƒ½ä¼šå› ä¸ºæ²¡æœ‰æ•°æ®è€Œå‘ˆç°ä¸€ç‰‡ç©ºç™½ï¼Œè¿™æ˜¯éå¸¸å·®çš„ç”¨æˆ·ä½“éªŒï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©å°ç¨‹åºimageæ ‡ç­¾ä¸Šçš„<code>@error	</code>å’Œ<code>@load</code>äº‹ä»¶æ¥å®ç°å ä½å›¾ç‰‡çš„å±•ç¤ºã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€æ±‚å»å°è£…ä¸€ä¸ª<code>LoadImage</code>ç»„ä»¶ç»Ÿä¸€å¤„ç†ï¼Œä¸Šé¢æåˆ°çš„<code>ä¼˜åŒ–1</code>ã€<code>ä¼˜åŒ–2</code>ä¹Ÿå¯ä»¥é€šè¿‡å®šä¹‰å‚æ•°å®ç°æ‰¹é‡æ·»åŠ ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™ç»„ä»¶åŠ ä¸Š<code>lazyLoad</code>ï¼Œå‡è½»å°ç¨‹åºåŠ è½½å‹åŠ›ã€‚</p>
<p>ç»„ä»¶å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-html">&lt;template&gt;
    &lt;view class=&quot;loadImage-wrapper&quot;&gt;
        &lt;image v-if=&quot;isLoading&quot; :src=&quot;defaultImage&quot; :mode=&quot;mode&quot; :lazy-load=&quot;lazyLoad&quot; /&gt;
        &lt;image :class=&quot;[isLoading ? 'before-load' : '']&quot; :src=&quot;imageUrl&quot; :mode=&quot;mode&quot; :lazy-load=&quot;lazyLoad&quot;
            @load=&quot;imageLoad&quot; /&gt;
    &lt;/view&gt;
&lt;/template&gt;
&lt;script&gt;
export default {
    props: {
        /**
         * å ä½å›¾
         * @default /static/images/load-image.png
         */
        defaultImage: {
            type: String,
            default: '/static/load-image.png',
        },
        /**
         * æ˜¯å¦ä½¿ç”¨webp
         * @default false
         */
        useWebp: {
            type: Boolean,
            default: false,
        },
        /**
         * å›¾ç‰‡çš„æ˜¾ç¤ºæ¨¡å¼
         * @default scaleToFill
         */
        mode: {
            type: String,
            default: 'scaleToFill',
        },
        /**
         * å›¾ç‰‡åŠ è½½åˆ†è¾¨ç‡-å®½åº¦
         * @default 
        */
        width: {
            type: String,
            default: '',
        },
        /**
         * æ˜¯å¦æ‡’åŠ è½½
         * @default true
         */
        lazyLoad: {
            type: Boolean,
            default: true,
        },
        /**
         * å›¾ç‰‡åœ°å€
         * @default 
        */
        src: {
            type: String,
            default: '',
        },
    },
    data() {
        return {
            isLoading: true,
        }
    },

    methods: {
        imageLoad() {
            this.isLoading = false
        },
    },

    computed: {
        imageUrl() {
            let url = this.src + '?'
            this.useWebp &amp;&amp; (url += 'x-oss-process=image/format,webp')
            this.width &amp;&amp; (url += '/resize,w_' + this.width)
            return url
        }
    },
}
&lt;/script&gt;
&lt;style lang=&quot;scss&quot; scoped&gt;
.loadImage-wrapper {
    .before-load {
        width: 0;
        height: 0;
        opacity: 0;
    }
}
&lt;/style&gt;
</code></pre>
<p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="language-html">&lt;template&gt;
    &lt;view class=&quot;list&quot;&gt;
        &lt;load-image v-for=&quot;(item, index) in list&quot; :src=&quot;item&quot; :lazyLoad=&quot;false&quot; useWebp :width=&quot;320&quot; :key=&quot;index&quot; /&gt;
    &lt;/view&gt;
&lt;/template&gt;
</code></pre>
<h2 id="ä¼˜åŒ–åæ•ˆæœå¯¹æ¯”">ä¼˜åŒ–åæ•ˆæœå¯¹æ¯”</h2>
<p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ä¼˜åŒ–å‰åçš„åŠ è½½æ—¶é—´å¯¹æ¯”ï¼š</p>
<ul>
<li>
<p>ä¼˜åŒ–å‰ï¼š<br>
<a href="https://imgse.com/i/pFpojp9"><img src="https://s11.ax1x.com/2024/01/10/pFpojp9.png" alt="pFpojp9.png" loading="lazy"></a></p>
</li>
<li>
<p>ä¼˜åŒ–åï¼š<br>
<a href="https://imgse.com/i/pFpoOfJ"><img src="https://s11.ax1x.com/2024/01/10/pFpoOfJ.png" alt="pFpoOfJ.png" loading="lazy"></a></p>
</li>
</ul>
<p>æˆ‘ä»¬ç”¨ä¸€å¼ å›¾ç‰‡æ¥åšå¯¹æ¯”ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th>å›¾ç‰‡åç§°</th>
<th>å¤§å°</th>
<th>åŠ è½½æ—¶é—´</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¼˜åŒ–å‰</td>
<td>wallhaven-we3z86.jpeg</td>
<td>2.4MB</td>
<td>5.27s</td>
</tr>
<tr>
<td>ä¼˜åŒ–å</td>
<td>wallhaven-we3z86.jpeg</td>
<td>15.3KB</td>
<td>23ms</td>
</tr>
</tbody>
</table>
<p>å¯ä»¥çœ‹åˆ°ç›¸å¯¹ä½“ç§¯è€Œè¨€ï¼Œç¼©å°äº†<code>99.4%</code>ï¼›ç›¸å¯¹åŠ è½½æ—¶é—´ï¼Œç¼©çŸ­äº†<code>5.25</code>ç§’ï¼Œåœ¨å‡ ä¹ä¸å½±å“å›¾ç‰‡è´¨é‡çš„æƒ…å†µä¸‹ï¼Œæå¤§çš„æå‡äº†ç”¨æˆ·ä½“éªŒã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<blockquote>
<p>å…³äºå°ç¨‹åºçš„å›¾ç‰‡ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚ä»¥åŠæŠ€æœ¯æ”¯æŒæ¥é€‰æ‹©ä¸åŒçš„æ–¹æ¡ˆï¼Œè¿™é‡Œæˆ‘åªåˆ—å‡ºäº†å‡ ä¸ªæœ€å¸¸ç”¨çš„æ–¹æ¡ˆï¼Œå¦‚æœä¸šåŠ¡éœ€æ±‚æ¯”è¾ƒå¤æ‚ï¼Œå¯ä»¥å¤šå°è¯•ä¸€äº›æ–¹æ¡ˆã€‚</p>
</blockquote>
<h2 id="å¾€æœŸæ–‡ç« ">å¾€æœŸæ–‡ç« </h2>
<p><a href="https://lonjinup.github.io/uni-request/">5åˆ†é’Ÿgetï¼šUni-Appç½‘ç»œè¯·æ±‚å®Œç¾å°è£…æŒ‡å—ï¼</a><br>
<a href="https://lonjinup.github.io/uni-app-template-01/">uni-appå¼€å‘å°ç¨‹åºï¼šé¡¹ç›®æ¶æ„ä»¥åŠç»éªŒåˆ†äº«</a><br>
<a href="https://lonjinup.github.io/wxtabbar/">å°ç¨‹åºTabBaråˆ›æ„åŠ¨ç”»(æ–‡æœ«é™„å®Œæ•´æºä»£ç )</a></p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äº<a href="https://lonjinup.github.io">lonjinä¸ªäººåšå®¢</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[nodeé¡¹ç›®å®æˆ˜-01å®ç°æ³¨å†Œç™»å½•]]></title>
        <id>https://lonjinup.github.io/node-demo-01/</id>
        <link href="https://lonjinup.github.io/node-demo-01/">
        </link>
        <updated>2024-01-03T16:53:32.000Z</updated>
        <content type="html"><![CDATA[<h1 id="nodeé¡¹ç›®å®æˆ˜-01å®ç°æ³¨å†Œç™»å½•">nodeé¡¹ç›®å®æˆ˜-01å®ç°æ³¨å†Œç™»å½•</h1>
<h2 id="1é¡¹ç›®å‡†å¤‡">1.é¡¹ç›®å‡†å¤‡</h2>
<p>å‰é¢æˆ‘ä»¬å·²ç»æ­å»ºäº†ä¸€ä¸ªåŸºç¡€çš„é¡¹ç›®æ¨¡ç‰ˆï¼Œç°åœ¨æˆ‘ä»¬å°±ç”¨è¿™ä¸ªé¡¹ç›®æ¨¡ç‰ˆæ¥åšä¸€ä¸ªç®€å•çš„é¡¹ç›®ã€‚é¦–å…ˆæˆ‘ä»¬å®‰è£…<a href="http://www.mongoosejs.net/">mongoose</a>æ¨¡å—ï¼š</p>
<pre><code class="language-bash">npm install mongoose --save
</code></pre>
<p><code>mongoose</code>æ˜¯MongoDBçš„Node.jsé©±åŠ¨ç¨‹åºï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§åœ¨Node.jsä¸­ä½¿ç”¨MongoDBçš„ç®€å•æ–¹æ³•ã€‚åé¢æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»ä»–çš„ä½¿ç”¨æ–¹æ³•ã€‚</p>
<h2 id="æ³¨å†Œæ¥å£">æ³¨å†Œæ¥å£</h2>
<blockquote>
<p>æˆ‘ä»¬å…ˆæ¥å®ç°ä¸€ä¸ªæ³¨å†Œæ¥å£ï¼Œè¿™ä¸ªæ¥å£æ¥æ”¶ä¸€ä¸ªå‚æ•°<code>username</code>ã€<code>email</code>ã€<code>password</code>ã€<code>phone</code>ï¼Œç„¶åå°†è¿™ä¸ªå‚æ•°ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚</p>
</blockquote>
<p>é¦–å…ˆæˆ‘ä»¬åˆ†åˆ«åˆ›å»ºå…³äºç”¨æˆ·åŠŸèƒ½çš„<code>router</code>å’Œ<code>controller</code>ï¼›æ–°å»º<code>/router/user.js</code>å’Œ<code>/controller/userController.js</code>ï¼š</p>
<p><code>/router/user.js</code>å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">const express = require('express')
const router = express.Router()
const userController = require('../controller/userController')

router
    .post('/register', userController.register)
module.exports = router
</code></pre>
<p><code>/controller/userController.js</code>å†…å®¹å¦‚ä¸‹ï¼Œé¡ºä¾¿æ‰“å°ä¸€ä¸‹æˆ‘ä»¬æ¥å—åˆ°å‚æ•°ï¼š</p>
<pre><code class="language-js">exports.register = async (req, res) =&gt; {
    console.log(req.body)
}
</code></pre>
<p>ç„¶åæˆ‘ä»¬åœ¨<code>/router/index.js</code>ä¸­å¼•å…¥è¿™ä¸ªè·¯ç”±ï¼š</p>
<pre><code class="language-js">const express = require('express')
const router = express.Router()
const user = require('./user')

router.use('/user', user)
module.exports = router
</code></pre>
<p>è¿è¡Œé¡¹ç›®ï¼š</p>
<pre><code class="language-shell">npm run dev
</code></pre>
<p>å½“æˆ‘ä»¬ä½¿ç”¨Postmanæˆ–è€…apifoxè®¿é—®<code>http://localhost:3000/user/register</code>å¹¶ä¼ å…¥å‚æ•°ï¼Œæ§åˆ¶å°å°±ä¼šæ‰“å°æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ï¼š</p>
<pre><code class="language-json">{
  &quot;username&quot;: &quot;test&quot;,
  &quot;email&quot;: &quot;test@test.com&quot;,
  &quot;password&quot;: &quot;123456&quot;,
  &quot;phone&quot;: &quot;12345678901&quot;
}
</code></pre>
<p>æ‹¿åˆ°å‚æ•°ä»¥åæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›æ•°æ®å­˜å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°å¼€å¤´æåˆ°çš„<code>mongoose</code>è¿›è¡Œå¤„ç†ã€‚</p>
<h3 id="ä½¿ç”¨mongooseå­˜å‚¨æ•°æ®">ä½¿ç”¨mongooseå­˜å‚¨æ•°æ®</h3>
<p>é¦–å…ˆæ–°å»º<code>/model/index.js</code>ï¼Œå¼•å…¥<code>mongoose</code>ï¼ŒåŒæ—¶è¿›è¡Œè¿æ¥æ•°æ®åº“çš„æ“ä½œï¼š</p>
<pre><code class="language-js">const mongoose = require('mongoose')

async function main() {
    await mongoose.connect('mongodb://localhost:27017/nodeDemo')
}

main().then(res =&gt; {
    console.log('mongoè¿æ¥æˆåŠŸ')
}).catch(error =&gt; {
    console.log('mongoè¿æ¥å¤±è´¥', error)
})
</code></pre>
<p>ç„¶åæˆ‘ä»¬åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­å†å»ºç«‹ä¸€ä¸ª<code>userModel.js</code>æ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ª<code>userSchema</code>ï¼Œæœ€åå¯¼å‡º</p>
<pre><code class="language-js">const mongoose = require('mongoose')

const userSchema = new mongoose.Schema({
    username: {
        type: String, //æ•°æ®ç±»å‹
        required: true, //æ•°æ®æ˜¯å¦å¿…é¡»
        trim: true, //å»é™¤ä¸¤è¾¹ç©ºæ ¼
        minlength: 4, //æœ€å°é•¿åº¦
        maxlength: 18, //æœ€å¤§é•¿åº¦
        validate: {
            validator: function (v) {
                return /^[a-zA-Z0-9_-]{4,18}$/.test(v)
            },
            message: '{VALUE}ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„ç”¨æˆ·å'
        }
    },
    email: {
        type: String,
        required: true,
        trim: true,
        validate: {
            validator: function (v) {
                return /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(v)
            },
            message: '{VALUE}ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„é‚®ç®±'
        }
    },
    password: {
        type: String,
        required: true,
    },
    phone: {
        type: String,
        required: true,
        unique: true,
        trim: true,
        validate: {
            validator: function (v) {
                return /^1[34578]\d{9}$/.test(v)
            },
            message: '{VALUE}ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„æ‰‹æœºå·'
        }
    },
    avatar: {
        type: String,
        default: null
    },
    createTime: {
        type: Date,
        default: Date.now
    },
    updateTime: {
        type: Date,
        default: Date.now
    }
})

module.exports = userSchema
</code></pre>
<p>å…³äºmongoose.Schemaçš„è¯¦ç»†ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒ<a href="http://www.mongoosejs.net/docs/schematypes.html">mongooseæ–‡æ¡£</a>ã€‚</p>
<p>å¯¼å‡ºä¹‹åï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦åœ¨<code>/model/index.js</code>ä¸­è¿›è¡Œé›†ä¸­çš„å¯¼å‡ºï¼Œåˆ°æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹è¿›è¡Œå¯¼å…¥ä½¿ç”¨äº†ï¼Œæœ€ç»ˆçš„<code>/model/index.js</code>å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">const mongoose = require('mongoose')

async function main() {
    await mongoose.connect('mongodb://localhost:27017/nodeDemo')
}

main().then(res =&gt; {
    console.log('mongoè¿æ¥æˆåŠŸ')
}).catch(error =&gt; {
    console.log('mongoè¿æ¥å¤±è´¥', error)
})

//å¯¼å‡ºæ¨¡å—
module.exports = {
    User: mongoose.model('User', require('./userModel'))
}
</code></pre>
<p>å†å›åˆ°åˆšæ‰çš„<code>/controller/userController.js</code>ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œå°†<code>register</code>æ–¹æ³•ä¸­çš„<code>console.log(req.body)</code>æ”¹ä¸ºï¼š</p>
<pre><code class="language-js">const { User } = require('../model/index')
exports.register = async (req, res) =&gt; {
    console.log(req.body)
    const userModel = new User(req.body)
    const dbBack = await userModel.save()
    res.status(201).json(dbBack)
}
</code></pre>
<p>è¿™æ ·ä¸€æ¥ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨Postmanæˆ–è€…apifoxè®¿é—®<code>http://localhost:3000/user/register</code>å¹¶ä¼ å…¥å‚æ•°ï¼Œæ§åˆ¶å°å°±ä¼šæ‰“å°æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ï¼Œå¹¶ä¸”å°†è¿™äº›å‚æ•°ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚</p>
<h3 id="å¯†ç åŠ å¯†">å¯†ç åŠ å¯†</h3>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†å¯†ç æ˜æ–‡å­˜å…¥äº†æ•°æ®åº“ä¸­ï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯ä¸å®‰å…¨çš„ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>crypto</code>ä¸­çš„<code>createHash</code>å‡½æ•°å¯¹å¯†ç è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå°†åŠ å¯†åçš„å¯†ç å­˜å…¥æ•°æ®åº“ä¸­ã€‚</p>
<p>æ–°å»º<code>util/md5.js</code>ï¼›å¹¶å¼•å…¥cryptoï¼š</p>
<pre><code class="language-js">const crypto = require('crypto')

/**
 * md5åŠ å¯†
 * @param str
 * @returns {string}
 */
module.exports = str =&gt; crypto.createHash('md5').update('lonjin' + str).digest('hex')
</code></pre>
<ol>
<li>
<p><strong><code>crypto.createHash('md5')</code></strong>: åˆ›å»ºä¸€ä¸ªç”¨äº MD5 æ•£åˆ—çš„ Hash å¯¹è±¡ã€‚<code>md5</code> è¡¨ç¤ºé‡‡ç”¨ MD5 ç®—æ³•ã€‚</p>
</li>
<li>
<p><strong><code>.update('lonjin' + str)</code></strong>: ä½¿ç”¨ç»™å®šçš„æ•°æ®è¿›è¡Œæ›´æ–°ï¼Œè¿™é‡Œçš„æ•°æ®æ˜¯ <code>'lonjin' + str</code>ï¼Œå³å°†å­—ç¬¦ä¸² <code>'lonjin'</code> ä¸å‚æ•° <code>str</code> è¿æ¥åçš„ç»“æœï¼Œè¿™æ ·å¯é¿å…è¢«æ’åº“çš„é£é™©ã€‚</p>
</li>
<li>
<p><strong><code>.digest('hex')</code></strong>: è¿”å› Hash å¯¹è±¡çš„äºŒè¿›åˆ¶æ•°æ®çš„åå…­è¿›åˆ¶è¡¨ç¤ºã€‚è¿™å°±æ˜¯æœ€ç»ˆçš„ MD5 æ•£åˆ—å€¼ã€‚</p>
</li>
</ol>
<p>ç„¶è€Œï¼Œè¯·æ³¨æ„ï¼ŒMD5 ä¸å†è¢«æ¨èç”¨äºå®‰å…¨ç›®çš„ï¼Œå› ä¸ºå®ƒå·²ç»è¢«å‘ç°å­˜åœ¨ä¸€äº›å¼±ç‚¹ã€‚åœ¨å¯†ç å­˜å‚¨æˆ–å…¶ä»–éœ€è¦é«˜åº¦å®‰å…¨æ€§çš„åœºæ™¯ä¸­ï¼Œæ›´æ¨èä½¿ç”¨æ›´å¼ºå¤§çš„æ•£åˆ—ç®—æ³•ï¼Œæ¯”å¦‚ SHA-256ï¼Œå¹¶ä¸”ç»“åˆä¸€äº›é™„åŠ çš„å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚åŠ ç›ï¼ˆsaltingï¼‰å’Œé€‚å½“çš„è¿­ä»£æ¬¡æ•°ï¼ˆiterationï¼‰ã€‚å…·ä½“æ–¹å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">const crypto = require('crypto');

function sha256Hash(str) {
    const hash = crypto.createHash('sha256')
    const hashedStr = hash.update('lonjin' + str).digest('hex')
    return hashedStr
}
module.exports = sha256Hash
</code></pre>
<h3 id="å¤„ç†å…¬å…±å­—æ®µ">å¤„ç†å…¬å…±å­—æ®µ</h3>
<p>åœ¨ä¸Šé¢çš„<code>userSchema.js</code>ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€äº›å…¬å…±å­—æ®µï¼Œæ¯”å¦‚<code>createTime</code>å’Œ<code>updateTime</code>ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹æˆ‘ä»¬å¯èƒ½éƒ½éœ€è¦è¿™ä¸¤ä¸ªå­—æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¿™ä¸¤ä¸ªå­—æ®µä¹ŸæŠ½ç¦»å‡ºæ¥ã€‚</p>
<p>æ–°å»ºï¼š<code>/model/baseModel.js</code>:</p>
<pre><code class="language-js">module.exports = {
    createTime: {
        type: Date,
        default: Date.now
    },
    updateTime: {
        type: Date,
        default: Date.now
    }
}
</code></pre>
<p>ç„¶ååœ¨<code>/model/userModel.js</code>ä¸­å¼•å…¥å¹¶ä½¿ç”¨ï¼š</p>
<pre><code class="language-js">const baseModel = require('./baseModel')

const userSchema = new mongoose.Schema({
    //...åŸæœ‰é€»è¾‘
    avatar: {
        type: String,
        default: null
    },
    ...baseModel
})
</code></pre>
<h3 id="æ•°æ®éªŒè¯">æ•°æ®éªŒè¯</h3>
<p><a href="https://express-validator.github.io/docs/guides/customizing">express-validator</a>æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„è¡¨å•éªŒè¯ä¸­é—´ä»¶ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨è¡¨å•æäº¤çš„æ—¶å€™è¿›è¡Œæ•°æ®éªŒè¯ï¼Œä»è€Œé¿å…äº†å‰ç«¯çš„ä¸€äº›å¸¸è§çš„é”™è¯¯ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…express-validatorï¼š</p>
<pre><code class="language-bash">npm install express-validator --save
</code></pre>
<p>è¿˜æ˜¯å·²æˆ‘ä»¬ä¸Šé¢æåˆ°çš„æ³¨å†Œæ¥å£ä¸ºä¾‹å­ï¼›é¦–å…ˆæˆ‘ä»¬å°è£…ä¸€ä¸‹éªŒè¯è§„åˆ™ï¼š</p>
<p>æ–°å»º<code>middleware/validator/userValidator.js</code>ï¼Œç”¨æ¥å¤„ç†ç”¨æˆ·ç›¸å…³çš„éªŒè¯è§„åˆ™ï¼ŒåŒæ—¶æˆ‘ä»¬å†å»ºç«‹ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå»ç»Ÿä¸€å¤„ç†é”™è¯¯é€»è¾‘ï¼›æ–°å»º<code>middleware/validator/errorBack.js</code>ã€‚</p>
<p><code>middleware/validator/userValidator.js</code>å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">const { body } = require('express-validator')
const validator = require('./errorBack')

module.exports.register = validator(
    [
        body('username')
            .notEmpty().withMessage('ç”¨æˆ·åä¸èƒ½ä¸ºç©º').bail()
            .isLength({ min: 3, max: 10 }).withMessage('ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-10ä¹‹é—´'),
        body('email')
            .notEmpty().withMessage('é‚®ç®±ä¸èƒ½ä¸ºç©º').bail()
            .isEmail().withMessage('é‚®ç®±æ ¼å¼ä¸æ­£ç¡®'),
        body('password')
            .notEmpty().withMessage('å¯†ç ä¸èƒ½ä¸ºç©º').bail()
            .isLength({ min: 6, max: 16 }).withMessage('å¯†ç é•¿åº¦å¿…é¡»åœ¨6-16ä¹‹é—´')
    ]
) 
</code></pre>
<p><code>middleware/validator/errorBack.js</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">const { validationResult } = require('express-validator')

module.exports = validator =&gt; {
    return async (req, res, next) =&gt; {
        await Promise.all(validator.map(i =&gt; i.run(req)))
        //è·å–é”™è¯¯ä¿¡æ¯
        const errors = validationResult(req)
        if (!errors.isEmpty()) {
            // å¤„ç†é”™è¯¯ä¿¡æ¯
            return res.status(401).json({ error: errors.array() })
        }
        next()
    }
}
</code></pre>
<blockquote>
<p>ä¸‹é¢æ˜¯ä¸€äº›åœ¨ <code>express-validator</code> ä¸­å¸¸ç”¨çš„éªŒè¯è§„åˆ™ï¼Œä»¥åŠå®ƒä»¬çš„ç®€è¦è¯´æ˜ï¼š</p>
</blockquote>
<table>
<thead>
<tr>
<th>éªŒè¯å™¨</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.notEmpty()</code></td>
<td>æ£€æŸ¥å­—æ®µæ˜¯å¦ä¸ºç©ºã€‚</td>
</tr>
<tr>
<td><code>.isLength({ min, max })</code></td>
<td>æ£€æŸ¥å­—æ®µçš„å­—ç¬¦é•¿åº¦æ˜¯å¦åœ¨æŒ‡å®šçš„èŒƒå›´å†…ã€‚</td>
</tr>
<tr>
<td><code>.isEmail()</code></td>
<td>æ£€æŸ¥å­—æ®µæ˜¯å¦æ˜¯æœ‰æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€ã€‚</td>
</tr>
<tr>
<td><code>.isURL()</code></td>
<td>æ£€æŸ¥å­—æ®µæ˜¯å¦æ˜¯æœ‰æ•ˆçš„URLã€‚</td>
</tr>
<tr>
<td><code>.isInt()</code></td>
<td>æ£€æŸ¥å­—æ®µæ˜¯å¦ä¸ºæ•´æ•°ã€‚</td>
</tr>
<tr>
<td><code>.isNumeric()</code></td>
<td>æ£€æŸ¥å­—æ®µæ˜¯å¦ä¸ºæ•°å­—ã€‚</td>
</tr>
<tr>
<td><code>.isFloat()</code></td>
<td>æ£€æŸ¥å­—æ®µæ˜¯å¦ä¸ºæµ®ç‚¹æ•°ã€‚</td>
</tr>
<tr>
<td><code>.isDate()</code></td>
<td>æ£€æŸ¥å­—æ®µæ˜¯å¦ä¸ºæœ‰æ•ˆçš„æ—¥æœŸã€‚</td>
</tr>
<tr>
<td><code>.isBoolean()</code></td>
<td>æ£€æŸ¥å­—æ®µæ˜¯å¦ä¸ºå¸ƒå°”å€¼ã€‚</td>
</tr>
<tr>
<td><code>.isIn(values)</code></td>
<td>æ£€æŸ¥å­—æ®µå€¼æ˜¯å¦åœ¨æŒ‡å®šçš„æ•°ç»„ä¸­ã€‚</td>
</tr>
<tr>
<td><code>.isNotIn(values)</code></td>
<td>æ£€æŸ¥å­—æ®µå€¼æ˜¯å¦ä¸åœ¨æŒ‡å®šçš„æ•°ç»„ä¸­ã€‚</td>
</tr>
<tr>
<td><code>.equals(value)</code></td>
<td>æ£€æŸ¥å­—æ®µå€¼æ˜¯å¦ä¸æŒ‡å®šçš„å€¼ç›¸ç­‰ã€‚</td>
</tr>
<tr>
<td><code>.not()</code></td>
<td>åè½¬å‰é¢çš„éªŒè¯æ¡ä»¶ã€‚å¦‚æœä¹‹å‰çš„éªŒè¯æ¡ä»¶ä¸ºçœŸï¼Œå°†å˜ä¸ºå‡ï¼Œåä¹‹äº¦ç„¶ã€‚</td>
</tr>
<tr>
<td><code>.custom(validatorFunction)</code></td>
<td>ä½¿ç”¨è‡ªå®šä¹‰éªŒè¯å‡½æ•°è¿›è¡ŒéªŒè¯ã€‚</td>
</tr>
<tr>
<td><code>.withMessage(message)</code></td>
<td>åœ¨éªŒè¯å¤±è´¥æ—¶è®¾ç½®é”™è¯¯æ¶ˆæ¯ã€‚</td>
</tr>
<tr>
<td><code>.bail()</code></td>
<td>åœ¨éªŒè¯å¤±è´¥æ—¶åœæ­¢æ‰§è¡Œåç»­éªŒè¯é“¾ã€‚</td>
</tr>
</tbody>
</table>
<p>è¿™äº›æ˜¯ä¸€äº›å¸¸è§çš„éªŒè¯è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚ç»„åˆå®ƒä»¬ï¼Œæ„å»ºå¼ºå¤§è€Œçµæ´»çš„éªŒè¯è§„åˆ™é“¾ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨<code>/controller/userController.js</code>ä¸­å¼•å…¥éªŒè¯å™¨å¹¶ä½¿ç”¨ï¼š</p>
<pre><code class="language-js">const express = require('express')
const router = express.Router()
const userController = require('../controller/userController')
//å¼•å…¥éªŒè¯å™¨
const validator = require('../middleware/validator/userValidator')

// ä½¿ç”¨validatorä¸­é—´ä»¶
router
    .post('/register',
        validator.register,
        userController.register)

module.exports = router
</code></pre>
<p>è¿™æ ·åœ¨ç”¨æˆ·æ³¨å†Œçš„æ—¶å€™ï¼Œå°±èƒ½å¯¹ç”¨æˆ·æäº¤çš„æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œä»è€Œé¿å…äº†å‰ç«¯çš„ä¸€äº›å¸¸è§çš„é”™è¯¯ã€‚</p>
<p>è¿™æ—¶å€™æˆ‘ä»¬ä½¿ç”¨<code>apifox</code>å‘èµ·æ³¨å†Œè¯·æ±‚ï¼Œä¸ä¼ ä»»ä½•å‚æ•°ï¼Œå°±ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼š</p>
<pre><code class="language-json">{
    &quot;error&quot;: [
        {
            &quot;type&quot;: &quot;field&quot;,
            &quot;value&quot;: &quot;&quot;,
            &quot;msg&quot;: &quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;,
            &quot;path&quot;: &quot;username&quot;,
            &quot;location&quot;: &quot;body&quot;
        },
        {
            &quot;type&quot;: &quot;field&quot;,
            &quot;msg&quot;: &quot;é‚®ç®±ä¸èƒ½ä¸ºç©º&quot;,
            &quot;path&quot;: &quot;email&quot;,
            &quot;location&quot;: &quot;body&quot;
        },
        {
            &quot;type&quot;: &quot;field&quot;,
            &quot;msg&quot;: &quot;å¯†ç ä¸èƒ½ä¸ºç©º&quot;,
            &quot;path&quot;: &quot;password&quot;,
            &quot;location&quot;: &quot;body&quot;
        }
    ]
}
</code></pre>
<h3 id="æ•°æ®å”¯ä¸€æ€§éªŒè¯">æ•°æ®å”¯ä¸€æ€§éªŒè¯</h3>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åšäº†å¯¹å‚æ•°çš„ä¸€äº›éªŒè¯ï¼Œä½†æ˜¯è¿˜æ˜¯ç¼ºå°‘ä¸€ä¸ªå¯¹æ•°æ®å”¯ä¸€æ€§çš„éªŒè¯ã€‚æ¯”å¦‚æ³¨å†Œæ—¶å€™æˆ‘ä»¬å¯èƒ½è¦æ±‚æ‰‹æœºå·å’Œé‚®ç®±å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚æˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯å€ŸåŠ©<code>express-validator</code>çš„è‡ªå®šä¹‰éªŒè¯å‡½æ•°<code>custom</code>æ¥å®ç°ï¼›å½“ç„¶æˆ‘ä»¬éœ€è¦è¿æ¥åˆ°æ•°æ®åº“è¿›è¡Œæ•°æ®æŸ¥æ‰¾ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬åœ¨<code>middleware/validator/userValidator.js</code>ä¸­æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰éªŒè¯å‡½æ•°ï¼š</p>
<pre><code class="language-js">const { body } = require('express-validator')
const validator = require('./errorBack')
// 1.å¼•å…¥User model 
const { User } = require('../../model/index')

module.exports.register = validator(
    [
        body('username')
            .notEmpty().withMessage('ç”¨æˆ·åä¸èƒ½ä¸ºç©º').bail()
            .isLength({ min: 3, max: 10 }).withMessage('ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-10ä¹‹é—´'),
        body('email')
            .notEmpty().withMessage('é‚®ç®±ä¸èƒ½ä¸ºç©º').bail()
            .isEmail().withMessage('é‚®ç®±æ ¼å¼ä¸æ­£ç¡®')
            .custom(async val =&gt; {
                // 2.æŸ¥è¯¢æ•°æ®åº“
                const emailValidator = await User.findOne({ email: val })
                // 3.åˆ¤æ–­æ˜¯å¦å­˜åœ¨
                if (emailValidator) {
                    return Promise.reject('é‚®ç®±å·²è¢«æ³¨å†Œ')
                }
            }).bail(),
        body('password')
            .notEmpty().withMessage('å¯†ç ä¸èƒ½ä¸ºç©º').bail()
            .isLength({ min: 6, max: 16 }).withMessage('å¯†ç é•¿åº¦å¿…é¡»åœ¨6-16ä¹‹é—´'),
        body('phone')
            .notEmpty().withMessage('æ‰‹æœºå·ä¸èƒ½ä¸ºç©º').bail()
            .isLength({ min: 11 }).withMessage('æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®')
            .custom(async val =&gt; {
                // åŒç†
                const phonelValidator = await User.findOne({ phone: val })
                if (phonelValidator) {
                    return Promise.reject('æ‰‹æœºå·å·²è¢«æ³¨å†Œ')
                }
            }).bail(),
    ]
) 
</code></pre>
<h2 id="restfulæ¥å£è§„èŒƒ">Restfulæ¥å£è§„èŒƒ</h2>
<p>åœ¨é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¥å£è¿›è¡Œè§„èŒƒï¼Œæ¯”å¦‚æ¥å£çš„è·¯å¾„ï¼Œè¯·æ±‚æ–¹å¼ï¼Œå‚æ•°ï¼Œè¿”å›å€¼ç­‰ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‚è€ƒ<a href="https://restfulapi.cn/">restfulapi</a>æ¥å£è§„èŒƒï¼›å½“ç„¶æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸€äº›ä¸šåŠ¡éœ€æ±‚åšå¯¹åº”çš„è°ƒæ•´ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€nodeå­¦ä¹ -07ã€‘æ­å»ºexpressé¡¹ç›®æ¨¡ç‰ˆ]]></title>
        <id>https://lonjinup.github.io/express-07-template/</id>
        <link href="https://lonjinup.github.io/express-07-template/">
        </link>
        <updated>2023-12-10T15:10:23.000Z</updated>
        <content type="html"><![CDATA[<h1 id="æ­å»ºexpressé¡¹ç›®æ¨¡ç‰ˆ">æ­å»ºexpressé¡¹ç›®æ¨¡ç‰ˆ</h1>
<blockquote>
<p>ä¸‹é¢æˆ‘ä»¬å°†ä¸€æ­¥æ­¥æ­å»ºä¸€ä¸ªåŸºæœ¬çš„Expressé¡¹ç›®æ¨¡æ¿ã€‚è¿™ä¸ªæ¨¡æ¿åŒ…æ‹¬é¡¹ç›®ç»“æ„ã€åˆå§‹åŒ–ã€å®‰è£…å¿…è¦çš„ä¾èµ–ã€åˆ›å»ºä¸»æ–‡ä»¶app.jsã€è®¾ç½®è·¯ç”±å’Œæ§åˆ¶å™¨ã€‚æœ€åï¼Œä½ å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚è¿›è¡Œä¿®æ”¹å’Œä¼˜åŒ–ã€‚</p>
</blockquote>
<h2 id="1-é¡¹ç›®ç»“æ„">1. é¡¹ç›®ç»“æ„</h2>
<pre><code>â”œâ”€â”€ app.js
â”œâ”€â”€ config
â”‚   â”œâ”€â”€ config.default.js
â”œâ”€â”€ controllers
â”‚   â”œâ”€â”€ testController.js
â”œâ”€â”€ package.json
â”œâ”€â”€ router
â”‚   â”œâ”€â”€ index.js
â”‚   â”œâ”€â”€ test.js
</code></pre>
<h2 id="2-é¡¹ç›®åˆå§‹åŒ–">2. é¡¹ç›®åˆå§‹åŒ–</h2>
<pre><code class="language-bash">npm init -y
</code></pre>
<h2 id="3-å®‰è£…">3. å®‰è£…</h2>
<pre><code class="language-bash">npm install express // expressæ¡†æ¶
npm install cors // è·¨åŸŸ
npm install morgan // æ—¥å¿—
npm install nodemon // é‡å¯æœåŠ¡
</code></pre>
<h2 id="4-åˆ›å»ºappjsæ–‡ä»¶">4. åˆ›å»ºapp.jsæ–‡ä»¶</h2>
<pre><code class="language-js">const express = require('express')
const app = express()
const cors = require('cors')
const morgan = require('morgan')

// æ•°æ®æ ¼å¼è§£æ
app.use(express.json())
app.use(express.urlencoded())

// è·¨åŸŸ
app.use(cors())

//æ—¥å¿—è®°å½•
app.use(morgan('dev'))

const PORT = process.env.PORT || 3000
app.listen(PORT, () =&gt; {
    console.log(`Server is running on http://localhost:${PORT}`)
})
</code></pre>
<h2 id="5è·¯ç”±æ§åˆ¶å™¨">5.è·¯ç”±&amp;&amp;æ§åˆ¶å™¨</h2>
<p>æ–°å»º<code>/controllers/testController.js</code>æ–‡ä»¶ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼š</p>
<pre><code class="language-js">exports.testGet = async (req, res) =&gt; {
    console.log(req.method)
    res.send('testGet success')
}

exports.testPost = async (req, res) =&gt; {
    console.log(req.method)
    res.send('testPost success')
}
</code></pre>
<p>æ–°å»ºä¸€ä¸ªæµ‹è¯•è·¯ç”±ï¼š<code>/router/test.js</code>ï¼Œå¹¶å¯¼å…¥æ§åˆ¶å™¨ï¼š</p>
<pre><code class="language-js">const express = require('express')
const router = express.Router()
const testController = require('../controller/testController')

router
    .get('/testGet', testController.testGet)
    .post('/testPost', testController.testPost)

module.exports = router
</code></pre>
<p>æ–°å»ºä¸€ä¸ªä¸»è·¯ç”±ï¼š<code>/router/index.js</code>ï¼Œå¹¶å¯¼å…¥æµ‹è¯•è·¯ç”±ï¼š</p>
<pre><code class="language-js">const express = require('express')
const router = express.Router()
const test = require('./test')

router.use(test)

module.exports = router
</code></pre>
<p>åœ¨<code>app.js</code>ä¸­å¯¼å…¥ä¸»è·¯ç”±ï¼š</p>
<pre><code class="language-js">const express = require('express')
const app = express()
const cors = require('cors')
const morgan = require('morgan')
// å¯¼å…¥ä¸»è·¯ç”±
const router = require('./router')

app.use(express.json())
app.use(express.urlencoded())
app.use(cors())
app.use(morgan('dev'))

// è·¯ç”±
app.use('/api/v1', router)

const PORT = process.env.PORT || 3000

app.listen(PORT, () =&gt; {
    console.log(`Server is running on http://localhost:${PORT}`)
})
</code></pre>
<blockquote>
<p>æœ€åŸºæœ¬çš„ä¸€ä¸ªé¡¹ç›®æ¨¡ç‰ˆå°±æ­å»ºå®Œæ¯•äº†ï¼Œåç»­å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚è¿›è¡Œä¿®æ”¹å’Œä¼˜åŒ–ã€‚</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€nodeå­¦ä¹ -06ã€‘expressè¿›é˜¶]]></title>
        <id>https://lonjinup.github.io/node-06-express/</id>
        <link href="https://lonjinup.github.io/node-06-express/">
        </link>
        <updated>2023-11-26T13:57:03.000Z</updated>
        <content type="html"><![CDATA[<h2 id="expressä¸­é—´ä»¶">expressä¸­é—´ä»¶</h2>
<blockquote>
<p>åœ¨<code>Express</code>ä¸­ï¼Œä¸­é—´ä»¶æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„æ¦‚å¿µï¼Œå®ƒå…è®¸ä½ åœ¨è¯·æ±‚è¢«å¤„ç†ä¹‹å‰æˆ–ä¹‹åæ‰§è¡Œä»£ç ã€‚ä¸­é—´ä»¶å‡½æ•°å¯ä»¥è®¿é—®è¯·æ±‚å¯¹è±¡ <code>(req)</code>ã€å“åº”å¯¹è±¡<code> (res)</code>ï¼Œä»¥åŠåº”ç”¨ä¸­çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•° <code>(next)</code>ã€‚</p>
</blockquote>
<p>å‡å¦‚æˆ‘æƒ³åœ¨<code>Express</code>é¡¹ç›®çš„æ¯ä¸€æ¬¡è¯·æ±‚ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæ‰“å°æ—¥å¿—çš„åŠŸèƒ½ï¼Œå¦‚æœåœ¨æ‰€æœ‰çš„è¯·æ±‚ä¸­<code>console</code>æ‰“å°è‚¯å®šä¸ç°å®ï¼Œä¸å¦‚æŠ½å‡ºä¸€ä¸ª<code>logs</code>æ–¹æ³•ï¼Œç„¶ååœ¨æ¯æ¬¡è¯·æ±‚æ—¶å€™å»è°ƒç”¨ï¼š</p>
<pre><code class="language-js">const express = require('express')

const app = express()
const PORT = process.env.PORT || 3000


function logs(req, res) {
    console.log(`${req.method},${req.url}, ${new Date().toLocaleString()}`)
}

app.get('/', (req, res) =&gt; {
    logs(req, res)
    res.send('Hello World')
})

app.get('/login', (req, res) =&gt; {
    logs(req, res)
    res.send('login')
})

app.get('/register', (req, res) =&gt; {
    logs(req, res)
    res.send('register')
})

app.listen(PORT, () =&gt; {
    console.log(`Server is running on http://localhost:${PORT}`)
})
</code></pre>
<p>ä½†æ˜¯è¿™æ ·çš„æ–¹å¼è¿˜æ˜¯æœ‰äº›ä¸æ–¹ä¾¿ï¼›éœ€è¦åœ¨æ¯æ¬¡è¯·æ±‚ä¸­éƒ½å»è°ƒç”¨<code>logs</code>æ–¹æ³•ï¼Œä¸ä»…ä¸æ–¹ä¾¿ï¼Œè€Œä¸”è¿˜ä¼šæœ‰å¾ˆå¤šé‡å¤çš„ä»£ç ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<code>logs</code>æ–¹æ³•ä½œä¸ºä¸€ä¸ªä¸­é—´ä»¶ï¼Œç„¶ååœ¨<code>app.use()</code>ä¸­ä½¿ç”¨å®ƒï¼š</p>
<pre><code class="language-js">const express = require('express')
const app = express()
const PORT = process.env.PORT || 3000


function logs(req, res, next) {
    console.log(`${req.method},${req.url}, ${new Date().toLocaleString()}`)
    // ä¸‹ä¸€æ­¥æ“ä½œ
    next()
}

app.use(logs)

app.get('/', (req, res) =&gt; {
    res.send('Hello World')
})

app.get('/login', (req, res) =&gt; {
    res.send('login')
})

app.get('/register', (req, res) =&gt; {
    res.send('register')
})

app.listen(PORT, () =&gt; {
    console.log(`Server is running on http://localhost:${PORT}`)
})
</code></pre>
<p>åœ¨ <code>Express</code> ä¸­ï¼Œä¸­é—´ä»¶å¯ä»¥å†™åœ¨ <code>app.get</code> æ–¹æ³•ä¹‹å‰ã€ä¹‹åæˆ–ä¹‹é—´ï¼Œå…·ä½“å–å†³äºä¸­é—´ä»¶çš„ä½œç”¨å’Œä½ å¸Œæœ›å®ƒåœ¨è¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­çš„æ‰§è¡Œé¡ºåºã€‚</p>
<h3 id="ä¸­é—´ä»¶åˆ†ç±»">ä¸­é—´ä»¶åˆ†ç±»</h3>
<p>åœ¨ Express æ¡†æ¶ä¸­ï¼Œä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è¯·æ±‚è¢«å‘é€åˆ°è·¯ç”±å¤„ç†ç¨‹åºä¹‹å‰ï¼Œå¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œé¢„å¤„ç†ã€å¤„ç†è¯·æ±‚ã€æˆ–è€…å¯¹å“åº”è¿›è¡Œåå¤„ç†ã€‚Express ä¸­é—´ä»¶å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹ï¼š</p>
<ol>
<li>
<p><strong>åº”ç”¨çº§ä¸­é—´ä»¶</strong>ï¼šåº”ç”¨çº§ä¸­é—´ä»¶ç»‘å®šåˆ° Express çš„åº”ç”¨å®ä¾‹ï¼ˆapp å¯¹è±¡ï¼‰ä¸Šï¼Œå®ƒä»¬é€šè¿‡ <code>app.use()</code> æ–¹æ³•ä½¿ç”¨ã€‚è¿™ç§ä¸­é—´ä»¶èƒ½å¤Ÿå¤„ç†åº”ç”¨ä¸­çš„æ‰€æœ‰è¯·æ±‚ï¼Œå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œä¿®æ”¹ï¼Œæ‰§è¡Œä¸€äº›å…¬å…±ä»»åŠ¡ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ã€èº«ä»½éªŒè¯ç­‰ã€‚</p>
</li>
<li>
<p><strong>è·¯ç”±çº§ä¸­é—´ä»¶</strong>ï¼šè·¯ç”±çº§ä¸­é—´ä»¶ä¸åº”ç”¨çº§ä¸­é—´ä»¶ç±»ä¼¼ï¼Œä½†å®ƒç»‘å®šåˆ°ç‰¹å®šçš„è·¯ç”±ä¸Šï¼Œåªèƒ½å¤„ç†ç‰¹å®šè·¯ç”±çš„è¯·æ±‚ã€‚é€šè¿‡ <code>app.use()</code> æˆ–è€… <code>router.use()</code> æ–¹æ³•ä½¿ç”¨ï¼Œå®ƒèƒ½å¤Ÿä¸ºç‰¹å®šè·¯ç”±çš„è¯·æ±‚æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ï¼Œæ¯”å¦‚éªŒè¯ç”¨æˆ·æƒé™ã€æ•°æ®éªŒè¯ç­‰ã€‚</p>
</li>
<li>
<p><strong>é”™è¯¯å¤„ç†ä¸­é—´ä»¶</strong>ï¼šé”™è¯¯å¤„ç†ä¸­é—´ä»¶ä¸“é—¨ç”¨äºå¤„ç†è¯·æ±‚è¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯ã€‚å½“ä¸€ä¸ªä¸­é—´ä»¶é€šè¿‡ <code>next(err)</code> æ–¹æ³•ä¼ é€’é”™è¯¯æ—¶ï¼Œé”™è¯¯å¤„ç†ä¸­é—´ä»¶å°†è¢«è°ƒç”¨ã€‚å®ƒæ¥æ”¶å››ä¸ªå‚æ•°ï¼ˆerr, req, res, nextï¼‰ï¼Œå¹¶è´Ÿè´£å¤„ç†é”™è¯¯ã€ç”Ÿæˆé”™è¯¯å“åº”ä»¥åŠè®°å½•é”™è¯¯æ—¥å¿—ç­‰æ“ä½œã€‚</p>
</li>
<li>
<p><strong>å†…ç½®ä¸­é—´ä»¶</strong>ï¼šExpress æ¡†æ¶å†…ç½®äº†ä¸€äº›å¸¸ç”¨çš„ä¸­é—´ä»¶ï¼Œæ¯”å¦‚ <code>express.static</code>ï¼ˆç”¨äºæä¾›é™æ€æ–‡ä»¶æœåŠ¡ï¼‰ã€<code>express.json</code>ï¼ˆç”¨äºè§£æ JSON è¯·æ±‚ä½“ï¼‰ã€<code>express.urlencoded</code>ï¼ˆç”¨äºè§£æ URL ç¼–ç çš„è¯·æ±‚ä½“ï¼‰ç­‰ã€‚è¿™äº›å†…ç½®ä¸­é—´ä»¶å¯ä»¥é€šè¿‡ç®€å•çš„é…ç½®æ¥ä½¿ç”¨ï¼Œæä¾›äº†ä¸€äº›åŸºæœ¬çš„åŠŸèƒ½ï¼Œå¯ä»¥å¿«é€Ÿå¼€å‘ Web åº”ç”¨ã€‚</p>
</li>
<li>
<p><strong>ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶</strong>ï¼šé™¤äº†å†…ç½®ä¸­é—´ä»¶ä¹‹å¤–ï¼ŒExpress è¿˜æ”¯æŒç¬¬ä¸‰æ–¹ä¸­é—´ä»¶ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ npm å®‰è£…å¹¶ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æ¥æ‰©å±• Express çš„åŠŸèƒ½ã€‚ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶å¯ä»¥å®ç°å„ç§åŠŸèƒ½ï¼Œæ¯”å¦‚èº«ä»½éªŒè¯ã€æ—¥å¿—è®°å½•ã€æ€§èƒ½ç›‘æ§ç­‰ï¼Œä¸°å¯Œäº† Express ç”Ÿæ€ç³»ç»Ÿï¼Œä¸ºå¼€å‘è€…æä¾›äº†æ›´å¤šé€‰æ‹©ã€‚</p>
</li>
</ol>
<h4 id="åº”ç”¨çº§ä¸­é—´ä»¶">åº”ç”¨çº§ä¸­é—´ä»¶</h4>
<p>åœ¨ Express ä¸­ï¼Œåº”ç”¨çº§ä¸­é—´ä»¶ç›´æ¥ä¸ Express åº”ç”¨çš„å®ä¾‹ç›¸å…³ï¼Œå¯¹æ•´ä¸ªåº”ç”¨ç”Ÿæ•ˆã€‚å®ƒä»¬é€šå¸¸é€šè¿‡ <code>app.use</code> æˆ–è€…å¯¹ç‰¹å®šçš„è·¯ç”±ä½¿ç”¨ <code>app.METHOD</code>ï¼ˆä¾‹å¦‚ <code>app.get</code>ï¼‰æ¥æ³¨å†Œã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="language-javascript">const express = require('express');
const app = express();
const PORT = process.env.PORT || 3000;

// åº”ç”¨çº§ä¸­é—´ä»¶
app.use((req, res, next) =&gt; {
    console.log('This middleware is executed for every request to the app.');
    next(); // è°ƒç”¨ next() å°†æ§åˆ¶æƒä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è·¯ç”±å¤„ç†ç¨‹åº
});

app.get('/user', (req, res, next) =&gt; {
    console.log('Handling user request...');
    next();
}, (req, res) =&gt; {
    res.send('User route response');
});

app.listen(PORT, () =&gt; {
    console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>app.use</code> æ³¨å†Œäº†ä¸€ä¸ªåº”ç”¨çº§ä¸­é—´ä»¶ï¼Œå®ƒåœ¨æ¯ä¸ªè¯·æ±‚åˆ°è¾¾åº”ç”¨æ—¶éƒ½ä¼šæ‰§è¡Œã€‚å¯¹äº <code>/user</code> è·¯ç”±ï¼Œæˆ‘ä»¬é€šè¿‡ <code>app.get</code> æ³¨å†Œäº†ä¸¤ä¸ªä¸­é—´ä»¶ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä¸­é—´ä»¶åœ¨ <code>/user</code> è¯·æ±‚å‰æ‰§è¡Œï¼Œè®°å½•äº†è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹ã€‚</p>
<blockquote>
<p>åº”ç”¨çº§ä¸­é—´ä»¶å¯ä»¥ç”¨äºæ‰§è¡Œä¸€äº›å…¨å±€çš„ä»»åŠ¡ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€èº«ä»½éªŒè¯ã€å¤„ç†è¯·æ±‚ç­‰ã€‚ç”±äºå®ƒä»¬åœ¨æ•´ä¸ªåº”ç”¨èŒƒå›´å†…ç”Ÿæ•ˆï¼Œå› æ­¤é€‚ç”¨äºéœ€è¦åœ¨æ¯ä¸ªè¯·æ±‚ä¸­æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p>
</blockquote>
<h4 id="è·¯ç”±çº§ä¸­é—´ä»¶">è·¯ç”±çº§ä¸­é—´ä»¶</h4>
<p>åœ¨ Express ä¸­ï¼Œè·¯ç”±çº§ä¸­é—´ä»¶æ˜¯ä¸ç‰¹å®šè·¯ç”±æˆ–è·¯ç”±ç»„ç›¸å…³çš„ä¸­é—´ä»¶ã€‚å®ƒä»¬é€šè¿‡ <code>express.Router</code> åˆ›å»ºï¼Œå¹¶é€šè¿‡ <code>app.use</code> æˆ–è€… <code>app.METHOD</code>ï¼ˆä¾‹å¦‚ <code>app.get</code>ï¼‰æ¥æ³¨å†Œã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼š</p>
<p>æ–°å»º<code>/router/index.js</code>å’Œ<code>/router/video.js</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>/router/index.js</code>:</li>
</ul>
<pre><code class="language-js">const express = require('express')
const router = express.Router()

router.get('/user', (req, res) =&gt; {
    console.log(req.method)
    res.send('success')
})

router.get('/login', (req, res) =&gt; {
    console.log(req.method)
    res.send('login success')
})

module.exports = router
</code></pre>
<ul>
<li><code>/router/video.js</code>:</li>
</ul>
<pre><code class="language-js">const express = require('express')
const router = express.Router()

router.get('/list', (req, res) =&gt; {
    console.log(req.method)
    res.send('list success')
})

router.get('/detail', (req, res) =&gt; {
    console.log(req.method)
    res.send('detail success')
})

module.exports = router
</code></pre>
<p>ç„¶ååœ¨<code>app.js</code>ä¸­å¼•å…¥å¹¶æ³¨å†Œï¼ŒåŒæ—¶æ³¨å†Œæ—¶å€™ç»™ä»–ä»¬å‰é¢åˆ†åˆ«æ·»åŠ ä¸¤ä¸ªå‰ç¼€<code>/api</code>å’Œ<code>/video</code>:</p>
<pre><code class="language-js">const express = require('express')
const router = require('./router/index')
const videoRouter = require('./router/video')

const app = express()
app.use('/api', router)
app.use('/video', videoRouter)

const PORT = process.env.PORT || 3000

app.listen(PORT, () =&gt; {
    console.log(`Server is running on http://localhost:${PORT}`)
})
</code></pre>
<h4 id="é”™è¯¯å¤„ç†ä¸­é—´ä»¶">é”™è¯¯å¤„ç†ä¸­é—´ä»¶</h4>
<p>åœ¨ Express ä¸­ï¼Œé”™è¯¯å¤„ç†ä¸­é—´ä»¶æ˜¯æŒ‡å¤„ç†é”™è¯¯çš„ä¸­é—´ä»¶ï¼Œå®ƒå¯ä»¥å¤„ç†è¯·æ±‚å’Œå“åº”ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>é”™è¯¯å¤„ç†ä¸­é—´ä»¶å¯ä»¥æ•è·åº”ç”¨ä¸­çš„é”™è¯¯ï¼Œå¹¶å°†å…¶å‘é€ç»™å®¢æˆ·ç«¯ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="language-js">const express = require('express')
const router = require('./router/index')
const videoRouter = require('./router/video')

const app = express()
app.use('/api', router)
app.use('/video', videoRouter)

//æ•è·è·¯ç”±é”™è¯¯
app.use((req, res, next) =&gt; {
    res.status(404).send({
        message: 'Not Found'
    })
})

//æ•è·é”™è¯¯
app.use((err, req, res, next) =&gt; {
    res.status(500).send({
        message: 'server error'
    })
})

const PORT = process.env.PORT || 3000

app.listen(PORT, () =&gt; {
    console.log(`Server is running on http://localhost:${PORT}`)
})
</code></pre>
<h4 id="å†…ç½®ä¸­é—´ä»¶">å†…ç½®ä¸­é—´ä»¶</h4>
<p>Express <a href="https://expressjs.com/zh-cn/api.html#express">å†…ç½®çš„ä¸­é—´</a> ä»¶ä¸»è¦ç”¨äºå¤„ç†å¸¸è§çš„ä»»åŠ¡ï¼Œå¦‚è§£æè¯·æ±‚ä½“ã€å¤„ç†é™æ€æ–‡ä»¶ç­‰ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ Express å†…ç½®ä¸­é—´ä»¶ï¼š</p>
<h3 id="1-expressjson">1. <code>express.json()</code></h3>
<p>ç”¨äºè§£æä¼ å…¥è¯·æ±‚çš„ JSON æ•°æ®ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨ <code>req.body</code> ä¸­ã€‚</p>
<pre><code class="language-javascript">const express = require('express');
const app = express();

app.use(express.json());

app.post('/api/data', (req, res) =&gt; {
  console.log(req.body); // è®¿é—® JSON æ•°æ®
  res.send('Data received successfully.');
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});
</code></pre>
<h3 id="2-expressurlencoded">2. <code>express.urlencoded()</code></h3>
<p>ç”¨äºè§£æä¼ å…¥è¯·æ±‚çš„ URL ç¼–ç æ•°æ®ï¼ˆé€šå¸¸æ¥è‡ªè¡¨å•ï¼‰ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨ <code>req.body</code> ä¸­ã€‚</p>
<pre><code class="language-javascript">const express = require('express');
const app = express();

app.use(express.urlencoded({ extended: true }));

app.post('/api/form', (req, res) =&gt; {
  console.log(req.body); // è®¿é—®è¡¨å•æ•°æ®
  res.send('Form data received successfully.');
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});
</code></pre>
<h3 id="3-expressstatic">3. <code>express.static()</code></h3>
<p>ç”¨äºæä¾›é™æ€æ–‡ä»¶ï¼Œä¾‹å¦‚ HTMLã€CSSã€JavaScript ç­‰ã€‚</p>
<pre><code class="language-javascript">const express = require('express');
const app = express();

app.use(express.static('public'));

app.get('/', (req, res) =&gt; {
  res.sendFile(__dirname + '/public/index.html');
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});
</code></pre>
<h3 id="4-expressrouter">4. <code>express.Router()</code></h3>
<p>è™½ç„¶ä¸æ˜¯ç›´æ¥ä¸­é—´ä»¶ï¼Œä½†ç”¨äºåˆ›å»ºæ¨¡å—åŒ–ã€å¯æŒ‚è½½çš„è·¯ç”±å¤„ç†ç¨‹åºã€‚</p>
<pre><code class="language-javascript">// åœ¨ router.js æ–‡ä»¶ä¸­
const express = require('express');
const router = express.Router();

router.get('/', (req, res) =&gt; {
  res.send('Router response');
});

module.exports = router;

// åœ¨ä¸»åº”ç”¨ä¸­
const express = require('express');
const app = express();
const router = require('./router');

app.use('/api', router);

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});
</code></pre>
<p>è¿™äº›å†…ç½®ä¸­é—´ä»¶ä½¿å¾— Express åº”ç”¨æ›´æ˜“äºå¼€å‘ï¼Œå¹¶æä¾›äº†ä¸€äº›åŸºæœ¬çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„é…ç½®å³å¯ä½¿ç”¨ã€‚</p>
<h4 id="ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶">ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶</h4>
<p>Express ç¤¾åŒºæä¾›äº†è®¸å¤š<a href="%5B111%5D(https://expressjs.com/zh-cn/resources/middleware.html)">ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶</a>ï¼Œè¿™äº›ä¸­é—´ä»¶å¯ä»¥ç”¨äºå¢å¼º Express åº”ç”¨çš„åŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶ï¼š</p>
<ul>
<li><code>body-parser</code></li>
</ul>
<blockquote>
<p>ç”¨äºè§£æè¯·æ±‚ä½“ï¼Œæ”¯æŒ JSONã€URL ç¼–ç å’Œå¤šéƒ¨åˆ†æ•°æ®ã€‚</p>
</blockquote>
<pre><code class="language-bash">npm install body-parser
</code></pre>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="language-javascript">const express = require('express');
const bodyParser = require('body-parser');
const app = express();

app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));

app.post('/api/data', (req, res) =&gt; {
  console.log(req.body); // è®¿é—® JSON æˆ– URL ç¼–ç æ•°æ®
  res.send('Data received successfully.');
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});
</code></pre>
<ul>
<li><code>helmet</code></li>
</ul>
<blockquote>
<p>æä¾›äº†ä¸€ç³»åˆ— HTTP å¤´çš„è®¾ç½®ï¼Œå¸®åŠ©æé«˜ Express åº”ç”¨çš„å®‰å…¨æ€§ã€‚</p>
</blockquote>
<pre><code class="language-bash">npm install helmet
</code></pre>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="language-javascript">const express = require('express');
const helmet = require('helmet');
const app = express();

app.use(helmet());

app.get('/', (req, res) =&gt; {
  res.send('Hello, World!');
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});
</code></pre>
<ul>
<li><code>compression</code></li>
</ul>
<blockquote>
<p>ç”¨äºå‹ç¼©å“åº”ä½“ï¼Œå‡å°ä¼ è¾“æ•°æ®çš„å¤§å°ã€‚</p>
</blockquote>
<pre><code class="language-bash">npm install compression
</code></pre>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="language-javascript">const express = require('express');
const compression = require('compression');
const app = express();

app.use(compression());

app.get('/', (req, res) =&gt; {
  res.send('Compressed response.');
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});
</code></pre>
<ul>
<li><code>morgan</code></li>
</ul>
<blockquote>
<p>ç”¨äºè®°å½• HTTP è¯·æ±‚çš„æ—¥å¿—ã€‚</p>
</blockquote>
<pre><code class="language-bash">npm install morgan
</code></pre>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="language-javascript">const express = require('express');
const morgan = require('morgan');
const app = express();

app.use(morgan('combined'));

app.get('/', (req, res) =&gt; {
  res.send('Hello, World!');
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});
</code></pre>
<p>è¿™åªæ˜¯ä¸€å°éƒ¨åˆ†å¯ç”¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶ã€‚æ ¹æ®åº”ç”¨éœ€æ±‚ï¼Œä½ å¯ä»¥é€‰æ‹©å¹¶å®‰è£…é€‚åˆçš„ä¸­é—´ä»¶æ¥å¢å¼º Express åº”ç”¨çš„åŠŸèƒ½ã€‚</p>
<h2 id="expressè·¯ç”±">Expressè·¯ç”±</h2>
<p><code>all</code>æ–¹æ³•ç”¨äºåŒ¹é…æ‰€æœ‰ HTTP åŠ¨è¯ï¼ˆGETã€POSTã€PUTã€DELETE å’Œ OPTIONSï¼‰ã€‚</p>
<pre><code class="language-javascript">const express = require('express')
const app = express()
const PORT = process.env.PORT || 3000

app.all('/*', (req, res) =&gt; {
    res.send('all')
})

app.listen(PORT, () =&gt; {
    console.log(`Server is running on http://localhost:${PORT}`)
})
</code></pre>
<h3 id="è·¯ç”±è·¯å¾„">è·¯ç”±è·¯å¾„</h3>
<blockquote>
<p>è·¯ç”±è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²æ¨¡å¼ã€‚å¯ç”¨éƒ¨åˆ†æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•æ¥å®šä¹‰ç«¯ç‚¹çš„æ¨¡å¼ã€‚ä»¥ä¸‹æ˜¯æ‰€æ¶‰åŠçš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆæ³¨æ„ï¼Œè¿å­—ç¬¦ï¼ˆ -ï¼‰å’Œç‚¹ï¼ˆ.ï¼‰åœ¨å­—ç¬¦ä¸²è·¯å¾„ä¸­è§£é‡Šä¸ºå­—é¢é‡ï¼Œä¸èƒ½åšä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼‰</p>
</blockquote>
<ul>
<li>è·¯å¾„ä¸­<code>?</code>ç”¨äºåŒ¹é…è·¯å¾„ä¸­åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦çš„è·¯å¾„ã€‚</li>
</ul>
<pre><code class="language-js">const express = require('express')
const app = express()


app.get('/us?er', (req, res) =&gt; {
    res.send(`${req.url}`)
})

const PORT = process.env.PORT || 3000

app.listen(PORT, () =&gt; {
    console.log(`Server is running on http://localhost:${PORT}`)
})
</code></pre>
<p>è¯·æ±‚ä¸‹é¢æ¥å£éƒ½å¯ä»¥è¯·æ±‚é€šï¼š</p>
<pre><code class="language-js">http://localhost:3000/uer
http://localhost:3000/user
</code></pre>
<ul>
<li>è·¯å¾„ä¸­<code>+</code>ç”¨äºåŒ¹é…è·¯å¾„ä¸­åŒ…å«å¤šä¸ªå­—ç¬¦çš„è·¯å¾„ã€‚</li>
</ul>
<pre><code class="language-js">const express = require('express')
const app = express()


app.get('/us+er', (req, res) =&gt; {
    res.send(`${req.url}`)
})

const PORT = process.env.PORT || 3000

app.listen()
</code></pre>
<p>åªè¦è¯·æ±‚ä¸‹é¢çš„è·¯å¾„éƒ½å¯ä»¥è¯·æ±‚é€š</p>
<pre><code class="language-js">http://localhost:3000/user
http://localhost:3000/ussser
http://localhost:3000/usssser
</code></pre>
<ul>
<li>è·¯å¾„ä¸­<code>*</code>å¯ä»¥æ›¿æ¢ä¸ºä»»æ„å­—ç¬¦ä¸²</li>
</ul>
<pre><code class="language-js">const express = require('express')
const app = express()


app.get('/us+er', (req, res) =&gt; {
    res.send(`${req.url}`)
})

const PORT = process.env.PORT || 3000

app.listen()
</code></pre>
<p>åªè¦è¯·æ±‚ä¸‹é¢çš„è·¯å¾„éƒ½å¯ä»¥è¯·æ±‚é€š</p>
<pre><code class="language-js">http://localhost:3000/ussssser
http://localhost:3000/usABCer
</code></pre>
<h3 id="è·¯ç”±å‚æ•°">è·¯ç”±å‚æ•°</h3>
<blockquote>
<p>è·¯ç”±å‚æ•°æ˜¯æŒ‡åœ¨è·¯å¾„ä¸­ä½¿ç”¨å†’å·ï¼ˆ:ï¼‰æ¥å®šä¹‰çš„éƒ¨åˆ†ã€‚</p>
</blockquote>
<pre><code class="language-js">const express = require('express')
const app = express()


app.get('/user/:id', (req, res) =&gt; {
    console.log(req.params)
    res.send(`${req.url}`)
})

const PORT = process.env.PORT || 3000

app.listen()
</code></pre>
<p>è¯·æ±‚ä¸‹é¢æ¥å£éƒ½å¯ä»¥è¯·æ±‚é€šï¼š</p>
<pre><code class="language-js">http://localhost:3000/user/123 // è¾“å‡º { id: '123' }
http://localhost:3000/user/abc // è¾“å‡º { id: 'abc' }

</code></pre>
<p>ä¹Ÿå¯ä»¥è®¾ç½®å¤šä¸ªè·¯ç”±å‚æ•°</p>
<pre><code class="language-js">const express = require('express')
const app = express()


app.get('/user/:id/:name', (req, res) =&gt; {
    console.log(req.params)
    res.send(`${req.url}`)
})

const PORT = process.env.PORT || 3000

app.listen()
</code></pre>
<p>è¯·æ±‚ä¸‹é¢æ¥å£éƒ½å¯ä»¥è¯·æ±‚é€šï¼š</p>
<pre><code class="language-js">http://localhost:3000/user/123/abc // è¾“å‡º { id: '123', name: 'abc' }
http://localhost:3000/user/abc/123 // è¾“å‡º { id: 'abc', name: '123' }
</code></pre>
<h3 id="é“¾å¼è·¯ç”±">é“¾å¼è·¯ç”±</h3>
<blockquote>
<p>é“¾å¼è·¯ç”±æ˜¯æŒ‡åœ¨ä¸€ä¸ªè·¯ç”±ä¸­å®šä¹‰å¦ä¸€ä¸ªè·¯ç”±ï¼Œå¹¶åœ¨è¯¥è·¯ç”±ä¸­å®šä¹‰å…¶å®ƒçš„è·¯ç”±ã€‚</p>
</blockquote>
<pre><code class="language-js">const express = require('express')
const app = express()

app.get('/user', (req, res) =&gt; {
    res.send(`${req.url}`)
}).post('/login', (req, res) =&gt; {
    res.send(`${req.url}`)
})

const PORT = process.env.PORT || 3000
app.listen()
</code></pre>
<h3 id="å“åº”æ–¹æ³•">å“åº”æ–¹æ³•</h3>
<blockquote>
<p>å“åº”æ–¹æ³•ç”¨äºå‘å®¢æˆ·ç«¯å‘é€å“åº”ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒé“¾å¼è°ƒç”¨ã€‚</p>
</blockquote>
<p><code>res.send()</code>æ–¹æ³•ç”¨äºå‘é€å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="language-js">const express = require('express')
const app = express()

app.get('/user', (req, res) =&gt; {
    res.send('Hello, World!')
})

const PORT = process.env.PORT || 3000
app.listen()
</code></pre>
<p><code>res.download()</code>æ–¹æ³•ç”¨äºä¸‹è½½æ–‡ä»¶ã€‚</p>
<pre><code class="language-js">const express = require('express')
const app = express()

app.get('/user', (req, res) =&gt; {
    res.download('path/to/file')
})

const PORT = process.env.PORT || 3000
app.listen()
</code></pre>
<p><code>res.json()</code>æ–¹æ³•ç”¨äºå‘é€ JSON æ•°æ®ã€‚</p>
<pre><code class="language-js">const express = require('express')
const app = express()

app.get('/user', (req, res) =&gt; {
    res.json({
        name: 'John Doe',
        age: 30
    })
})

const PORT = process.env.PORT || 3000
app.listen()
</code></pre>
<p><code>res.end()</code>æ–¹æ³•ç”¨äºç»“æŸå“åº”ã€‚</p>
<pre><code class="language-js">const express = require('express')
const app = express()

app.get('/user', (req, res) =&gt; {
    res.end('Hello, World!')
})

const PORT = process.env.PORT || 3000
app.listen()
</code></pre>
<p><code>res.redirect()</code>æ–¹æ³•ç”¨äºé‡å®šå‘åˆ°å¦ä¸€ä¸ª URLã€‚</p>
<pre><code class="language-js">const express = require('express')
const app = express()

app.get('/user', (req, res) =&gt; {
    res.redirect('/login')
})

const PORT = process.env.PORT || 3000
app.listen()
</code></pre>
<p><code>res.render()</code>æ–¹æ³•ç”¨äºæ¸²æŸ“æ¨¡æ¿ã€‚</p>
<pre><code class="language-js">const express = require('express')
const app = express()

app.get('/user', (req, res) =&gt; {
    res.render('index', {
        title: 'Hello, World!'
    })
})

const PORT = process.env.PORT || 3000
app.listen()
</code></pre>
<p><code>res.sendStatus()</code>æ–¹æ³•ç”¨äºè®¾ç½®å“åº”çŠ¶æ€ç ã€‚</p>
<pre><code class="language-js">const express = require('express')
const app = express()

app.get('/user', (req, res) =&gt; {
    res.sendStatus(200)
})

const PORT = process.env.PORT || 3000
app.listen()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€nodeå­¦ä¹ -05ã€‘mongoDBåŸºç¡€]]></title>
        <id>https://lonjinup.github.io/mongodb-study/</id>
        <link href="https://lonjinup.github.io/mongodb-study/">
        </link>
        <updated>2023-11-21T15:48:25.000Z</updated>
        <content type="html"><![CDATA[<h1 id="mongodbåŸºç¡€">mongoDBåŸºç¡€</h1>
<h2 id="ç®€ä»‹">ç®€ä»‹</h2>
<p><a href="https://www.mongodb.com/try/download/community">mongoDB</a>æ˜¯ä¸€ç§åŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ï¼Œç”± C++ è¯­è¨€ç¼–å†™ã€‚ç”± MongoDB è‡ªèº«æä¾›çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨ï¼Œä»¥åŠç¬¬ä¸‰æ–¹æä¾›çš„å„ç§æ•°æ®åº“ç®¡ç†å·¥å…·ï¼ŒåŒ…æ‹¬ç”¨äºæŸ¥è¯¢å’Œåˆ†æçš„ MongoDB è‡ªå¸¦çš„ shell å·¥å…·ã€‚</p>
<h2 id="ç‰¹ç‚¹">ç‰¹ç‚¹</h2>
<ul>
<li>é«˜æ€§èƒ½ï¼šMongoDB æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ NoSQL æ•°æ®åº“ï¼Œæ˜¯å½“å‰æœ€æµè¡Œçš„<code>éå…³ç³»å‹</code>æ•°æ®åº“ä¹‹ä¸€ã€‚</li>
<li>æ˜“ç”¨æ€§ï¼šMongoDB æ˜¯ä¸€ä¸ªåŸºäºæ–‡æ¡£çš„æ•°æ®åº“ï¼Œä¸éœ€è¦å…³ç³»å‹æ•°æ®åº“çš„ SQL è¯­è¨€ï¼Œå³ä½¿å¯¹æ•°æ®åº“çš„æ“ä½œä¹Ÿä¸éœ€è¦å…³ç³»å‹æ•°æ®åº“çš„ DDL è¯­è¨€ã€‚</li>
<li>çµæ´»æ€§ï¼šMongoDB æ˜¯ä¸€ä¸ªåŸºäºæ–‡æ¡£çš„æ•°æ®åº“ï¼Œå¯ä»¥å­˜å‚¨å„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ–‡æ¡£ã€æ•°ç»„ã€å¯¹è±¡ã€äºŒè¿›åˆ¶æ•°æ®ç­‰ã€‚</li>
<li>é«˜å¯ç”¨æ€§ï¼šMongoDB æ˜¯ä¸€ä¸ªé«˜å¯ç”¨æ€§çš„æ•°æ®åº“ï¼Œå¯ä»¥ä¿è¯æ•°æ®çš„å®‰å…¨æ€§å’Œå¯ç”¨æ€§ã€‚</li>
<li>ä½æˆæœ¬ï¼šMongoDB æ˜¯ä¸€ä¸ªå¼€æºçš„æ•°æ®åº“ï¼Œä½¿ç”¨ C++ ç¼–å†™ï¼Œå› æ­¤å…·æœ‰è¾ƒé«˜çš„å¼€å‘æ•ˆç‡ï¼Œéƒ¨ç½²æ–¹ä¾¿ï¼Œæˆæœ¬ä½å»‰ã€‚</li>
<li>é«˜æ‰©å±•æ€§ï¼šMongoDB æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œå¯ä»¥æ°´å¹³æ‰©å±•ï¼Œå³å¯ä»¥å°†æ•°æ®å¤åˆ¶åˆ°å¤šå°æœåŠ¡å™¨ä¸Šï¼Œå®ç°æ•°æ®çš„é«˜å¯ç”¨æ€§ã€‚</li>
</ul>
<h3 id="éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“çš„åŒºåˆ«">éå…³ç³»å‹æ•°æ®åº“å’Œå…³ç³»å‹æ•°æ®åº“çš„åŒºåˆ«</h3>
<ul>
<li>éå…³ç³»å‹æ•°æ®åº“ï¼šéå…³ç³»å‹æ•°æ®åº“ä¸ä»…ä»…æ˜¯æŒ‡æ•°æ®åº“çš„å­˜å‚¨ç»“æ„ï¼Œè€Œæ˜¯æŒ‡æ•°æ®åº“çš„å­˜å‚¨ç»“æ„å’Œæ•°æ®åº“çš„æ“ä½œæ–¹å¼ã€‚</li>
<li>å…³ç³»å‹æ•°æ®åº“ï¼šå…³ç³»å‹æ•°æ®åº“æ˜¯æŒ‡æ•°æ®åº“çš„å­˜å‚¨ç»“æ„å’Œæ•°æ®åº“çš„æ“ä½œæ–¹å¼ã€‚</li>
</ul>
<h3 id="å…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“çš„ä¼˜ç¼ºç‚¹">å…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“çš„ä¼˜ç¼ºç‚¹</h3>
<ul>
<li>å…³ç³»å‹æ•°æ®åº“çš„ä¼˜ç‚¹ï¼šå…³ç³»å‹æ•°æ®åº“çš„ä¼˜ç‚¹æ˜¯å¯ä»¥å®ç°å…³ç³»å‹æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œæ•°æ®æ›´æ–°ï¼Œæ•°æ®åˆ é™¤ç­‰æ“ä½œï¼Œå¹¶ä¸”è¿™äº›æ“ä½œéƒ½æ˜¯äº‹åŠ¡æ€§çš„ï¼Œå³è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚</li>
<li>å…³ç³»å‹æ•°æ®åº“çš„ç¼ºç‚¹ï¼šå…³ç³»å‹æ•°æ®åº“çš„ç¼ºç‚¹æ˜¯å…³ç³»å‹æ•°æ®åº“çš„æŸ¥è¯¢æ€§èƒ½ä¸é«˜ï¼Œå› ä¸ºå…³ç³»å‹æ•°æ®åº“çš„æŸ¥è¯¢æ˜¯åŸºäºè¡¨çš„è¿æ¥æŸ¥è¯¢ï¼Œè€Œéå…³ç³»å‹æ•°æ®åº“çš„æŸ¥è¯¢æ˜¯åŸºäºæ–‡æ¡£çš„åµŒå¥—æŸ¥è¯¢</li>
</ul>
<h3 id="mongodbä½¿ç”¨åœºæ™¯">mongoDBä½¿ç”¨åœºæ™¯</h3>
<ul>
<li>å­˜å‚¨æµ·é‡æ•°æ®</li>
<li>å­˜å‚¨åŠ¨æ€æ•°æ®</li>
<li>å­˜å‚¨å¤§é‡çš„ç»“æ„åŒ–å’Œéç»“æ„åŒ–æ•°æ®</li>
<li>å­˜å‚¨é«˜å¹¶å‘æ•°æ®</li>
<li>å­˜å‚¨å¤§é‡çš„é™æ€æ•°æ®</li>
<li>å­˜å‚¨å¤§é‡çš„åŠç»“æ„åŒ–æ•°æ®</li>
<li>å­˜å‚¨å¤§é‡çš„éç»“æ„åŒ–æ•°æ®</li>
<li>å­˜å‚¨å¤§é‡çš„å…³ç³»æ•°æ®</li>
<li>å­˜å‚¨å¤§é‡çš„æ–‡æ¡£æ•°æ®</li>
</ul>
<h2 id="å®‰è£…">å®‰è£…</h2>
<blockquote>
<p><code>mongoDB</code>ç‰ˆæœ¬å·å¥‡æ•°ä¸ºæµ‹è¯•ç‰ˆæœ¬ï¼Œå¶æ•°ä¸ºç¨³å®šç‰ˆæœ¬ï¼Œè€Œä¸”åœ¨3.2ç‰ˆæœ¬ä¹‹åä¸å†æ”¯æŒ32ä½ç³»ç»Ÿï¼Œæ‰€ä»¥å»ºè®®å®‰è£…64ä½çš„ç³»ç»Ÿã€‚ç”±äºä¸åŒæ“ä½œç³»ç»Ÿå®‰è£…æ–¹å¼ç•¥æœ‰ä¸åŒï¼Œå»ºè®®googleä¸€ä¸‹æˆ–è€…è¿›å…¥<a href="https://www.mongodb.com/try/download/community">mongoDBå®˜ç½‘</a>è¿›è¡Œå®‰è£…ã€‚åŒæ—¶æ¨èä¸‹è½½<code>Navicat Premium</code>æ¥è¿›è¡Œæ•°æ®åº“çš„ç®¡ç†ã€‚</p>
</blockquote>
<h2 id="mongodbçš„åŸºç¡€æ¦‚å¿µ">MongoDBçš„åŸºç¡€æ¦‚å¿µ</h2>
<h3 id="æ•°æ®å­˜å‚¨ç»“æ„åŠå­˜å‚¨åº“">æ•°æ®å­˜å‚¨ç»“æ„åŠå­˜å‚¨åº“</h3>
<p>åœ¨ MongoDB ä¸­ï¼Œæ•°æ®å­˜å‚¨ç»“æ„ä¸»è¦ç”±é›†åˆï¼ˆCollectionï¼‰å’Œæ–‡æ¡£ï¼ˆDocumentï¼‰ç»„æˆã€‚è¿™ç§éå…³ç³»å‹æ•°æ®åº“çš„è®¾è®¡çµæ„Ÿæ¥æºäº JSON æ–‡ä»¶æ ¼å¼ï¼Œå› æ­¤éå¸¸çµæ´»ï¼Œé€‚ç”¨äºå¤„ç†å„ç§ä¸åŒå½¢å¼çš„æ•°æ®ã€‚</p>
<h4 id="é›†åˆ">é›†åˆ</h4>
<p>é›†åˆæ˜¯ MongoDB ä¸­çš„ä¸€ç§æ•°æ®ç»„ç»‡æ–¹å¼ï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­çš„è¡¨ã€‚ä¸åŒçš„æ˜¯ï¼Œé›†åˆå¹¶ä¸è¦æ±‚å…¶ä¸­çš„æ–‡æ¡£å…·æœ‰ç›¸åŒçš„ç»“æ„ï¼Œå¯ä»¥å®¹çº³å„ç§å½¢å¼å’Œç±»å‹çš„æ•°æ®ã€‚é›†åˆçš„å‘½åé€šå¸¸é‡‡ç”¨å°å†™å­—æ¯ï¼Œé¿å…ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦å’Œç©ºæ ¼ã€‚</p>
<h5 id="ç¤ºä¾‹">ç¤ºä¾‹</h5>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåšå®¢åº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªé›†åˆåä¸º &quot;articles&quot;ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰æ–‡ç« çš„æ•°æ®ã€‚æ¯ç¯‡æ–‡ç« å¯ä»¥å…·æœ‰ä¸åŒçš„å­—æ®µï¼Œä¾‹å¦‚æ ‡é¢˜ã€ä½œè€…ã€å†…å®¹ç­‰ã€‚ç¤ºä¾‹åˆ›å»ºé›†åˆçš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="language-bash">db.createCollection(&quot;articles&quot;)
</code></pre>
<h4 id="æ–‡æ¡£">æ–‡æ¡£</h4>
<p>æ–‡æ¡£æ˜¯ MongoDB å­˜å‚¨æ•°æ®çš„åŸºæœ¬å•å…ƒï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­çš„è¡Œã€‚æ¯ä¸ªæ–‡æ¡£éƒ½æ˜¯ä¸€ä¸ª JSON é£æ ¼çš„å¯¹è±¡ï¼Œå¯ä»¥åŒ…å«å„ç§å­—æ®µå’Œå€¼ã€‚åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Œæ–‡æ¡£çš„ç»“æ„å¯ä»¥æ˜¯ä¸åŒçš„ï¼Œè¿™ä½¿å¾— MongoDB èƒ½å¤Ÿè½»æ¾åœ°é€‚åº”å˜åŒ–å¤šç«¯çš„æ•°æ®éœ€æ±‚ã€‚</p>
<p>å½“æˆ‘ä»¬ä½¿ç”¨ MongoDB å­˜å‚¨æ•°æ®æ—¶ï¼Œæ–‡æ¡£çš„è¡¨ç¤ºæ–¹å¼ä¸ JSON éå¸¸ç›¸ä¼¼ã€‚ä»¥ä¸‹æ˜¯æ–‡æ¡£çš„ JSON æ ¼å¼ç¤ºä¾‹ï¼š</p>
<pre><code class="language-json">// åœ¨ &quot;articles&quot; é›†åˆä¸­æ’å…¥ä¸€ç¯‡æ–‡ç« çš„æ–‡æ¡£
db.articles.insert({
  &quot;title&quot;: &quot;MongoDB Basics&quot;,
  &quot;author&quot;: &quot;John Doe&quot;,
  &quot;content&quot;: &quot;An introduction to MongoDB and its key concepts.&quot;,
  &quot;tags&quot;: [&quot;NoSQL&quot;, &quot;Database&quot;]
})
</code></pre>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º &quot;articles&quot; çš„é›†åˆï¼Œå¹¶å‘è¯¥é›†åˆæ’å…¥äº†ä¸€ç¯‡æ–‡ç« çš„æ–‡æ¡£ã€‚æ–‡æ¡£çš„ç»“æ„ä»¥ JSON æ ¼å¼è¡¨ç¤ºï¼ŒåŒ…å«äº†æ ‡é¢˜ã€ä½œè€…ã€å†…å®¹å’Œæ ‡ç­¾ç­‰å­—æ®µã€‚</p>
<p>MongoDB çš„çµæ´»æ€§ä½¿å¾—æ–‡æ¡£å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è‡ªç”±å®šä¹‰å­—æ®µï¼Œè€Œé›†åˆåˆ™æä¾›äº†ä¸€ä¸ªå®¹çº³ä¸åŒæ–‡æ¡£çš„å®¹å™¨ã€‚è¿™ç§æ–¹å¼ä½¿å¾— MongoDB é€‚ç”¨äºå¤„ç†å„ç§æ•°æ®ç»“æ„å’Œæ•°æ®å˜åŒ–çš„åœºæ™¯ã€‚</p>
<p>é€šè¿‡é›†åˆå’Œæ–‡æ¡£ï¼ŒMongoDB æä¾›äº†ä¸€ç§ç›´è§‚ä¸”å¼ºå¤§çš„æ–¹å¼æ¥å­˜å‚¨å’Œç»„ç»‡æ•°æ®ï¼Œé€‚åº”ä¸åŒæ•°æ®ç»“æ„å’Œå˜åŒ–ã€‚è¿™ç§çµæ´»æ€§æ˜¯ MongoDB çš„ä¸€é¡¹å…³é”®ç‰¹æ€§ï¼Œä½¿å…¶æˆä¸ºå¤„ç†å„ç§æ•°æ®åœºæ™¯çš„ç†æƒ³é€‰æ‹©ã€‚</p>
<h3 id="å¸¸ç”¨-mongodb-æŒ‡ä»¤">å¸¸ç”¨ MongoDB æŒ‡ä»¤</h3>
<p>è¿™æ˜¯ä¸€äº›å¸¸ç”¨çš„ MongoDB å‘½ä»¤ï¼Œæ–¹ä¾¿å¤§å®¶ç†Ÿæ‚‰ MongoDB çš„ä½¿ç”¨ã€‚</p>
<table>
<thead>
<tr>
<th>æŒ‡ä»¤</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mongo</code></td>
<td>è¿æ¥åˆ° MongoDB æ•°æ®åº“</td>
</tr>
<tr>
<td><code>show dbs</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“</td>
</tr>
<tr>
<td><code>use db_name</code></td>
<td>åˆ‡æ¢åˆ°æŒ‡å®šçš„æ•°æ®åº“</td>
</tr>
<tr>
<td><code>db</code></td>
<td>æ˜¾ç¤ºå½“å‰æ•°æ®åº“</td>
</tr>
<tr>
<td><code>db.dropDatabase()</code></td>
<td>åˆ é™¤å½“å‰æ•°æ®åº“</td>
</tr>
<tr>
<td><code>show collections</code></td>
<td>æ˜¾ç¤ºå½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰é›†åˆ</td>
</tr>
<tr>
<td><code>db.createCollection(name)</code></td>
<td>åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆ</td>
</tr>
<tr>
<td><code>db.collectionName.insert(document)</code></td>
<td>åœ¨æŒ‡å®šé›†åˆä¸­æ’å…¥æ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.find()</code></td>
<td>æŸ¥è¯¢æŒ‡å®šé›†åˆä¸­çš„æ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.update(query, update)</code></td>
<td>æ›´æ–°æŒ‡å®šé›†åˆä¸­ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.remove(query)</code></td>
<td>åˆ é™¤æŒ‡å®šé›†åˆä¸­ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.drop()</code></td>
<td>åˆ é™¤æŒ‡å®šé›†åˆ</td>
</tr>
<tr>
<td><code>db.collectionName.find().sort({field: 1})</code></td>
<td>æŒ‰æŒ‡å®šå­—æ®µå‡åºæ’åºæ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.find().sort({field: -1})</code></td>
<td>æŒ‰æŒ‡å®šå­—æ®µé™åºæ’åºæ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.find().limit(n)</code></td>
<td>é™åˆ¶æŸ¥è¯¢ç»“æœè¿”å›çš„æ–‡æ¡£æ•°é‡</td>
</tr>
<tr>
<td><code>db.collectionName.find().skip(n)</code></td>
<td>è·³è¿‡æŒ‡å®šæ•°é‡çš„æ–‡æ¡£ï¼Œè¿”å›å‰©ä½™çš„æ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.find({field: value})</code></td>
<td>æŸ¥è¯¢æŒ‡å®šå­—æ®µç­‰äºç»™å®šå€¼çš„æ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.find({field: { $gt: value }})</code></td>
<td>æŸ¥è¯¢æŒ‡å®šå­—æ®µå¤§äºç»™å®šå€¼çš„æ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.find({field: { $lt: value }})</code></td>
<td>æŸ¥è¯¢æŒ‡å®šå­—æ®µå°äºç»™å®šå€¼çš„æ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.find({field: /pattern/})</code></td>
<td>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥è¯¢æŒ‡å®šå­—æ®µçš„æ–‡æ¡£</td>
</tr>
<tr>
<td><code>db.collectionName.aggregate(pipeline)</code></td>
<td>æ‰§è¡Œèšåˆæ“ä½œï¼ˆä¾‹å¦‚ï¼Œåˆ†ç»„ã€ç­›é€‰ã€æ’åºï¼‰</td>
</tr>
<tr>
<td><code>db.collectionName.ensureIndex({field: 1})</code></td>
<td>åˆ›å»ºç´¢å¼•ä»¥åŠ é€ŸæŸ¥è¯¢</td>
</tr>
<tr>
<td><code>db.collectionName.getIndexes()</code></td>
<td>æŸ¥çœ‹é›†åˆçš„ç´¢å¼•</td>
</tr>
</tbody>
</table>
<h2 id="åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥">åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥</h2>
<p>MongoDB æ˜¯ä¸€ä¸ªåŸºäºæ–‡æ¡£çš„æ•°æ®åº“ï¼Œè¿™æ„å‘³ç€ï¼Œä¸å…³ç³»å‹æ•°æ®åº“ç›¸æ¯”ï¼ŒMongoDB ä¸­çš„æ•°æ®å­˜å‚¨æ›´åŠ çµæ´»ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåå­—ä¸º<code>mytest</code>çš„æ•°æ®åº“ï¼š</p>
<pre><code class="language-bash">use mytest
</code></pre>
<p>å¹¶ä¸”åˆ›é€ ä¸€ä¸ªåå­—ä¸º<code>user</code>çš„é›†åˆï¼š</p>
<pre><code class="language-bash">db.createCollection(&quot;user&quot;)
</code></pre>
<h4 id="å¢">å¢</h4>
<p>åœ¨<code>user</code>é›†åˆä¸­å¢åŠ å•æ¡æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.insertOne({name: 'lonjin', age: 18})
</code></pre>
<p>åœ¨<code>user</code>é›†åˆä¸­å¢åŠ å¤šæ¡æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.insertMany([
    {name: 'lonjin2', age: 22},
    {name: 'lonjin3', age: 33}
])
</code></pre>
<h4 id="æŸ¥">æŸ¥</h4>
<p>åœ¨<code>user</code>é›†åˆä¸­æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.find()
</code></pre>
<p>åœ¨<code>user</code>é›†åˆä¸­æŸ¥è¯¢æŒ‡å®šæ¡ä»¶çš„æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.find({age: 18})
</code></pre>
<p>åœ¨<code>user</code>é›†åˆä¸­æŸ¥è¯¢æŒ‡å®šæ¡ä»¶çš„æ•°æ®ï¼ˆæŸ¥è¯¢ageç­‰äº18çš„æ•°æ®ï¼‰ï¼š</p>
<pre><code class="language-bash">db.user.find({age: 18})
</code></pre>
<p>åœ¨<code>user</code>é›†åˆä¸­æŸ¥è¯¢<code>age</code>å¤§äº18çš„æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.find({age: {$gt: 18}})
</code></pre>
<p>åœ¨<code>user</code>é›†åˆä¸­æŸ¥è¯¢<code>age</code>å¤§äº18çš„æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.find({age: {$gt: 18}})
</code></pre>
<p>åœ¨<code>user</code>é›†åˆä¸­æŸ¥è¯¢<code>age</code>å¤§äº18çš„æ•°æ®ï¼Œå¹¶ä¸”åªè¾“å‡ºç¬¦åˆæ¡ä»¶çš„ä¸€æ¡æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.findOne({age: {$gt: 18}})
</code></pre>
<h4 id="æ”¹">æ”¹</h4>
<p>åœ¨<code>user</code>é›†åˆä¸­ä¿®æ”¹<code>name</code>ä¸º<code>lonjin</code>ï¼Œè®¾ç½®ä»–çš„<code>age</code>ä¸º16çš„æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.updateOne({name: 'lonjin'}, {$set:{age: 16}})
</code></pre>
<p>åœ¨<code>user</code>é›†åˆä¸­ä¿®æ”¹<code>age</code>å¤§äº14çš„æ•°æ®ï¼Œå°†<code>name</code>æ”¹ä¸º<code>tom</code>ï¼š</p>
<pre><code class="language-bash">db.user.updateMany({age: {$gt: 14}}, {$set:{name: 'tom'}})
</code></pre>
<h4 id="åˆ é™¤">åˆ é™¤</h4>
<p>åœ¨<code>user</code>é›†åˆä¸­åˆ é™¤<code>age</code>ä¸º<code>16</code>çš„æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.deleteOne({age: 16})

</code></pre>
<p>åœ¨<code>user</code>é›†åˆä¸­åˆ é™¤<code>age</code>å¤§äº32çš„æ•°æ®ï¼š</p>
<pre><code class="language-bash">db.user.deleteMany({age: {$gt: 32}})
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€nodeå­¦ä¹ -04ã€‘åˆ›å»ºExpressé¡¹ç›®]]></title>
        <id>https://lonjinup.github.io/node-04/</id>
        <link href="https://lonjinup.github.io/node-04/">
        </link>
        <updated>2023-11-19T15:35:48.000Z</updated>
        <content type="html"><![CDATA[<h1 id="åˆ›å»ºexpressé¡¹ç›®">åˆ›å»ºExpressé¡¹ç›®</h1>
<blockquote>
<p>Express æ˜¯ä¸€ä¸ªè½»é‡çº§ã€é«˜åº¦å¯å®šåˆ¶çš„ Web åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œå®ƒç®€åŒ–äº†åœ¨ Node.js ç¯å¢ƒä¸­æ„å»ºå¼ºå¤§çš„ Web åº”ç”¨ç¨‹åºçš„è¿‡ç¨‹ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—çš„åŠŸèƒ½å’Œå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿåœ°æ„å»ºé«˜æ€§èƒ½çš„ Web åº”ç”¨ã€‚Express çš„çµæ´»æ€§ä½¿å¾—å®ƒæˆä¸ºäº†è®¸å¤šå¼€å‘è€…é¦–é€‰çš„æ¡†æ¶ä¹‹ä¸€ï¼ŒåŒæ—¶ä¹Ÿè¢«å¹¿æ³›ç”¨äºæ„å»ºå„ç±»è§„æ¨¡çš„é¡¹ç›®ã€‚æ— è®ºæ˜¯å¿«é€Ÿæ­å»ºä¸€ä¸ªç®€å•çš„ API æœåŠ¡å™¨ï¼Œè¿˜æ˜¯å¼€å‘ä¸€ä¸ªå¤æ‚çš„ç½‘ç«™ï¼ŒExpress éƒ½èƒ½æä¾›æ‰€éœ€çš„åŸºç¡€è®¾æ–½å’ŒåŠŸèƒ½æ”¯æŒã€‚</p>
</blockquote>
<h2 id="expressç‰¹æ€§">Expressç‰¹æ€§</h2>
<p>Express æ˜¯ä¸€ä¸ªç®€æ´ã€çµæ´»çš„ Node.js Web åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p>
<ol>
<li>
<p><strong>ä¸Šæ‰‹ç®€å•ï¼Œå­¦ä¹ é—¨æ§›ä½</strong>ï¼šExpress æä¾›äº†ç›´è§‚ä¸”ç®€æ´çš„ APIï¼Œä½¿å¾—åˆå­¦è€…å¯ä»¥å¿«é€Ÿä¸Šæ‰‹ï¼Œå¹¶ä¸”å¯ä»¥éšç€ç»éªŒçš„ç§¯ç´¯è¿›è¡Œæ·±å…¥å­¦ä¹ å’Œå®šåˆ¶ã€‚</p>
</li>
<li>
<p><strong>ä¸°å¯Œçš„APIåŸºç¡€æ”¯æŒ</strong>ï¼šExpress æä¾›äº†è®¸å¤šæ„å»º Web åº”ç”¨æ‰€éœ€çš„åŸºç¡€åŠŸèƒ½ï¼ŒåŒ…æ‹¬è·¯ç”±ã€è¯·æ±‚å’Œå“åº”å¤„ç†ã€ä¸­é—´ä»¶ç­‰ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥æ–¹ä¾¿åœ°æ„å»ºå‡ºå„ç§ç±»å‹çš„åº”ç”¨ã€‚</p>
</li>
<li>
<p><strong>å¼ºå¤§çš„è·¯ç”±åŠŸèƒ½</strong>ï¼šExpress æä¾›äº†çµæ´»çš„è·¯ç”±åŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®ä¸åŒçš„ URL è·¯å¾„åˆ†å‘åˆ°ä¸åŒçš„å¤„ç†ç¨‹åºï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥è½»æ¾åœ°ç®¡ç†å„ç±»è¯·æ±‚å’Œå“åº”ã€‚</p>
</li>
<li>
<p><strong>çµæ´»çš„ä¸­é—´ä»¶æ”¯æŒ</strong>ï¼šExpress ä¸­é—´ä»¶æä¾›äº†ä¸€ç§æœ‰æ•ˆçš„æ–¹å¼æ¥å¤„ç† HTTP è¯·æ±‚ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡ä¸­é—´ä»¶æ¥æ‰©å±• Express çš„åŠŸèƒ½ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€æ—¥å¿—è®°å½•ç­‰ï¼Œä½¿å¾—åº”ç”¨å…·æœ‰æ›´å¼ºçš„å¯å®šåˆ¶æ€§ã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½æ¥è¿‘åŸç”ŸNode</strong>ï¼šç”±äº Express æ˜¯åŸºäº Node.js æ„å»ºçš„ï¼Œå®ƒåœ¨å¤„ç†è¯·æ±‚å’Œå“åº”æ—¶éå¸¸é«˜æ•ˆï¼Œæ€§èƒ½æ¥è¿‘åŸç”Ÿçš„ Node.jsã€‚</p>
</li>
</ol>
<h2 id="expresså¯ä»¥åšä»€ä¹ˆ">Expresså¯ä»¥åšä»€ä¹ˆ</h2>
<p>Express æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ¡†æ¶ï¼Œå¯ä»¥ç”¨äºæ„å»ºå¤šç§ç±»å‹çš„åº”ç”¨ï¼š</p>
<ol>
<li>
<p><strong>ç½‘ç«™</strong>ï¼šExpress å¯ä»¥ç”¨äºæ„å»ºå„ç§ç±»å‹çš„ç½‘ç«™ï¼Œä»ç®€å•çš„ä¸ªäººåšå®¢åˆ°å¤æ‚çš„ä¼ä¸šç½‘ç«™ï¼Œéƒ½å¯ä»¥é€šè¿‡ Express è½»æ¾å®ç°ã€‚</p>
</li>
<li>
<p><strong>APIæ¥å£æœåŠ¡å™¨</strong>ï¼šè®¸å¤šç°ä»£åº”ç”¨ç¨‹åºä¾èµ–äºåç«¯æä¾› API æ¥å£ï¼ŒExpress å¯ä»¥ä½œä¸ºä¸€ä¸ªé«˜æ•ˆçš„ API æœåŠ¡å™¨ï¼Œæä¾›æ•°æ®çš„è·å–ã€å¤„ç†å’Œå“åº”åŠŸèƒ½ã€‚</p>
</li>
<li>
<p><strong>æœåŠ¡ç«¯æ¸²æŸ“ä¸­é—´å±‚</strong>ï¼šExpress å¯ä»¥ä½œä¸ºæœåŠ¡ç«¯æ¸²æŸ“åº”ç”¨çš„ä¸­é—´å±‚ï¼Œå¤„ç†å‰ç«¯é¡µé¢è¯·æ±‚å¹¶åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œæ¸²æŸ“ï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦å’Œ SEO ä¼˜åŒ–ã€‚</p>
</li>
<li>
<p><strong>å¼€å‘ä¸€äº›è¾…åŠ©å·¥å…·</strong>ï¼šExpress å¯ä»¥ç”¨äºå¼€å‘ä¸€äº›è¾…åŠ©å·¥å…·ï¼Œä¾‹å¦‚å¿«é€Ÿæ­å»ºé™æ€æ–‡ä»¶æœåŠ¡å™¨ã€ä»£ç†æœåŠ¡å™¨ç­‰ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚</p>
</li>
<li>
<p><strong>è‡ªå®šä¹‰é›†æˆæ¡†æ¶</strong>ï¼šExpress æä¾›äº†è¶³å¤Ÿçš„çµæ´»æ€§ï¼Œå¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚è¿›è¡Œå®šåˆ¶ï¼Œç”šè‡³ç»“åˆå…¶ä»–æ¨¡å—ï¼Œæ„å»ºå‡ºç¬¦åˆç‰¹å®šè¦æ±‚çš„å®šåˆ¶æ¡†æ¶ã€‚</p>
</li>
</ol>
<h2 id="expressé¡¹ç›®æ„å»º">Expressé¡¹ç›®æ„å»º</h2>
<h3 id="å®‰è£…express">å®‰è£…Express</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º <code>express</code> çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨ç»ˆç«¯ä¸­è¿›å…¥è¯¥æ–‡ä»¶å¤¹ã€‚æ¥ç€ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ Node.js é¡¹ç›®ï¼š</p>
<pre><code class="language-shell">npm init -y
</code></pre>
<p>ç„¶åï¼Œæˆ‘ä»¬å®‰è£… Expressï¼š</p>
<pre><code class="language-shell">npm i express
</code></pre>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸåœ°å®‰è£…äº† Expressã€‚æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡åº”ç”¨ç”Ÿæˆå™¨å·¥å…· <a href="https://www.expressjs.com.cn/starter/generator.html">express-generator</a> å¿«é€Ÿåˆ›å»ºä¸€ä¸ªåº”ç”¨çš„éª¨æ¶ï¼Œè¿™é‡Œå…ˆä¸å±•å¼€å™è¿°äº†ã€‚</p>
<h3 id="åˆ›å»ºè¯·æ±‚">åˆ›å»ºè¯·æ±‚</h3>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸º <code>app.js</code> çš„æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­å¼•å…¥ Expressã€‚éšåï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªç®€å•çš„ GET è¯·æ±‚å¤„ç†ï¼š</p>
<p>æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>/db.json</code>æ–‡ä»¶ï¼š</p>
<pre><code class="language-json">{
    &quot;user&quot;: [
        {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;zhangsan&quot;,
            &quot;age&quot;: 18,
            &quot;sex&quot;: &quot;ç”·&quot;
        }
    ]
}
</code></pre>
<p>ç„¶ååœ¨<code>/app.js</code>ä¸­æ·»åŠ ä¸€ä¸ª<code>/user</code>çš„getè¯·æ±‚æ¥å£ï¼Œè¯¥æ¥å£è¿”å›åˆšæ‰<code>db.json</code>ä¸­çš„å†…å®¹ï¼š</p>
<pre><code class="language-js">const express = require('express')
const app = express()
const fs = require('fs')

app.get('/user', (req, res) =&gt; {
    fs.readFile('./db.json', 'utf8', (err, data) =&gt; {
        if (err) {
            res.status(500).json(err)
        } else {
            res.send(JSON.parse(data))
        }
    })
})

app.listen(3001, () =&gt; {
    console.log('http://127.0.0.1:3001')
})

</code></pre>
<p>æœ€åï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿è¡Œé¡¹ç›®(ä¹‹å‰å…¨å±€å®‰è£…è¿‡<code>nodemon</code>)ï¼š</p>
<pre><code class="language-shell">nodemon app.js
</code></pre>
<p>è®¿é—®<code>http://127.0.0.1:3001/user</code>å³å¯è·å¾—åˆ°æˆ‘ä»¬çš„å“åº”æ•°æ®ã€‚</p>
<p>ä½†æ˜¯ä¸Šé¢çš„å†™æ³•ä¸€ç›´æ˜¯ä¸å¤Ÿä¼˜é›…ï¼Œå†™äº†å¾ˆå¤šå›è°ƒå‡½æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥<code>promise</code>åŒ–ä¸€ä¸‹ï¼š</p>
<pre><code class="language-js">const express = require('express')
const app = express()
const fs = require('fs')
//å¼•å…¥promisify
const { promisify } = require('util') 
const readFile = promisify(fs.readFile)

app.get('/user', async (req, res) =&gt; {
    try {
        let back = await readFile('./db.json', 'utf8')
        res.send(JSON.parse(back))
    } catch (error) {
        res.status(500).json({ error })
    }
})

app.listen(3001, () =&gt; {
    console.log('http://127.0.0.1:3001')
})
</code></pre>
<p>ä¸Šé¢æˆ‘ä»¬å·²ç»å»ºç«‹äº†ä¸€ä¸ªgetè¯·æ±‚ï¼Œä¸‹é¢æˆ‘ä»¬è¯•ç€åˆ›å»ºä¸€ä¸ªpostè¯·æ±‚ï¼Œå¹¶æ¥å—ä¸€äº›å‚æ•°ï¼š</p>
<pre><code class="language-js">const express = require('express')
const app = express()
const fs = require('fs')
const { promisify } = require('util')
const readFile = promisify(fs.readFile)

// è§£æpostè¯·æ±‚
app.use(express.urlencoded({ extended: true }))
app.use(express.json())

//å¤„ç†è¯·æ±‚
app.post('/add', async (req, res) =&gt; {
    console.log(req.headers) //å½“å‰è¯·æ±‚å¤´ä¿¡æ¯
    console.log(req.body) //å½“å‰è¯·æ±‚ä½“ä¿¡æ¯
    res.send('post success')
})

app.listen(3001, () =&gt; {
    console.log('http://127.0.0.1:3001')
})

</code></pre>
<p>åˆ›å»ºæˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>postman</code>æ¥æµ‹è¯•æˆ‘ä»¬çš„æ¥å£ï¼š</p>
<ul>
<li>
<p>å‚æ•°æ ¼å¼ä¸º<code>'content-type': 'application/x-www-form-urlencoded'</code><br>
<a href="https://imgse.com/i/piUzevq"><img src="https://z1.ax1x.com/2023/11/20/piUzevq.png" alt="piUzevq.png" loading="lazy"></a></p>
</li>
<li>
<p>å‚æ•°æ ¼å¼ä¸º<code>'content-type': 'application/json'</code><br>
<a href="https://imgse.com/i/piUzZ2n"><img src="https://z1.ax1x.com/2023/11/20/piUzZ2n.png" alt="piUzZ2n.png" loading="lazy"></a></p>
</li>
</ul>
<blockquote>
<p>ä»‹ç»ä¸€ä¸‹å¸¸è§ä¼ å‚æ ¼å¼</p>
</blockquote>
<p>åˆšæ‰æˆ‘ä»¬åªæ˜¯å†™äº†ä¸€ä¸ªç®€å•çš„<code>post</code>è¯·æ±‚å¹¶è¯»å–äº†è¯·æ±‚ä¸­æºå¸¦çš„å‚æ•°ï¼Œä¸‹é¢æˆ‘ä»¬æŠŠæ‹¿åˆ°çš„å‚æ•°å†™å…¥åˆ°<code>db.json</code>ä¸­ï¼š</p>
<pre><code class="language-js">const express = require('express')
const app = express()
const fs = require('fs')
const { promisify } = require('util')
const readFile = promisify(fs.readFile)
// 1.promisify å†™å…¥æ–‡ä»¶
const writeFile = promisify(fs.writeFile)

app.use(express.urlencoded({ extended: true }))
app.use(express.json())

app.post('/add', async (req, res) =&gt; {
    // åˆ¤è¯»bodyæ˜¯å¦ä¸ºç©º
    let body = req.body
    if (Object.keys(body).length !== 0) {
        try {
            // è¯»å–æ–‡ä»¶
            let db = await readFile('./db.json', 'utf8')
            let data = JSON.parse(db)
            // æ·»åŠ id
            body.id = data.user[data.user.length - 1].id + 1
            data.user.push(body)

            // å†™å…¥æ–‡ä»¶
            let result = await writeFile('./db.json', JSON.stringify(data), 'utf8')
            if (!result) {
                res.status(200).json({ message: 'å†™å…¥æˆåŠŸ' })
            } else {
                res.status(500).json({ error: 'å†™å…¥å¤±è´¥' })
            }

        } catch (error) {
            res.status(500).json({ error })
        }
    } else {
        res.status(400).json({ error: 'ç¼ºå°‘ä¿¡æ¯' })
    }
})

app.listen(3001, () =&gt; {
    console.log('http://127.0.0.1:3001')
})

</code></pre>
<p>è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†æ·»åŠ ç”¨æˆ·çš„æ¥å£é€»è¾‘ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç®€åŒ–æœ¬åœ°Vueé¡¹ç›®ç™»å½•æµç¨‹ï¼šç”¨Nodeè„šæœ¬ä¸€é”®è·å–Token]]></title>
        <id>https://lonjinup.github.io/node-login/</id>
        <link href="https://lonjinup.github.io/node-login/">
        </link>
        <updated>2023-11-16T02:51:10.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>æœ€è¿‘å…¬å¸æœ‰ä¸ªé¡¹ç›®æ˜¯åŸºäº<code>vue</code>å¼€å‘çš„ï¼Œä½†éƒ¨åˆ†è€é¡µé¢æ˜¯å‰åç«¯ä¸åˆ†ç¦»çš„ï¼›æ¯”å¦‚ç™»å½•é¡µé¢ã€‚ç”±äºåç«¯ä¹Ÿæ²¡æœ‰ç›¸å…³ç™»å½•æ¥å£ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æœ¬åœ°å¯åŠ¨æœåŠ¡åï¼Œéœ€è¦åˆ°æµ‹è¯•ç¯å¢ƒç™»é™†ï¼›ç„¶åæ‰‹åŠ¨å¤åˆ¶å‡ ä¸ª<code>cookie</code>ç²˜è´´åˆ°æœ¬åœ°å¯åŠ¨çš„é¡µé¢ä¸­ï¼Œæ•´ä¸ªè¿‡ç¨‹æ¯”è¾ƒç¹ï¼›æ‰€ä»¥ç”¨<code>node</code>å†™ä¸ªè„šæœ¬å»ç®€åŒ–ä¸€ä¸‹æµç¨‹ã€‚</p>
</blockquote>
<h2 id="ä¼˜åŒ–å‰">ä¼˜åŒ–å‰</h2>
<ul>
<li>æœ¬åœ°<code>npm run serve</code>å¯åŠ¨æœåŠ¡</li>
<li>ç™»å½•æµ‹è¯•ç¯å¢ƒ<code>https://test.xxxx.com/login</code></li>
<li>æ‰“å¼€è°ƒè¯•ï¼Œæ‰¾åˆ°ç›¸å…³cookieï¼Œå¤åˆ¶</li>
<li>æ‰“å¼€æœ¬åœ°å¯åŠ¨çš„é¡µé¢å¹¶æ‰“å¼€è°ƒè¯•ï¼›ç²˜è´´å¤åˆ¶çš„cookieï¼Œåˆ·æ–°é¡µé¢</li>
</ul>
<p>å½“ç„¶ï¼Œä»¥ä¸‹æ˜¯ä½ æ•´ä¸ªè„šæœ¬çš„é€æ­¥è§£é‡Šï¼š</p>
<h2 id="ä¼˜åŒ–è¿‡ç¨‹">ä¼˜åŒ–è¿‡ç¨‹</h2>
<h3 id="å®‰è£…puppeteerå’Œreadline">å®‰è£…Puppeteerå’Œreadline</h3>
<blockquote>
<p><strong>Puppeteer:</strong><br>
<a href="https://pptr.dev/">Puppeteer</a> æ˜¯ä¸€ä¸ªç”± Google å¼€å‘çš„ Node.js åº“ï¼Œç”¨äºæ§åˆ¶ headless æµè§ˆå™¨ï¼ˆæ— å›¾å½¢ç”¨æˆ·ç•Œé¢çš„æµè§ˆå™¨ï¼‰ã€‚å®ƒæä¾›äº†ä¸€å¥—é«˜çº§çš„ APIï¼Œå…è®¸å¼€å‘è€…é€šè¿‡ç¨‹åºæ–¹å¼æ“æ§æµè§ˆå™¨çš„è¡Œä¸ºï¼ŒåŒ…æ‹¬å¯¼èˆªã€è¡¨å•æäº¤ã€æˆªå›¾ã€ç”Ÿæˆ PDF ç­‰åŠŸèƒ½ã€‚Puppeteeré€šå¸¸ç”¨äºæ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€å±å¹•æˆªå›¾ã€æœç´¢å¼•æ“çˆ¬è™«ç­‰ä»»åŠ¡ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ Puppeteer æ¨¡æ‹Ÿç”¨æˆ·ç™»å½•è¿‡ç¨‹ï¼Œè·å–ç™»å½•åçš„ Cookiesã€‚<br>
<strong>readline:</strong><br>
<a href="https://nodejs.org/api/readline.html">readline</a> æ˜¯ Node.js å†…ç½®çš„æ¨¡å—ä¹‹ä¸€ï¼Œæä¾›äº†ä¸€ä¸ªæ¥å£æ¥ä»å¯è¯»æµï¼ˆå¦‚ <code>process.stdin</code>ï¼‰è¯»å–æ•°æ®ã€‚å®ƒé€šå¸¸ç”¨äºä»ç»ˆç«¯æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ä»¥äº¤äº’çš„æ–¹å¼ä¸ç”¨æˆ·è¿›è¡Œé€šä¿¡ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ readline åˆ›å»ºäº†ä¸€ä¸ªæ¥å£ï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿåœ¨ç»ˆç«¯ä¸­è¾“å…¥è´¦å·å’Œå¯†ç ã€‚</p>
</blockquote>
<p>è¿™ä¸¤ä¸ªæ¨¡å—çš„ç»“åˆä½¿ç”¨ä½¿å¾—æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>Puppeteer</code> æ§åˆ¶æµè§ˆå™¨å®Œæˆç™»å½•ï¼Œè€Œ <code>readline</code> åˆ™ä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿåœ¨ç»ˆç«¯ä¸­ç›´æ¥è¾“å…¥è´¦å·å’Œå¯†ç ã€‚</p>
<p>å®‰è£…å¹¶å¼•å…¥æ¨¡å—</p>
<pre><code class="language-shell">npm i puppeteer@20.0.0
npm i readline
</code></pre>
<p>å¼•å…¥ <code>puppeteer</code>ã€<code>readline</code> å’Œ <code>fs</code>ï¼š</p>
<pre><code class="language-javascript">const puppeteer = require('puppeteer')
const readline = require('readline')
const fs = require('fs')
</code></pre>
<h3 id="å®šä¹‰ç™»å½•å‡½æ•°">å®šä¹‰ç™»å½•å‡½æ•°</h3>
<p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåä¸º <code>login</code> çš„å¼‚æ­¥å‡½æ•°ï¼Œç”¨äºæ¨¡æ‹Ÿç”¨æˆ·ç™»å½•å’Œè·å– cookiesã€‚</p>
<pre><code class="language-javascript">/**
 * ç™»å½•
 * @param {string} url ç™»å½•é¡µé¢url
 * @param {string} usernameSelector ç™»å½•é¡µé¢ç”¨æˆ·åè¾“å…¥æ¡†çš„ID
 * @param {string} passwordSelector ç™»å½•é¡µé¢å¯†ç è¾“å…¥æ¡†çš„ID
 * @param {string} username  è´¦å·
 * @param {string} password å¯†ç 
 */
async function login(url, usernameSelector, passwordSelector, username, password) {
    // ...
}
</code></pre>
<h3 id="å¯åŠ¨æµè§ˆå™¨">å¯åŠ¨æµè§ˆå™¨</h3>
<p>åœ¨ <code>login</code> å‡½æ•°ä¸­ï¼Œä½¿ç”¨ <code>puppeteer.launch()</code> å¯åŠ¨ä¸€ä¸ª headless æµè§ˆå™¨å®ä¾‹ï¼Œç„¶åé€šè¿‡<code>page.goto</code>æ‰“å¼€æˆ‘ä»¬ä¼ å…¥çš„urlã€‚</p>
<pre><code class="language-javascript">const browser = await puppeteer.launch({ headless: true })
const page = await browser.newPage()
await page.goto(url, { waitUntil: 'load' })
</code></pre>
<h3 id="è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ">è¾“å…¥ç”¨æˆ·åå’Œå¯†ç </h3>
<p>ä½¿ç”¨ <code>page.type()</code> æ¨¡æ‹Ÿè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¾“å…¥æ¡†çš„é€‰æ‹©å™¨ã€‚ç™»å½•å®Œæˆåï¼Œæˆ‘ä»¬å†é€šè¿‡<code>page.click</code>å»ç‚¹å‡»ç™»å½•æŒ‰é’®ã€‚</p>
<pre><code class="language-javascript">await page.type(usernameSelector, username)
await page.type(passwordSelector, password)

await page.click('#_btnLogin')
await page.waitForNavigation({ waitUntil: 'load' })

</code></pre>
<h3 id="è·å–-cookies">è·å– Cookies</h3>
<p>ä½¿ç”¨ <code>page.cookies()</code> è·å–é¡µé¢çš„ cookiesï¼Œå¹¶å°†æˆ‘ä»¬éœ€è¦çš„<code>token</code>æå–å‡ºæ¥ã€‚æˆ‘ä»¬è¿™é‡Œå°±éšä¾¿ä»¥<code>APITOKEN</code> å’Œ <code>bpmftoken</code> ä¸ºä¾‹å­ï¼›<br>
æå–åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>browser.close()</code>å…³é—­æµè§ˆå™¨ã€‚</p>
<pre><code class="language-javascript">const cookies = await page.cookies()
const tokens = {}
for (const cookie of cookies) {
    cookie.name === 'APITOKEN' &amp;&amp; (tokens.APITOKEN = cookie.value)
    cookie.name === 'bpmftoken' &amp;&amp; (tokens.bpmftoken = cookie.value)
}

browser.close()
</code></pre>
<h3 id="å†™å…¥tokensåˆ°æ–‡ä»¶">å†™å…¥Tokensåˆ°æ–‡ä»¶</h3>
<p>å°†è·å–åˆ°çš„<code>tokens</code>å†™å…¥<code>JSON</code>æ–‡ä»¶å¹¶å…³é—­ç»ˆç«¯ã€‚</p>
<pre><code class="language-javascript">const tokenJSON = JSON.stringify(tokens, null, 2)
const filePath = './src/config/tokens.json'

fs.writeFile(filePath, tokenJSON, (err) =&gt; {
    if (err) throw err
    console.log('tokenå·²å†™å…¥ï¼Œè¯·æ‰§è¡Œ npm run serve')
    process.exit(1)
});
</code></pre>
<h3 id="è®¿é—®ç»ˆç«¯è¾“å…¥æ•°æ®">è®¿é—®ç»ˆç«¯è¾“å…¥æ•°æ®</h3>
<p>ä½¿ç”¨ <code>readline</code> æ¨¡å—åˆ›å»ºä¸€ä¸ªæ¥å£ï¼Œè·å–ç”¨æˆ·è¾“å…¥çš„è´¦å·å’Œå¯†ç ã€‚</p>
<pre><code class="language-javascript">const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

let username = null;
let password = null;

const url = 'https://xxxx..com/login'; //ç™»å½•é¡µé¢
const usernameSelector = '#_txtUid'; //ç”¨æˆ·åè¾“å…¥æ¡†ID
const passwordSelector = '#_txtPwd'; //å¯†ç è¾“å…¥æ¡†ID

rl.question('è¯·è¾“å…¥è´¦å·:', (answer) =&gt; {
    username = answer
    rl.question('è¯·è¾“å…¥å¯†ç :', (answer) =&gt; {
        password = answer
        rl.close()
        login(url, usernameSelector, passwordSelector, username, password)
    });
});
</code></pre>
<p>ç»ˆç«¯æ‰§è¡Œä¸‹é¢å‘½ä»¤å³å¯å®ç°è·å–tokenã€‚</p>
<pre><code class="language-shell">node login.js
</code></pre>
<p>ç„¶ååœ¨é¡¹ç›®ä¸­é€šè¿‡è¯»å–<code>/src/config/tokens.json</code>ä¸­çš„å†…å®¹å»æ‰‹åŠ¨å†™å…¥<code>token</code>å³å¯ã€‚</p>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-javascript">const puppeteer = require('puppeteer')
const readline = require('readline')
const fs = require('fs')

async function login(url, usernameSelector, passwordSelector, username, password) {
    const browser = await puppeteer.launch({ headless: true })
    const page = await browser.newPage()
    try {
        await page.goto(url, { waitUntil: 'load' })
        try {
            await page.type(usernameSelector, username)
            await page.type(passwordSelector, password)
        } catch (error) {
            console.log(error)
        }

        await page.click('#_btnLogin')
        await page.waitForNavigation({ waitUntil: 'load' })
        console.log('ç™»å½•æˆåŠŸ')
        await page.waitForTimeout(500)

        const cookies = await page.cookies()
        const tokens = {}
        for (const cookie of cookies) {
            cookie.name === 'APITOKEN' &amp;&amp; (tokens.APITOKEN = cookie.value)
            cookie.name === 'bpmftoken' &amp;&amp; (tokens.bpmftoken = cookie.value)
        }

        await browser.close()

        const tokenJSON = JSON.stringify(tokens, null, 2)
        const filePath = './src/config/tokens.json'
        fs.writeFile(filePath, tokenJSON, (err) =&gt; {
            if (err) throw err;
            console.log('tokenå·²å†™å…¥, è¯·æ‰§è¡Œnpm run serve')
            process.exit(1)
        });

    } catch (error) {
        console.error('Error:', error)
        await browser.close()
        process.exit(1)
    }
}


let username = null;
let password = null;
const url = 'https://xxxx..com/login'; //ç™»å½•é¡µé¢
const usernameSelector = '#_txtUid'; //ç”¨æˆ·åè¾“å…¥æ¡†ID
const passwordSelector = '#_txtPwd'; //å¯†ç è¾“å…¥æ¡†ID

const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

rl.question('è¯·è¾“å…¥è´¦å·(é»˜è®¤GP00164ï¼Œç›´æ¥å›è½¦): ', (answer) =&gt; {
    username = answer || 'GP00164';
    rl.question('è¯·è¾“å…¥å¯†ç : (é»˜è®¤GP00164ï¼Œç›´æ¥å›è½¦)', (answer) =&gt; {
        password = answer || 'Xxzx2023@123'
        rl.close()
        login(url, usernameSelector, passwordSelector, username, password)
    })
})
</code></pre>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<blockquote>
<p>è¿™æ ·æˆ‘ä»¬åœ¨æœ¬åœ°å¼€å‘è¿‡ç¨‹ä¸­å°±ä¸éœ€è¦æ‰‹åŠ¨å¤åˆ¶<code>token</code>ï¼Œç›´æ¥è¿è¡Œ<code>node login.js</code>å³å¯ã€‚<br>
å½“ç„¶<code>Puppeteer</code>å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚è‡ªåŠ¨åŒ–æµ‹è¯•ã€å±å¹•æˆªå›¾å’Œç”Ÿæˆ PDFã€çˆ¬è™«ã€æ€§èƒ½æµ‹è¯•ã€è¡¨å•è‡ªåŠ¨å¡«å†™ç­‰ç­‰ï¼Œæ›´å¤šAPIå¯ä»¥æŸ¥çœ‹<a href="https://pptr.dev/">å®˜ç½‘</a>å­¦ä¹ ã€‚</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€nodeå­¦ä¹ -03ã€‘æ ¸å¿ƒæ¨¡å—http]]></title>
        <id>https://lonjinup.github.io/node-http/</id>
        <link href="https://lonjinup.github.io/node-http/">
        </link>
        <updated>2023-11-05T07:36:29.000Z</updated>
        <content type="html"><![CDATA[<h1 id="nodejs-æ ¸å¿ƒæ¨¡å—http">Node.js æ ¸å¿ƒæ¨¡å—http</h1>
<blockquote>
<p>ä¸‹é¢æˆ‘ä»¬å°†å­¦ä¹  Node.js çš„ <code>http</code> æ¨¡å—ï¼Œé€šè¿‡å®ƒæ¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
</blockquote>
<ol>
<li>åˆ›å»ºä¸€ä¸ª HTTP æœåŠ¡å™¨</li>
<li>æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚å¹¶è¿›è¡Œå¤„ç†</li>
<li>å“åº”å¹¶è¿”å›å¤„ç†ç»“æœ</li>
</ol>
<h2 id="getè¯·æ±‚">getè¯·æ±‚</h2>
<p>æ–°å»º <code>server.js</code> æ–‡ä»¶ï¼š</p>
<pre><code class="language-js">// 1.å¯¼å…¥æ¨¡å—
const http = require('http')

// 2.åˆ›å»ºæœåŠ¡å™¨ è·å–æœåŠ¡å™¨çš„å®ä¾‹å¯¹è±¡
let server = http.createServer()
server.listen(3000, () =&gt; {
    console.log('http://127.0.0.1:3000')
})

// 3.æ¥æ”¶å“åº”
server.on('request', (req, res) =&gt; {
    // 4.å¤„ç†å“åº”
    res.write('888')
    //5.æ–­å¼€è¿æ¥
    res.end()
})
</code></pre>
<p>ç„¶ååœ¨ç»ˆç«¯è¿è¡Œï¼š</p>
<pre><code class="language-shell">node server.js
</code></pre>
<p>æ§åˆ¶å°å°†è¾“å‡º <code>http://127.0.0.1:3000</code>ã€‚</p>
<p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼Œä¼šå¾—åˆ°æˆ‘ä»¬å†™å…¥çš„ <code>888</code>ã€‚</p>
<blockquote>
<p>åœ¨ Node.js å¼€å‘ä¸­ï¼Œæ¯æ¬¡ä¿®æ”¹ä»£ç åéƒ½éœ€è¦é‡å¯æœåŠ¡æ‰èƒ½çœ‹åˆ°æ–°çš„è¾“å‡ºã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>nodemon</code> å·¥å…·ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨æ£€æµ‹æ–‡ä»¶çš„å˜åŒ–å¹¶æ›´æ–°æœåŠ¡ã€‚å®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š</p>
</blockquote>
<pre><code class="language-shell">sudo npm i -g nodemon
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œé€šè¿‡ä¸‹é¢å‘½ä»¤å¯åŠ¨é¡¹ç›®ï¼š</p>
<pre><code class="language-shell">nodemon server.js
</code></pre>
<p>å½“æˆ‘ä»¬å°è¯•è¾“å‡ºä¸­æ–‡æ—¶ï¼Œå¯èƒ½ä¼šå‘ç°æµè§ˆå™¨å†…æ˜¾ç¤ºçš„æ˜¯ä¹±ç ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å‘Šè¯‰æµè§ˆå™¨å¦‚ä½•è§£æè¿™æ®µæ–‡æœ¬ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸‹å“åº”å¤´ï¼š</p>
<pre><code class="language-js">server.on('request', (req, res) =&gt; {
    res.setHeader('Content-Type', 'text/plain;charset=UTF-8'); // è®¾ç½®å“åº”å¤´
    res.write('ä½ å¥½')
    res.end()
})
</code></pre>
<p>é€šè¿‡ä¿®æ”¹å“åº”å¤´ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¾“å‡ºå¯¹åº”çš„å†…å®¹ã€‚</p>
<h3 id="å¸¸è§è¯·æ±‚æ–¹å¼">å¸¸è§è¯·æ±‚æ–¹å¼</h3>
<p>ä»¥ä¸‹æ˜¯ Node.js ä¸­å¸¸è§çš„è¯·æ±‚æ–¹æ³•åŠå…¶è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>ç”¨äºå‘æŒ‡å®šçš„èµ„æºè¯·æ±‚æ•°æ®ã€‚</td>
</tr>
<tr>
<td>POST</td>
<td>ç”¨äºå‘æŒ‡å®šçš„èµ„æºæäº¤è¦è¢«å¤„ç†çš„æ•°æ®ã€‚</td>
</tr>
<tr>
<td>PUT</td>
<td>ç”¨äºå‘æŒ‡å®šçš„èµ„æºä½ç½®ä¸Šä¼ å…¶æœ€æ–°å†…å®¹ã€‚</td>
</tr>
<tr>
<td>DELETE</td>
<td>åˆ é™¤æŒ‡å®šçš„èµ„æºã€‚</td>
</tr>
<tr>
<td>HEAD</td>
<td>ç±»ä¼¼äº GET è¯·æ±‚ï¼Œä½†åªè¿”å› HTTP æŠ¥å¤´ï¼Œä¸è¿”å›å®ä½“ä¸»ä½“ã€‚</td>
</tr>
<tr>
<td>OPTIONS</td>
<td>ç”¨äºè·å–ç›®æ ‡èµ„æºæ‰€æ”¯æŒçš„é€šä¿¡é€‰é¡¹ã€‚</td>
</tr>
<tr>
<td>PATCH</td>
<td>å¯¹èµ„æºè¿›è¡Œéƒ¨åˆ†ä¿®æ”¹ã€‚</td>
</tr>
</tbody>
</table>
<p>è¿™äº›æ–¹æ³•åœ¨ HTTP åè®®ä¸­å®šä¹‰ï¼ŒNode.js æä¾›äº†å¯¹è¿™äº›æ–¹æ³•çš„æ”¯æŒï¼Œå¯ä»¥é€šè¿‡æ„å»º HTTP è¯·æ±‚æ¥ä½¿ç”¨å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ <code>http</code> æˆ– <code>https</code> æ¨¡å—åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œç„¶åæ ¹æ®æ¥æ”¶åˆ°çš„è¯·æ±‚çš„æ–¹æ³•æ¥æ‰§è¡Œç›¸åº”çš„å¤„ç†ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å‘èµ·ä¸€ä¸ªå¸¦æœ‰å‚æ•°çš„ <code>GET</code> è¯·æ±‚ï¼š</p>
<p>åœ¨ <code>server.js</code> ä¸­ï¼š</p>
<pre><code class="language-js">const http = require('http')
const url = require('url') // è§£ææºå¸¦çš„å‚æ•°

let server = http.createServer()
server.listen(3000, () =&gt; {
    console.log('http://127.0.0.1:3000')
})

// æ¥æ”¶å“åº”
server.on('request', (req, res) =&gt; {
    if (req.method === 'GET') {
        let { query } = url.parse(req.url, true)
        res.write('GET è¯·æ±‚ï¼Œå‚æ•°ä¸ºï¼š' + query.id)
        res.end()
    }
})
</code></pre>
<p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š</p>
<pre><code class="language-shell">http://127.0.0.1:3000/user?id=123
</code></pre>
<p>å°†ä¼šè¿”å›ï¼š</p>
<pre><code class="language-shell">GET è¯·æ±‚ï¼Œå‚æ•°ä¸ºï¼š123
</code></pre>
<p>è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Node.js å‘èµ·å¸¦å‚æ•°çš„ <code>GET</code> è¯·æ±‚ã€‚</p>
<h2 id="å¤„ç†-post-è¯·æ±‚">å¤„ç† POST è¯·æ±‚</h2>
<p>åœ¨ <code>server.js</code> ä¸­ï¼š</p>
<pre><code class="language-js">const http = require('http')
const url = require('url')

let server = http.createServer()
server.listen(3000, () =&gt; {
    console.log('http:127.0.0.1:3000')
})

server.on('request', (req, res) =&gt; {
    res.setHeader('Content-Type', 'text/plain;charset=UTF-8'); // è®¾ç½®å“åº”å¤´
    if (req.method === 'GET') {
        let { query } = url.parse(req.url, true)
        res.write('getè¯·æ±‚,å‚æ•°ä¸º:' + query.id)
        res.end()
    } else if (req.method === 'POST') {
        let postData = ''
        req.on('data', chunk =&gt; {
            postData += chunk
        })
        req.on('end', () =&gt; {
            res.write('POST è¯·æ±‚, å‚æ•°ä¸º: ' + postData)
            res.end();
        })
    }
})

</code></pre>
<p>åœ¨å¤„ç† POST è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡ç›‘å¬ <code>data</code> äº‹ä»¶å’Œ <code>end</code> äº‹ä»¶æ¥è·å–è¯·æ±‚çš„æ•°æ®ã€‚åœ¨ <code>data</code> äº‹ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªæ•°æ®å—ï¼ˆ<code>chunk</code>ï¼‰ç´¯åŠ åˆ° <code>postData</code> ä¸­ï¼Œæœ€ç»ˆåœ¨ <code>end</code> äº‹ä»¶ä¸­å¤„ç†å®Œæ•´çš„è¯·æ±‚æ•°æ®ã€‚</p>
<h3 id="ä»£ç æ‹†åˆ†">ä»£ç æ‹†åˆ†</h3>
<p>ä»¥ä¸Šç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•å¤„ç†ä¸åŒè¯·æ±‚æ–¹æ³•çš„é€»è¾‘ï¼Œä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šè¿›ä¸€æ­¥å°†ä»£ç æ‹†åˆ†ä»¥ä¿æŒç»“æ„æ¸…æ™°ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª <code>router.js</code> æ–‡ä»¶æ¥å¤„ç†è·¯ç”±ï¼Œä»¥åŠä¸€ä¸ª <code>controller.js</code> æ–‡ä»¶æ¥å¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
<ul>
<li><code>router.js</code>ï¼š</li>
</ul>
<pre><code class="language-js">const fs = require('fs')
const controller = require('./controller')

module.exports = (req, res) =&gt; {
    res.setHeader('Content-Type', 'text/plain;charset=UTF-8'); // è®¾ç½®å“åº”å¤´
    if (req.method === 'GET') {
        if (req.url == '/') {
            controller.index(res)
        }

    } else if (req.method === 'POST') {
        let postData = ''
        req.on('data', chunk =&gt; {
            postData += chunk
        })
        req.on('end', () =&gt; {
            controller.user(require('querystring').parse(postData), res)
        })
    }
} 
</code></pre>
<ul>
<li><code>controller.js</code>ï¼š</li>
</ul>
<pre><code class="language-js">const url = require('url')

module.exports = {
    index(req, res) {
        let { query } = url.parse(req.url, true)
        res.write('getè¯·æ±‚')
        res.end()
    },

    user(data, res) {
        console.log(data)
        res.end()
    }
}
</code></pre>
<p>é€šè¿‡å°†ä¸åŒçš„é€»è¾‘æ¨¡å—æ‹†åˆ†åˆ° <code>controller.js</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ¸…æ™°åœ°ç»„ç»‡ä»£ç ã€‚è¿™æ ·åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œä¹Ÿèƒ½æ›´æ–¹ä¾¿åœ°ç»´æŠ¤å’Œæ‰©å±•åº”ç”¨ç¨‹åºã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[vue3é¡¹ç›®å¦‚ä½•é…ç½®ESLintå’Œprettier]]></title>
        <id>https://lonjinup.github.io/vue3-esilntAndPrettier/</id>
        <link href="https://lonjinup.github.io/vue3-esilntAndPrettier/">
        </link>
        <updated>2023-08-23T03:14:37.000Z</updated>
        <content type="html"><![CDATA[<h1 id="vue3é¡¹ç›®å¦‚ä½•é…ç½®eslintå’Œprettier">vue3é¡¹ç›®å¦‚ä½•é…ç½®ESLintå’Œprettier</h1>
<h2 id="é…ç½®eslint">é…ç½®eslint</h2>
<p>å®‰è£…<code>eslint</code></p>
<pre><code class="language-js">npm add eslint -D
</code></pre>
<p>å®‰è£…å®Œæˆåè¿›è¡Œé¡¹ç›®åˆå§‹åŒ–</p>
<pre><code class="language-js">npm init @eslint/config
</code></pre>
<p>ç„¶åæ ¹æ®æç¤ºé€‰æ‹©å¯¹åº”çš„é€‰é¡¹ï¼Œä½œè€…ä¸ªäººé€‰æ‹©å¦‚ä¸‹ï¼š</p>
<pre><code class="language-shell">? How would you like to use ESLint? ...
To check syntax only 
To check syntax and find problems
&gt; To check syntax, find problems, and enforce code style
</code></pre>
<ul>
<li>
<p>To check syntax only: ä»…æ£€æŸ¥è¯­æ³•<br>
è¿™ä¸ªé€‰é¡¹åªä¼šè®© ESLint æ£€æŸ¥æ‚¨çš„ä»£ç æ˜¯å¦ç¬¦åˆè¯­æ³•è§„åˆ™ï¼Œä¸ä¼šæ‰§è¡Œå…¶ä»–çš„ä»£ç è´¨é‡æ£€æŸ¥æˆ–é£æ ¼å¼ºåˆ¶ã€‚</p>
</li>
<li>
<p>To check syntax and find problems: æ£€æŸ¥è¯­æ³•å¹¶å‘ç°é—®é¢˜<br>
é€‰æ‹©è¿™ä¸ªé€‰é¡¹åï¼ŒESLint å°†æ£€æŸ¥æ‚¨çš„ä»£ç è¯­æ³•ï¼Œå¹¶æŸ¥æ‰¾å¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼Œå¦‚æœªå®šä¹‰çš„å˜é‡ã€æœªä½¿ç”¨çš„å˜é‡ç­‰ã€‚</p>
</li>
<li>
<p>To check syntax, find problems, and enforce code style: æ£€æŸ¥è¯­æ³•ã€å‘ç°é—®é¢˜å¹¶å¼ºåˆ¶ä»£ç é£æ ¼ã€‚è¿™æ˜¯æœ€å…¨é¢çš„é€‰é¡¹ï¼Œé€‰æ‹©åï¼Œ<code>ESLint</code> å°†ä¸ä»…æ£€æŸ¥è¯­æ³•å’Œé—®é¢˜ï¼Œè¿˜ä¼šæ ¹æ®æ‚¨çš„é…ç½®å¼ºåˆ¶æ‰§è¡Œä»£ç é£æ ¼è§„åˆ™ï¼Œç¡®ä¿ä»£ç åœ¨æ•´ä½“é£æ ¼ä¸Šä¿æŒä¸€è‡´ã€‚</p>
</li>
</ul>
<p>é€šå¸¸ï¼Œå¦‚æœå¸Œæœ›åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ <code>ESLint</code> æ¥ä¿è¯ä»£ç çš„é£æ ¼ä¸€è‡´æ€§å’Œè´¨é‡ï¼Œé‚£ä¹ˆç›´æ¥é€‰æ‹©ç¬¬ä¸‰ä¸ªå°±å¥½ã€‚</p>
<p>æ¥ä¸‹æ¥ä¼šè¯¢é—®æ‚¨çš„é¡¹ç›®ä½¿ç”¨ä»€ä¹ˆç±»å‹çš„æ¨¡å—ï¼ˆModuleï¼‰ç³»ç»Ÿï¼š</p>
<pre><code class="language-shell">? What type of modules does your project use? ...
&gt; JavaScript modules (import/export)
CommonJS (require/exports)
None of these
</code></pre>
<ul>
<li>
<p>JavaScript modules (import/export): JavaScript æ¨¡å—ï¼ˆä½¿ç”¨ <code>import</code> å’Œ <code>export</code> è¯­æ³•ï¼‰<br>
å¦‚æœé¡¹ç›®ä½¿ç”¨äº† JavaScript çš„æ¨¡å—ç³»ç»Ÿï¼Œå³ä½¿ç”¨äº† ES6 çš„ <code>import</code> å’Œ <code>export</code> è¯­æ³•æ¥ç»„ç»‡å’Œå¯¼å…¥å¯¼å‡ºä»£ç æ–‡ä»¶ï¼Œé‚£ä¹ˆé€‰æ‹©è¿™ä¸ªé€‰é¡¹ã€‚</p>
</li>
<li>
<p>CommonJS (require/exports): CommonJS æ¨¡å—ï¼ˆä½¿ç”¨ <code>require</code> å’Œ <code>module.exports</code> è¯­æ³•ï¼‰<br>
å¦‚æœé¡¹ç›®ä½¿ç”¨äº† <code>CommonJS</code> çš„æ¨¡å—ç³»ç»Ÿï¼Œå³ä½¿ç”¨äº† <code>require</code> å’Œ<code> module.exports</code> è¯­æ³•æ¥ç»„ç»‡å’Œå¯¼å…¥å¯¼å‡ºä»£ç æ–‡ä»¶ï¼Œé‚£ä¹ˆé€‰æ‹©è¿™ä¸ªé€‰é¡¹ã€‚</p>
</li>
<li>
<p>None of these: æ— <br>
å¦‚æœé¡¹ç›®æ—¢ä¸ä½¿ç”¨ <code>JavaScript</code> çš„æ¨¡å—ç³»ç»Ÿï¼Œä¹Ÿä¸ä½¿ç”¨ <code>CommonJS</code> çš„æ¨¡å—ç³»ç»Ÿï¼Œå¯ä»¥é€‰æ‹©è¿™ä¸ªé€‰é¡¹ã€‚</p>
</li>
</ul>
<p>ç”±äºæˆ‘æ˜¯å†™<code>Vue</code>é¡¹ç›®ï¼Œè¿™é‡Œæˆ‘å°±é€‰æ‹©ç¬¬ä¸€ä¸ªã€‚</p>
<p>æ¥ä¸‹æ¥è¯¢é—®åœ¨å“ªä¸ªæ¡†æ¶ä¸­ä½¿ç”¨ï¼š</p>
<pre><code class="language-shell">? Which framework does your project use? ...
React
&gt; Vue.js
None of these
</code></pre>
<p>è¿™é‡Œæˆ‘é€‰æ‹©äº†<code> Vue.js</code>ï¼Œå¤§å®¶æŒ‰éœ€é€‰æ‹©å°±å¥½ã€‚</p>
<p>æ¥ä¸‹æ¥ä¼šè¯¢é—®ä½ æ˜¯å¦ä½¿ç”¨<code>ts</code>å’Œä»£ç åœ¨å“ªé‡Œè¿è¡Œï¼š</p>
<pre><code class="language-shell">âˆš Does your project use TypeScript? Â· No / **Yes**
âˆš Where does your code run? Â· browser, node
</code></pre>
<ul>
<li>Does your project use TypeScript?<br>
è¿™ä¸ªé€‰é¡¹ç”¨æ¥è¯¢é—®æ‚¨çš„é¡¹ç›®æ˜¯å¦ä½¿ç”¨ <code>TypeScript</code>ã€‚<code>TypeScript</code> æ˜¯ä¸€ä¸ª <code>JavaScript</code> çš„è¶…é›†ï¼Œå®ƒæ·»åŠ äº†é™æ€ç±»å‹æ£€æŸ¥å’Œå…¶ä»–ç‰¹æ€§ã€‚æ‚¨å¯ä»¥é€‰æ‹©ä»¥ä¸‹é€‰é¡¹ä¹‹ä¸€ï¼š</li>
</ul>
<p>No: å¦‚æœé¡¹ç›®ä¸ä½¿ç”¨ <code>TypeScript</code>ï¼Œé€‰æ‹©è¿™ä¸ªé€‰é¡¹ã€‚<br>
Yes: å¦‚æœé¡¹ç›®ä½¿ç”¨ <code>TypeScript</code>ï¼Œé€‰æ‹©è¿™ä¸ªé€‰é¡¹ã€‚<br>
å¦‚æœé¡¹ç›®ä½¿ç”¨ <code>TypeScript</code>ï¼ŒESLint ä¼šç»“åˆ <code>@typescript-eslint</code> æ’ä»¶æ¥æä¾› <code>TypeScript</code> ç›¸å…³çš„æ£€æŸ¥å’Œè§„åˆ™ã€‚</p>
<ul>
<li>Where does your code run?<br>
è¿™ä¸ªé€‰é¡¹ç”¨æ¥è¯¢é—®æ‚¨çš„ä»£ç å°†åœ¨ä»€ä¹ˆç¯å¢ƒä¸­è¿è¡Œã€‚æ‚¨å¯ä»¥é€‰æ‹©å¤šä¸ªç¯å¢ƒï¼Œå¦‚æµè§ˆå™¨ã€<code>Node.js</code> ç­‰ã€‚é€‰æ‹©é€‚åˆæ‚¨é¡¹ç›®çš„ç¯å¢ƒç±»å‹ã€‚ä¾‹å¦‚ï¼š</li>
</ul>
<p>browser: å¦‚æœæ‚¨çš„ä»£ç å°†åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œã€‚<br>
node: å¦‚æœæ‚¨çš„ä»£ç å°†åœ¨ Node.js ç¯å¢ƒä¸­è¿è¡Œã€‚<br>
æ ¹æ®æ‚¨çš„é€‰æ‹©ï¼ŒESLint å°†ä¼šæ ¹æ®ä¸åŒçš„ç¯å¢ƒæä¾›ç›¸åº”çš„è§„åˆ™å’Œæ£€æŸ¥ã€‚</p>
<p>è¿™é‡Œè¿˜æ˜¯çœ‹é¡¹ç›®ç±»å‹æŒ‰éœ€é€‰æ‹©ã€‚</p>
<p>æ¥ä¸‹æ¥é—®ä½ å¸Œæœ›å¦‚ä½•å®šä¹‰é¡¹ç›®çš„æ ·å¼ï¼š</p>
<pre><code class="language-shell">âˆš How would you like to define a style for your project? â€¦
  Use a popular style guide
â¯ Answer questions about your style
  ## next
âˆš How would you like to define a style for your project? Â· prompt
</code></pre>
<ul>
<li>
<p>Use a popular style guide: ä½¿ç”¨ä¸€ä¸ªæµè¡Œçš„ä»£ç é£æ ¼æŒ‡å—<br>
å¦‚æœé€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œå°±å¯ä»¥ä»ä¸€äº›å·²çŸ¥çš„æµè¡Œä»£ç é£æ ¼æŒ‡å—ä¸­è¿›è¡Œé€‰æ‹©ï¼Œä¾‹å¦‚ Airbnbã€Googleã€Standard ç­‰ã€‚è¿™å°†ä¼šè‡ªåŠ¨ä¸ºåº”ç”¨é€‰å®šçš„ä»£ç é£æ ¼æŒ‡å—ï¼Œä»¥åŠç›¸å…³çš„ ESLint è§„åˆ™å’Œé…ç½®ã€‚</p>
</li>
<li>
<p>Answer questions about your style: å¦‚æœé€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œå°†ä¼šè¢«å¼•å¯¼å›ç­”ä¸€ç³»åˆ—é—®é¢˜ï¼Œç”¨äºè‡ªå®šä¹‰ä»£ç é£æ ¼é…ç½®ã€‚è¿™å°†æ ¹æ®è‡ªå·±çš„åå¥½å’Œé¡¹ç›®éœ€æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®çš„ ESLint é…ç½®ã€‚</p>
</li>
<li>
<p>next: ç»§ç»­<br>
å¦‚æœé€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œæ‚¨å°†ä¼šè·³è¿‡å½“å‰æ­¥éª¤ï¼Œç»§ç»­ä¸‹ä¸€æ­¥çš„é…ç½®ã€‚</p>
</li>
<li>
<p>How would you like to define a style for your project? Â· prompt<br>
å¦‚æœé€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œæ‚¨å°†ä¼šä½¿ç”¨äº¤äº’å¼æç¤ºæ¥è‡ªå®šä¹‰ä»£ç é£æ ¼ã€‚è¿™å°†ä¼šå¼•å¯¼ä½ å›ç­”ä¸€äº›é—®é¢˜ï¼Œä»¥ä¾¿ä¸ºä½ çš„é¡¹ç›®ç”Ÿæˆé€‚åˆçš„ ESLint é…ç½®ã€‚</p>
</li>
</ul>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç¬¬äºŒä¸ªã€‚</p>
<p>ç„¶åè¯¢é—®ä½ æƒ³ç”¨ä»€ä¹ˆæ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="language-shell">? What format do you want your config file to be in? ...
&gt; JavaScript
  YAML
  JSON
</code></pre>
<p>è¿™é‡Œæˆ‘å°±é€‰<code>JavaScript</code>ã€‚</p>
<p>è¯¢é—®ç¼©è¿›é£æ ¼ï¼š</p>
<pre><code class="language-shell">? What style of indentation do you use? ...
&gt; Tabs
  Spaces
</code></pre>
<ul>
<li>
<p>Tabs: ä½¿ç”¨åˆ¶è¡¨ç¬¦è¿›è¡Œç¼©è¿›<br>
å¦‚æœä½ é€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œä½ çš„ä»£ç ä¸­çš„ç¼©è¿›å°†ä½¿ç”¨åˆ¶è¡¨ç¬¦è¿›è¡Œï¼Œæ¯ä¸€ä¸ªçº§åˆ«çš„ç¼©è¿›éƒ½æ˜¯ä¸€ä¸ªåˆ¶è¡¨ç¬¦ã€‚</p>
</li>
<li>
<p>Spaces: ä½¿ç”¨ç©ºæ ¼è¿›è¡Œç¼©è¿›<br>
å¦‚æœä½ é€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œä½ çš„ä»£ç ä¸­çš„ç¼©è¿›å°†ä½¿ç”¨ç©ºæ ¼è¿›è¡Œï¼Œæ¯ä¸€ä¸ªçº§åˆ«çš„ç¼©è¿›é€šå¸¸æ˜¯ <code>2</code> ä¸ªæˆ– <code>4</code>ä¸ªç©ºæ ¼ï¼Œè¿™å–å†³äºä½ çš„åå¥½å’Œé¡¹ç›®è§„èŒƒã€‚</p>
</li>
</ul>
<p>ç”±äºæˆ‘å–œæ¬¢<code>tab</code>ç¼©è¿›ï¼Œæ‰€ä»¥æˆ‘å°±é€‰æ‹©ç¬¬ä¸€ä¸ªã€‚</p>
<p>å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·è¿˜æ˜¯å•å¼•å·ï¼š</p>
<pre><code class="language-shell">? What quotes do you use for strings? ...
  Double
&gt; Single
</code></pre>
<ul>
<li>
<p>Double: ä½¿ç”¨åŒå¼•å·è¡¨ç¤ºå­—ç¬¦ä¸²<br>
å¦‚æœä½ é€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œä½ çš„ä»£ç ä¸­çš„å­—ç¬¦ä¸²å°†ä½¿ç”¨åŒå¼•å·åŒ…è£¹ï¼Œä¾‹å¦‚ &quot;Hello, World!&quot;ã€‚</p>
</li>
<li>
<p>Single: ä½¿ç”¨å•å¼•å·è¡¨ç¤ºå­—ç¬¦ä¸²<br>
å¦‚æœä½ é€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œä½ çš„ä»£ç ä¸­çš„å­—ç¬¦ä¸²å°†ä½¿ç”¨å•å¼•å·åŒ…è£¹ï¼Œä¾‹å¦‚ 'Hello, World!'ã€‚</p>
</li>
</ul>
<p>è¿™é‡Œçœ‹ä¸ªäººorå›¢é˜Ÿä¹ æƒ¯ï¼Œè¿™é‡Œæˆ‘å°±é€‰æ‹©äº†å•å¼•å·ã€‚</p>
<p>ç”¨å“ªç§ç»“æŸç¬¦ï¼š</p>
<pre><code class="language-shell">? What line endings do you use? ...
&gt; Unix
  Windows
</code></pre>
<ul>
<li>
<p>Unix: ä½¿ç”¨ Unix é£æ ¼çš„æ¢è¡Œç¬¦<br>
å¦‚æœä½ é€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œä½ çš„ä»£ç ä¸­çš„æ¢è¡Œç¬¦å°†é‡‡ç”¨ <code>Unix</code> é£æ ¼ï¼Œå³ <code>LF</code>ï¼ˆæ¢è¡Œ<code> Line Feed</code>ï¼‰ã€‚</p>
</li>
<li>
<p>Windows: ä½¿ç”¨ Windows é£æ ¼çš„æ¢è¡Œç¬¦<br>
å¦‚æœä½ é€‰æ‹©äº†è¿™ä¸ªé€‰é¡¹ï¼Œä½ çš„ä»£ç ä¸­çš„æ¢è¡Œç¬¦å°†é‡‡ç”¨ <code>Windows</code> é£æ ¼ï¼Œå³ <code>CRLF</code>ï¼ˆå›è½¦æ¢è¡Œ <code>Carriage Return Line Feed</code>ï¼‰ã€‚</p>
</li>
</ul>
<p>è¿™é‡Œæˆ‘é€‰æ‹©<code>Unix</code>ã€‚</p>
<p>æ˜¯å¦ä½¿ç”¨åˆ†å·ï¼š</p>
<pre><code class="language-shell">? Do you require semicolons? Â» No / Yes
</code></pre>
<p>æˆ‘ä¸ªäººä¸å–œæ¬¢ä½¿ç”¨åˆ†å·ï¼Œæ‰€ä»¥é€‰æ‹©<code>No</code></p>
<p>ç„¶åä¼šé—®ä½ æ˜¯å¦å®‰è£…ä¾èµ–ï¼š</p>
<pre><code class="language-shell">@typescript-eslint/eslint-plugin@latest eslint-plugin-vue@latest @typescript-eslint/parser@latest
? Would you like to install them now? Â» No / Yes   
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©<code>Yes</code>ï¼Œç„¶åä¼šè¯¢é—®ä½ ç”¨ä»€ä¹ˆåŒ…ç®¡ç†å™¨å»å®‰è£…ä¾èµ–ï¼š</p>
<pre><code class="language-shell">? Which package manager do you want to use? ...
  npm
  yarn
&gt; pnpm 
</code></pre>
<p>è¿™é‡Œæˆ‘é€‰æ‹©<code>npm</code>ã€‚</p>
<p>å®‰è£…å®Œæˆåæˆ‘ä»¬é¡¹ç›®çš„æ ¹ç›®å½•ä¼šç”Ÿæˆ<code>.eslintrc.js</code>æ–‡ä»¶ï¼š</p>
<pre><code class="language-js">module.exports = {
	env: {
		browser: true,
		es2021: true
	},
	extends: ['eslint:recommended', 'plugin:vue/vue3-essential'],
	overrides: [
		{
			env: {
				node: true
			},
			files: ['.eslintrc.{js,cjs}'],
			parserOptions: {
				sourceType: 'script'
			}
		}
	],
	parserOptions: {
		ecmaVersion: 'latest',
		sourceType: 'module'
	},
	plugins: ['vue'],
	rules: {
		indent: ['error', 'tab'],
		'linebreak-style': ['error', 'unix'],
		quotes: ['error', 'single'],
		semi: ['error', 'never']
	}
}
</code></pre>
<p>æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å®ƒå¯ä»¥å¿½ç•¥ä¸€äº›æ£€æŸ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æ ¹ç›®å½•å»ºç«‹ä¸€ä¸ª<code>.eslintignore</code>æ–‡ä»¶ç”¨æ¥å¿½ç•¥ä¸€äº›æ£€æŸ¥ï¼Œè¿™é‡Œæ ¹æ®ä¸ªäººéœ€æ±‚è¿›è¡Œé…ç½®å³å¯ï¼Œæˆ‘çš„é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">*.sh
node_modules
*.md
*.woff
*.ttf
.vscode
.idea
dist
/public
/docs
.husky
.local
/bin
Dockerfile
</code></pre>
<h2 id="é…ç½®prettier">é…ç½®Prettier</h2>
<p>å°½ç®¡ <code>ESLint</code> å’Œ <code>Prettier</code> éƒ½å…·å¤‡ä»£ç è´¨é‡å’Œç»´æŠ¤æ€§æ–¹é¢çš„åŠŸèƒ½ï¼Œä½†å®ƒä»¬çš„ç„¦ç‚¹ä¸åŒã€‚é€šè¿‡åŒæ—¶ä½¿ç”¨ <code>ESLint</code> å’Œ <code>Prettier</code>ï¼Œå¯ä»¥è·å¾—ä»£ç è´¨é‡çš„å…¨é¢æ£€æŸ¥ï¼ŒåŒæ—¶ç¡®ä¿ä»£ç é£æ ¼çš„ä¸€è‡´æ€§ã€‚é€šå¸¸çš„åšæ³•æ˜¯å°† <code>ESLint</code> ç”¨äºæ£€æµ‹ä»£ç é—®é¢˜å’Œé€»è¾‘é”™è¯¯ï¼Œè€Œ <code>Prettier</code> åˆ™ç”¨äºè‡ªåŠ¨æ ¼å¼åŒ–ä»£ç ï¼Œä»¥ä¾¿ä»£ç åœ¨ä¸åŒäººä¹‹é—´ä¿æŒä¸€è‡´çš„å¤–è§‚ã€‚è¿™æ ·å¯ä»¥æœ€å¤§é™åº¦åœ°æé«˜ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<p>å®‰è£…ï¼š</p>
<pre><code class="language-shell">npm add prettier -D
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º<code>.prettierrc.js</code>æ–‡ä»¶ï¼Œè¿™é‡Œç®€å•åˆ—ä¸€ä¸‹å¸¸ç”¨çš„ï¼Œå‰©ä¸‹çš„å¯ä»¥åˆ°å®˜ç½‘æŸ¥çœ‹</p>
<pre><code class="language-js">module.exports = {
    printWidth: 100, //ä¸€è¡Œçš„å­—ç¬¦æ•°
    tabWidth: 4, // ä¸€ä¸ªtabä»£è¡¨å‡ ä¸ªç©ºæ ¼æ•°
    useTabs: true, //æ˜¯å¦ä½¿ç”¨tabè¿›è¡Œç¼©è¿›
    singleQuote: true, //å­—ç¬¦ä¸²æ˜¯å¦ä½¿ç”¨å•å¼•å·
    semi: false, // è¡Œå°¾æ˜¯å¦ä½¿ç”¨åˆ†å·ï¼Œé»˜è®¤ä¸ºtrue
    trailingComma: &quot;none&quot;, // æ˜¯å¦ä½¿ç”¨å°¾é€—å·
    htmlWhitespaceSensitivity: &quot;strict&quot;, // HTMLç©ºç™½æ•æ„Ÿåº¦
    bracketSpacing: true, // å¯¹è±¡å¤§æ‹¬å·ç›´æ¥æ˜¯å¦æœ‰ç©ºæ ¼ï¼Œé»˜è®¤ä¸º trueï¼Œæ•ˆæœï¼š{ a: 1 }
    proseWrap: &quot;never&quot;, // æ¢è¡Œè®¾ç½®
}
</code></pre>
<p>åŒæ—¶ä¹Ÿå¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹å»ºç«‹å¿½ç•¥æ–‡ä»¶<code>.prettierignore</code>ï¼š</p>
<pre><code class="language-js">/dist/*
.local
.output.js
/node_modules/**
**/*.svg
**/*.sh
/public/*
</code></pre>
<h2 id="eslintä¸prettierç›¸ç»“åˆ">eslintä¸Prettierç›¸ç»“åˆ</h2>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>eslint-config-prettier</code>å’Œ<code>eslint-plugin-prettier</code>æ¥ç»“åˆeslintä¸Prettierã€‚</p>
<p><code>eslint-config-prettier</code>ç”¨æ¥è¦†ç›– <code>ESLint</code> æœ¬èº«çš„è§„åˆ™é…ç½®ï¼Œ</p>
<p><code>eslint-plugin-prettier</code>åˆ™æ˜¯ç”¨äºè®© <code>Prettier</code> æ¥æ¥ç®¡<code>eslint --fix</code>å³ä¿®å¤ä»£ç çš„èƒ½åŠ›ã€‚</p>
<p>å®‰è£…ï¼š</p>
<pre><code class="language-shell">npm i eslint-config-prettier eslint-plugin-prettier -D
</code></pre>
<p>æœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">module.exports = {
	env: {
		browser: true,
		es2021: true
	},
	extends: ['eslint:recommended', 'plugin:vue/vue3-essential', 'plugin:prettier/recommended'],
	overrides: [
		{
			env: {
				node: true
			},
			files: ['.eslintrc.{js,cjs}'],
			parserOptions: {
				sourceType: 'script'
			}
		}
	],
	// å‚è€ƒvueå®˜æ–¹æ¨è,æ›¿æ¢é»˜è®¤parser
	parser: 'vue-eslint-parser',
	parserOptions: {
		ecmaVersion: 'latest',
		sourceType: 'module'
	},
	plugins: ['vue'],
	rules: {
		indent: ['error', 'tab'],
		'linebreak-style': ['error', 'unix'],
		quotes: ['error', 'single'],
		semi: ['error', 'never']
	}
}
</code></pre>
<p>ç„¶ååœ¨é¡¹ç›®çš„<code>package.json</code>ä¸­é…ç½®ä¸€æ¡å‘½ä»¤ï¼š</p>
<pre><code class="language-shell">{
    &quot;scripts&quot;: {
        &quot;lint:script&quot;: &quot;eslint --ext .js,.jsx --fix --quiet ./&quot;,
    }
}
</code></pre>
<p>è¯¥å‘½ä»¤äºæ£€æŸ¥å’Œä¿®å¤ä»£ç è¯¥å‘½ä»¤çš„ä½œç”¨æ˜¯åœ¨æŒ‡å®šçš„æ–‡ä»¶æ‰©å±•åï¼ˆ.jsã€.jsxï¼‰ä¸‹ï¼Œè¿è¡Œ <code>ESLint</code> æ¥æ£€æŸ¥å¹¶å°è¯•ä¿®å¤å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸­çš„ä»£ç é—®é¢˜ã€‚å‘½ä»¤çš„ç›®æ ‡æ˜¯è‡ªåŠ¨åŒ–ä»£ç è´¨é‡æ£€æŸ¥å’Œæ ¼å¼ä¿®å¤çš„è¿‡ç¨‹ï¼Œä»¥ç¡®ä¿ä»£ç ç¬¦åˆè§„èŒƒå’Œæœ€ä½³å®è·µã€‚</p>
<p>ä½†è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œç›®å‰åªä¼šæ£€æµ‹<code>.js</code>ã€<code>.jsx</code>æ–‡ä»¶ï¼Œå¹¶ä¸ä¼šæ£€æµ‹<code>.vue</code>æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦å€ŸåŠ©ä¸€äº›æ’ä»¶æ¥å®ç°ã€‚</p>
<h3 id="æ”¯æŒvueæ–‡ä»¶">æ”¯æŒ.vueæ–‡ä»¶</h3>
<p>å®‰è£…ä¸‹é¢æ’ä»¶:</p>
<pre><code class="language-shell">npm install eslint-plugin-vue vue-eslint-parser --save-dev
</code></pre>
<p>é…ç½®<code>.eslintrc.js</code>ï¼Œåœ¨<code>extends</code>ä¸­æ·»åŠ è¿™ä¸¤ä¸ªæ’ä»¶ï¼Œæœ€ç»ˆé…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">module.exports = {
	env: {
		browser: true,
		es2021: true,
		node: true
	},
	extends: [
		'eslint:recommended',
		'plugin:vue/vue3-essential',
		//æ–°å¢æ’ä»¶
		'plugin:prettier/recommended',
		'plugin:vue/recommended'
	],
	overrides: [
		{
			env: {
				node: true
			},
			files: ['.eslintrc.{js,cjs}'],
			parserOptions: {
				sourceType: 'script'
			}
		},
		{
			files: ['*.vue'],
			rules: {
				'no-undef': 'off',
				'vue/no-setup-props-destructure': 'off',
				'vue/multi-word-component-names': 'off',
				'vue/no-mutating-props': 'off',
				'no-unused-vars': 0,
				'vue/valid-attribute-name': 'off'
			}
		}
	],
	// å‚è€ƒvueå®˜æ–¹æ¨è,æ›¿æ¢é»˜è®¤parser
	parser: 'vue-eslint-parser',
	parserOptions: {
		ecmaVersion: 'latest',
		sourceType: 'module'
	},
	plugins: ['vue'],
	rules: {
		'prettier/prettier': 'error',
		indent: ['error', 'tab'],
		'linebreak-style': ['error', 'unix'],
		quotes: ['error', 'single'],
		semi: ['error', 'never'],
		'no-console': 'off',
		'no-debugger': 'off'
	}
}
</code></pre>
<p>ç„¶åä¿®æ”¹å‘½ä»¤ä¸ºï¼š</p>
<pre><code class="language-shell">&quot;scripts&quot;: {
	&quot;lint:script&quot;: &quot;eslint --ext .js,.jsx,.vue --fix --quiet ./&quot;
},
</code></pre>
<h2 id="è¿è¡Œæ—¶å®æ—¶éªŒè¯">è¿è¡Œæ—¶å®æ—¶éªŒè¯</h2>
<p>å¦‚æœä½¿ç”¨<code>vscode</code>ç¼–è¾‘å™¨ï¼Œå¯ä»¥ä¸‹è½½<code>ESLint</code>å’Œ<code>Prettier-Code formatter</code>è¿›è¡ŒéªŒè¯ï¼Œè¯¥æ’ä»¶ä¼šæ£€æµ‹é¡¹ç›®æ ¹ç›®å½•æ˜¯å¦å­˜åœ¨ç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå¦‚æœæœ‰ç›¸å…³é…ç½®æ–‡ä»¶åˆ™ä¼šæ ¹æ®é…ç½®æ–‡ä»¶åœ¨ä¿å­˜çš„æ—¶å€™è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœä¸ç”¨<code>vscode</code>å¼€å‘ä¹Ÿæ²¡å…³ç³»ï¼Œå¯ä»¥å€ŸåŠ©ä¸€äº›æ’ä»¶å®ç°è¿è¡Œæ—¶ä»£ç ä¿å­˜æ—¶å€™æ ¹æ®è§„åˆ™è¿›è¡ŒéªŒè¯ã€‚</p>
<pre><code class="language-shell">npm i vite-plugin-prettier 
</code></pre>
<p>åœ¨<code>vite.config.jsæ–‡ä»¶ä¸­å¼•å…¥æ’ä»¶</code>æ–‡ä»¶ä¸­å¼•å…¥æ’ä»¶ï¼š</p>
<pre><code class="language-js">import VitePrettier from 'vite-plugin-prettier'
export default defineConfig({
  plugins: [
    VitePrettier({
      singleQuote: true,// å­—ç¬¦ä¸²æ˜¯å¦ä½¿ç”¨å•å¼•å·
      //...æ›´å¤šè§„åˆ™
    })
  ],
})
</code></pre>
<p>é…ç½®åé‡å¯é¡¹ç›®ï¼Œåªè¦é¡¹ç›®åœ¨è¿è¡Œä¸­ï¼Œä¿å­˜ä»£ç å°±ä¼šé€šè¿‡<code>prettier</code>è¿›è¡Œä»£ç æ ¼å¼åŒ–å¤„ç†ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€nodeå­¦ä¹ -02ã€‘å¦‚ä½•æ­å»ºè‡ªå·±çš„è„šæ‰‹æ¶]]></title>
        <id>https://lonjinup.github.io/node-02-cli/</id>
        <link href="https://lonjinup.github.io/node-02-cli/">
        </link>
        <updated>2023-08-22T14:31:55.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å¦‚ä½•æ­å»ºè‡ªå·±çš„è„šæ‰‹æ¶">å¦‚ä½•æ­å»ºè‡ªå·±çš„è„šæ‰‹æ¶</h1>
<h2 id="æ¦‚è¦">æ¦‚è¦</h2>
<h3 id="ä»€ä¹ˆæ˜¯è„šæ‰‹æ¶">ä»€ä¹ˆæ˜¯è„šæ‰‹æ¶ï¼Ÿ</h3>
<ul>
<li><strong>è„šæ‰‹æ¶</strong>æ˜¯ä¸€ç§å·¥å…·ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå…¨å±€å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºå¸®åŠ©å¼€å‘äººå‘˜å¿«é€Ÿåˆ›å»ºå’Œåˆå§‹åŒ–é¡¹ç›®æ–‡ä»¶å’Œç›®å½•ç»“æ„ã€‚</li>
</ul>
<h3 id="è„šæ‰‹æ¶çš„åŸºæœ¬èƒ½åŠ›">è„šæ‰‹æ¶çš„åŸºæœ¬èƒ½åŠ›</h3>
<ul>
<li>
<p><strong>å‘½ä»¤è¡Œæ‰§è¡Œèƒ½åŠ›ï¼š</strong> è„šæ‰‹æ¶å…·å¤‡èƒ½å¤Ÿåœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œçš„èƒ½åŠ›ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡å‘½ä»¤è¡Œå‘½ä»¤æ¥è§¦å‘è„šæ‰‹æ¶çš„å„ç§åŠŸèƒ½ã€‚</p>
</li>
<li>
<p><strong>å‘½ä»¤è¡Œäº¤äº’èƒ½åŠ›ï¼š</strong> è„šæ‰‹æ¶å¯ä»¥ä¸ç”¨æˆ·è¿›è¡Œå‘½ä»¤è¡Œäº¤äº’ï¼Œæç¤ºç”¨æˆ·æä¾›å¿…è¦çš„ä¿¡æ¯æˆ–é€‰é¡¹ï¼Œä»¥ä¾¿æ ¹æ®ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œé¡¹ç›®åˆå§‹åŒ–ã€‚</p>
</li>
<li>
<p><strong>é¡¹ç›®åˆå§‹åŒ–ä»£ç ä¸‹è½½èƒ½åŠ›ï¼š</strong> è„šæ‰‹æ¶èƒ½å¤Ÿä»è¿œç¨‹ä»£ç ä»“åº“ä¸‹è½½é¡¹ç›®çš„åˆå§‹åŒ–ä»£ç ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°åˆ›å»ºé¡¹ç›®ã€‚</p>
</li>
</ul>
<h3 id="å¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå·±çš„è„šæ‰‹æ¶å·¥å…·">å¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå·±çš„è„šæ‰‹æ¶å·¥å…·</h3>
<p>è¦å®ç°ä¸€ä¸ªè‡ªå·±çš„è„šæ‰‹æ¶å·¥å…·ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œå®ç°</p>
<ol>
<li>
<p><strong>åˆ›å»ºè‡ªå®šä¹‰å…¨å±€å‘½ä»¤ï¼š</strong> ä½¿ç”¨Node.jsæˆ–å…¶ä»–é€‚åˆçš„ç¼–ç¨‹è¯­è¨€åˆ›å»ºä¸€ä¸ªå…¨å±€å‘½ä»¤è¡Œå·¥å…·ï¼Œè¿™ä¸ªå‘½ä»¤å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡å‘½ä»¤è¡Œè°ƒç”¨ã€‚é€šå¸¸éœ€è¦ä½¿ç”¨åŒ…ç®¡ç†å™¨ï¼ˆå¦‚npmï¼‰æ¥å®‰è£…å…¨å±€å‘½ä»¤ã€‚</p>
</li>
<li>
<p><strong>å‘½ä»¤å‚æ•°æ¥å—å¤„ç†ï¼š</strong> åœ¨æ‚¨çš„è„šæ‰‹æ¶å·¥å…·ä¸­ï¼Œç¼–å†™ä»£ç ä»¥æ¥å—å‘½ä»¤è¡Œå‚æ•°ï¼Œè¿™äº›å‚æ•°å°†æŒ‡å¯¼è„šæ‰‹æ¶æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚æ‚¨å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œè§£æåº“æ¥å¸®åŠ©å¤„ç†å’Œè§£é‡Šè¿™äº›å‚æ•°ã€‚</p>
</li>
<li>
<p><strong>ä¸‹è½½è¿œç¨‹é¡¹ç›®ä»£ç ï¼š</strong> å®ç°ä»£ç ä¸‹è½½åŠŸèƒ½ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Gitæˆ–å…¶ä»–ç‰ˆæœ¬æ§åˆ¶å·¥å…·æ¥ä»è¿œç¨‹ä»“åº“ä¸­è·å–é¡¹ç›®çš„åˆå§‹åŒ–ä»£ç ã€‚ç¡®ä¿æ‚¨çš„è„šæ‰‹æ¶å¯ä»¥å¤„ç†ä¸åŒçš„ä»£ç æºï¼ˆä¾‹å¦‚GitHubã€GitLabç­‰ï¼‰ã€‚</p>
</li>
<li>
<p><strong>é¡¹ç›®åˆå§‹åŒ–å®Œæˆæç¤ºï¼š</strong> åœ¨é¡¹ç›®åˆå§‹åŒ–å®Œæˆåï¼Œå‘ç”¨æˆ·æä¾›é€‚å½“çš„æç¤ºä¿¡æ¯ï¼ŒæŒ‡å¯¼ä»–ä»¬ä¸‹ä¸€æ­¥çš„æ“ä½œã€‚è¿™å¯ä»¥åŒ…æ‹¬è¿è¡Œé¡¹ç›®ã€å®‰è£…ä¾èµ–é¡¹æˆ–å…¶ä»–ç›¸å…³ä»»åŠ¡ã€‚</p>
</li>
<li>
<p><strong>æµ‹è¯•å’Œæ–‡æ¡£ï¼š</strong> ç¼–å†™æµ‹è¯•ç”¨ä¾‹æ¥ç¡®ä¿è„šæ‰‹æ¶çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚å¦å¤–ï¼Œæä¾›æ¸…æ™°çš„æ–‡æ¡£ï¼Œè§£é‡Šå¦‚ä½•å®‰è£…ã€ä½¿ç”¨å’Œå®šåˆ¶æ‚¨çš„è„šæ‰‹æ¶å·¥å…·ã€‚</p>
</li>
<li>
<p><strong>å‘å¸ƒå’Œåˆ†äº«ï¼š</strong> å°†æ‚¨çš„è„šæ‰‹æ¶å·¥å…·å‘å¸ƒåˆ°é€‚å½“çš„åŒ…ç®¡ç†å™¨ï¼ˆå¦‚npmï¼‰ï¼Œä»¥ä¾¿å…¶ä»–å¼€å‘äººå‘˜å¯ä»¥è½»æ¾å®‰è£…å’Œä½¿ç”¨å®ƒã€‚åˆ†äº«æ‚¨çš„è„šæ‰‹æ¶çš„ä»£ç å’Œæ–‡æ¡£ï¼Œä»¥ä¿ƒè¿›ç¤¾åŒºçš„è´¡çŒ®å’Œæ”¹è¿›ã€‚</p>
</li>
</ol>
<p>é€šè¿‡éµå¾ªè¿™äº›æ­¥éª¤ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„è„šæ‰‹æ¶å·¥å…·ï¼Œä½¿é¡¹ç›®åˆå§‹åŒ–å’Œå¼€å‘è¿‡ç¨‹æ›´åŠ é«˜æ•ˆå’Œæ–¹ä¾¿ã€‚</p>
<h2 id="åˆ›å»ºè‡ªå®šä¹‰å…¨å±€å‘½ä»¤">åˆ›å»ºè‡ªå®šä¹‰å…¨å±€å‘½ä»¤</h2>
<ol>
<li>
<p><strong>åˆ›å»ºæ–‡ä»¶ç»“æ„ï¼š</strong> æˆ‘ä»¬é¦–å…ˆéœ€è¦è®¾ç½®ä¸€ä¸ªé€‚å½“çš„æ–‡ä»¶ç»“æ„æ¥å¼€å§‹åˆ›å»ºè‡ªå®šä¹‰å…¨å±€å‘½ä»¤ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šæ–°å»ºä¸€ä¸ªåä¸º<code>code</code>çš„æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸º<code>bin</code>çš„å­æ–‡ä»¶å¤¹ã€‚åœ¨<code>bin</code>æ–‡ä»¶å¤¹ä¸­ï¼Œæˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ªåä¸º<code>cli.js</code>çš„æ–‡ä»¶ã€‚è¿™ä¸ª<code>cli.js</code>æ–‡ä»¶å°†åŒ…å«æˆ‘ä»¬è‡ªå®šä¹‰å‘½ä»¤çš„æ‰§è¡Œé€»è¾‘ã€‚</p>
</li>
<li>
<p><strong>é¡¹ç›®åˆå§‹åŒ–ï¼š</strong> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦åˆå§‹åŒ–ä¸€ä¸ªnpmé¡¹ç›®ï¼Œä»¥ä¾¿ç®¡ç†æˆ‘ä»¬çš„å…¨å±€å‘½ä»¤ã€‚åœ¨å‘½ä»¤è¡Œä¸­ï¼Œæˆ‘ä»¬è¿›å…¥é¡¹ç›®çš„æ ¹ç›®å½•ï¼ˆåœ¨<code>code</code>æ–‡ä»¶å¤¹ä¸‹ï¼‰ï¼Œå¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
</li>
</ol>
<pre><code class="language-shell">npm init -y
</code></pre>
<p>åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†é¡¹ç›®å‘½åä¸º<code>my-cli</code>ï¼Œå¹¶ä¸”å¯¹å…¶ä»–é¡¹ç›®é€‰é¡¹é‡‡ç”¨é»˜è®¤å€¼ï¼Œå› ä¸ºè¿™äº›é€‰é¡¹å¯ä»¥ç¨ååœ¨<code>package.json</code>ä¸­ä¿®æ”¹ã€‚</p>
<ol start="3">
<li><strong>é…ç½®å…¨å±€å‘½ä»¤ï¼š</strong> åœ¨æˆ‘ä»¬çš„é¡¹ç›®çš„<code>package.json</code>æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸€ä¸ªç‰¹æ®Šçš„å­—æ®µå«åš<code>bin</code>ï¼Œå®ƒç”¨äºé…ç½®å…¨å±€å‘½ä»¤ã€‚æˆ‘ä»¬å°†åœ¨è¿™é‡Œå®šä¹‰æˆ‘ä»¬çš„å…¨å±€å‘½ä»¤ä¸<code>cli.js</code>æ–‡ä»¶ä¹‹é—´çš„å…³è”ï¼Œè¿™æ ·npmå°±çŸ¥é“å¦‚ä½•å°†æˆ‘ä»¬çš„å‘½ä»¤æ˜ å°„åˆ°å…¨å±€ç¯å¢ƒä¸­ã€‚</li>
</ol>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;my-cli&quot;,
    &quot;version&quot;: &quot;1.0.0&quot;,
    &quot;description&quot;: &quot;&quot;,
    &quot;main&quot;: &quot;index.js&quot;,
    &quot;bin&quot;: {
        &quot;my-cli&quot;: &quot;bin/cli.js&quot;
    },
    &quot;scripts&quot;: {
        &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
    },
    &quot;author&quot;: &quot;&quot;,
    &quot;license&quot;: &quot;ISC&quot;
}
</code></pre>
<ol start="4">
<li><strong>æŒ‚è½½å…¨å±€å‘½ä»¤ï¼š</strong> æœ€åï¼Œä¸ºäº†ä½¿æˆ‘ä»¬çš„è‡ªå®šä¹‰å…¨å±€å‘½ä»¤åœ¨ç³»ç»Ÿä¸­å¯ç”¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¿™å°†ä½¿æˆ‘ä»¬çš„å…¨å±€å‘½ä»¤é“¾æ¥åˆ°å…¨å±€npmåŒ…ï¼š</li>
</ol>
<pre><code class="language-shell">npm link
</code></pre>
<p>è¿™ä¸€æ­¥éª¤å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨<code>my-cli</code>å‘½ä»¤æ¥æ‰§è¡Œæˆ‘ä»¬åœ¨<code>cli.js</code>æ–‡ä»¶ä¸­å®šä¹‰çš„é€»è¾‘äº†ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬å¯ä»¥åœ¨<code>cli.js</code>ä¸­å†™ç‚¹ä»£ç ï¼š</p>
<pre><code class="language-js">#! /usr/bin/env node

console.log('æˆ‘çš„cli')
</code></pre>
<p>ç„¶åè¿è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="language-js">my-cli
</code></pre>
<p>æ­¤æ—¶æˆ‘ä»¬å°±ä¼šåœ¨æ§åˆ¶å®ƒä¸Šçœ‹åˆ°æˆ‘ä»¬çš„æ‰“å°å†…å®¹ï¼š<code>æˆ‘çš„cli</code>ã€‚</p>
<blockquote>
<p><code>#! /usr/bin/env node</code> æ˜¯ä¸€ä¸ªåœ¨Unix-likeæ“ä½œç³»ç»Ÿä¸­ç”¨äºæŒ‡å®šè„šæœ¬çš„è§£é‡Šå™¨çš„ç‰¹æ®Šæ³¨é‡Šã€‚è¿™ä¸ªæ³¨é‡Šçš„ä½œç”¨æ˜¯å‘Šè¯‰æ“ä½œç³»ç»Ÿä½¿ç”¨å“ªä¸ªè§£é‡Šå™¨æ¥æ‰§è¡Œè„šæœ¬æ–‡ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæŒ‡å®šäº†ä½¿ç”¨Node.jsä½œä¸ºè§£é‡Šå™¨æ¥æ‰§è¡Œè¯¥è„šæœ¬ã€‚</p>
</blockquote>
<p>å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><code>#!</code>ï¼šè¿™ä¸ªå­—ç¬¦åºåˆ—ç§°ä¸º&quot;shebang&quot;ï¼Œå®ƒå‘Šè¯‰æ“ä½œç³»ç»Ÿä»¥ä¸‹å†…å®¹æ˜¯ç”¨äºè§£é‡Šæ‰§è¡Œè„šæœ¬çš„å‘½ä»¤ã€‚</p>
</li>
<li>
<p><code>/usr/bin/env</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºåœ¨ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­æŸ¥æ‰¾æŒ‡å®šçš„å‘½ä»¤æˆ–ç¨‹åºã€‚åœ¨è¿™é‡Œï¼Œå®ƒè¢«ç”¨äºå¯»æ‰¾å¯ç”¨çš„<code>node</code>å‘½ä»¤ã€‚</p>
</li>
<li>
<p><code>node</code>ï¼šè¿™æ˜¯Node.jsçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å½“æ“ä½œç³»ç»Ÿæ‰§è¡Œè¿™ä¸ªè„šæœ¬æ—¶ï¼Œå®ƒä¼šæ‰¾åˆ°<code>/usr/bin/env node</code>ï¼Œç„¶åä½¿ç”¨Node.jsæ¥è§£é‡Šå’Œæ‰§è¡Œæ¥ä¸‹æ¥çš„è„šæœ¬å†…å®¹ã€‚</p>
</li>
</ul>
<p>å› æ­¤ï¼Œ<code>#! /usr/bin/env node</code> å¸®åŠ©æˆ‘ä»¬ç¡®ä¿æ— è®ºç”¨æˆ·çš„ç³»ç»Ÿä¸ŠNode.jsçš„å®‰è£…è·¯å¾„å¦‚ä½•ï¼Œéƒ½å¯ä»¥æ­£ç¡®åœ°æ‰§è¡Œæˆ‘ä»¬çš„Node.jsè„šæœ¬ã€‚è¿™å¯¹äºå…¨å±€å‘½ä»¤è¡Œå·¥å…·éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦åœ¨ä¸åŒçš„ç³»ç»Ÿä¸Šè¿è¡Œï¼Œè€Œè¿™äº›ç³»ç»Ÿå¯èƒ½æœ‰ä¸åŒçš„Node.jså®‰è£…è·¯å¾„ã€‚è¿™ä¸ªshebangæ³¨é‡Šç¡®ä¿äº†è„šæœ¬çš„å¯ç§»æ¤æ€§å’Œè·¨å¹³å°å…¼å®¹æ€§ã€‚</p>
<ol start="5">
<li><strong>è·å–å‘½ä»¤è¡Œå‚æ•°ï¼š</strong></li>
</ol>
<p>åœ¨æˆ‘ä»¬çš„è‡ªå®šä¹‰å…¨å±€å‘½ä»¤ä¸­ï¼Œé€šå¸¸éœ€è¦è·å–å’Œè§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œä»¥ä¾¿æ ¹æ®ç”¨æˆ·çš„è¾“å…¥æ¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥åœ¨<code>cli.js</code>æ–‡ä»¶ä¸­ç¼–å†™å¦‚ä¸‹ä»£ç æ¥è·å–å‘½ä»¤è¡Œå‚æ•°ï¼š</p>
<pre><code class="language-javascript">console.log(process.argv);
</code></pre>
<p>å½“æˆ‘ä»¬è¿è¡Œåƒ<code>my-cli --help</code>è¿™æ ·çš„å‘½ä»¤æ—¶ï¼Œæ§åˆ¶å°å°†ä¼šæ‰“å°å‡ºä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="language-javascript">[ '/usr/local/bin/node', '/usr/local/bin/my-cli', '--help' ]
</code></pre>
<p>åœ¨è¿™ä¸ªè¾“å‡ºä¸­ï¼Œ<code>process.argv</code>æ•°ç»„åŒ…å«äº†å‘½ä»¤è¡Œä¸­çš„æ‰€æœ‰å‚æ•°ã€‚å…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li><code>process.argv[0]</code> æ˜¯ Node.js çš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼ˆåœ¨è¿™é‡Œæ˜¯<code>/usr/local/bin/node</code>ï¼‰ã€‚</li>
<li><code>process.argv[1]</code> æ˜¯æˆ‘ä»¬çš„å…¨å±€å‘½ä»¤çš„è·¯å¾„ï¼ˆåœ¨è¿™é‡Œæ˜¯<code>/usr/local/bin/my-cli</code>ï¼‰ã€‚</li>
<li>åç»­é¡¹åŒ…å«ä¼ é€’ç»™å‘½ä»¤çš„å‚æ•°ï¼Œä¾‹å¦‚<code>--help</code>ã€‚</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™äº›å‚æ•°æ¥ç¼–å†™é€»è¾‘ï¼Œä»¥å†³å®šå¦‚ä½•å¤„ç†ç”¨æˆ·çš„è¾“å…¥ã€‚è¿™æ˜¯å®ç°å‘½ä»¤è¡Œäº¤äº’èƒ½åŠ›çš„ä¸€éƒ¨åˆ†ï¼Œå…è®¸æˆ‘ä»¬æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚æ¥æ‰§è¡Œä¸åŒçš„åŠŸèƒ½æ“ä½œã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="language-js">if(process.argv[2] === '--help'){
    console.log('è·å–åˆ°äº†å‚æ•°')
}
</code></pre>
<p>ä½†åœ¨å®é™…æƒ…å†µä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›ç¬¬ä¸‰æ–¹çš„åŒ…å»ç®¡ç†æˆ‘ä»¬çš„æŒ‡ä»¤ï¼›æ¯”å¦‚ï¼š<code>commander</code>ï¼ˆå‘½ä»¤å‚æ•°å¤„ç†å·¥å…·ï¼‰ã€‚</p>
<h2 id="commanderå‘½ä»¤å‚æ•°å¤„ç†å·¥å…·">Commanderå‘½ä»¤å‚æ•°å¤„ç†å·¥å…·</h2>
<p><a href="https://www.npmjs.com/package/commander">Commander</a> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„Node.jsæ¨¡å—ï¼Œç”¨äºå¤„ç†å‘½ä»¤è¡Œå‚æ•°ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨Commanderçš„åŸºæœ¬æ­¥éª¤ï¼š</p>
<h3 id="å®‰è£…commander">å®‰è£…Commander</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨npmä¸Šæœç´¢å¹¶å®‰è£…Commanderæ¨¡å—ï¼Œè¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®Œæˆï¼š</p>
<pre><code class="language-shell">npm install commander
</code></pre>
<h3 id="å¼•å…¥å’Œä½¿ç”¨commander">å¼•å…¥å’Œä½¿ç”¨Commander</h3>
<p>åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥Commanderæ¨¡å—å¹¶å¼€å§‹ä½¿ç”¨å®ƒæ¥å¤„ç†å‘½ä»¤è¡Œå‚æ•°ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šåœ¨è„šæœ¬çš„å¼€å¤´åŠ ä¸Šå¦‚ä¸‹æ³¨é‡Šæ¥æŒ‡å®šNode.jsä½œä¸ºè§£é‡Šå™¨ï¼š</p>
<pre><code class="language-javascript">#! /usr/bin/env node
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œåœ¨æˆ‘ä»¬çš„<code>cli.js</code>æ–‡ä»¶ä¸­ï¼Œå¼•å…¥Commanderå¹¶è°ƒç”¨<code>program.parse(process.argv)</code>æ¥å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼š</p>
<pre><code class="language-javascript">const { program } = require('commander');

program.parse(process.argv);
</code></pre>
<h4 id="æ·»åŠ å‘½ä»¤å’Œé€‰é¡¹">æ·»åŠ å‘½ä»¤å’Œé€‰é¡¹</h4>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ å‘½ä»¤å’Œé€‰é¡¹æ¥å®šåˆ¶æˆ‘ä»¬çš„å‘½ä»¤è¡Œå·¥å…·çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>program.option()</code>æ¥å®šä¹‰é€‰é¡¹ï¼š</p>
<pre><code class="language-javascript">program.option('-f --framework &lt;framework&gt;', 'è®¾ç½®æ¡†æ¶')
</code></pre>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>-f</code>æˆ–<code>--framework</code>çš„é€‰é¡¹ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªæè¿°ã€‚è¿™å°†å…è®¸ç”¨æˆ·åœ¨å‘½ä»¤è¡Œä¸­è®¾ç½®ä¸€ä¸ªæ¡†æ¶å‚æ•°ã€‚</p>
<p><code>program.option('-f --framework &lt;framework&gt;', 'è®¾ç½®æ¡†æ¶')</code> æ˜¯ä½¿ç”¨Commanderåº“å®šä¹‰å‘½ä»¤è¡Œé€‰é¡¹çš„è¯­å¥ã€‚è®©æˆ‘ä»¬è§£é‡Šè¿™è¡Œä»£ç çš„ä½œç”¨ï¼š</p>
<ul>
<li>
<p><code>program.option()</code>ï¼šè¿™æ˜¯Commanderåº“æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå®šä¹‰å‘½ä»¤è¡Œé€‰é¡¹ã€‚</p>
</li>
<li>
<p><code>-f</code> å’Œ <code>--framework</code>ï¼šè¿™ä¸¤ä¸ªéƒ¨åˆ†æ˜¯é€‰é¡¹çš„åç§°ï¼Œå®ƒä»¬ä»¥ä¸¤ç§å½¢å¼å­˜åœ¨ï¼Œä¸€ç§æ˜¯çŸ­æ ¼å¼ï¼ˆå•å­—ç¬¦ï¼Œå‰é¢å¸¦ä¸€ä¸ªçŸ­åˆ’çº¿ <code>-</code>ï¼‰ï¼Œä¸€ç§æ˜¯é•¿æ ¼å¼ï¼ˆå¤šå­—ç¬¦ï¼Œå‰é¢å¸¦ä¸¤ä¸ªçŸ­åˆ’çº¿ <code>--</code>ï¼‰ã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨å…¶ä¸­ä»»ä½•ä¸€ç§å½¢å¼æ¥æŒ‡å®šé€‰é¡¹ã€‚</p>
</li>
<li>
<p><code>&lt;framework&gt;</code>ï¼šè¿™æ˜¯ç”¨å°–æ‹¬å·æ‹¬èµ·æ¥çš„å‚æ•°å ä½ç¬¦ï¼Œè¡¨ç¤ºè¯¥é€‰é¡¹éœ€è¦ä¸€ä¸ªå‚æ•°å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”¨æˆ·éœ€è¦åœ¨é€‰é¡¹åé¢æä¾›ä¸€ä¸ªæ¡†æ¶åç§°ä½œä¸ºå‚æ•°ã€‚</p>
</li>
<li>
<p><code>'è®¾ç½®æ¡†æ¶'</code>ï¼šè¿™æ˜¯é€‰é¡¹çš„æè¿°æ–‡æœ¬ï¼Œç”¨äºå‘ç”¨æˆ·è§£é‡Šé€‰é¡¹çš„ç”¨é€”æˆ–ç›®çš„ã€‚åœ¨å¸®åŠ©ä¿¡æ¯ä¸­ï¼Œè¿™ä¸ªæè¿°æ–‡æœ¬å°†å¸®åŠ©ç”¨æˆ·äº†è§£é€‰é¡¹çš„å«ä¹‰ã€‚</p>
</li>
</ul>
<p>ç»¼åˆèµ·æ¥ï¼Œè¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å®šä¹‰ä¸€ä¸ªåä¸º<code>-f</code>ï¼ˆæˆ–<code>--framework</code>ï¼‰çš„å‘½ä»¤è¡Œé€‰é¡¹ï¼Œè¯¥é€‰é¡¹éœ€è¦ç”¨æˆ·æä¾›ä¸€ä¸ªæ¡†æ¶åç§°ä½œä¸ºå‚æ•°ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¥è®¾ç½®è¿™ä¸ªæ¡†æ¶é€‰é¡¹ï¼Œè€Œæè¿°æ–‡æœ¬ <code>'è®¾ç½®æ¡†æ¶'</code> ä¼šåœ¨å¸®åŠ©ä¿¡æ¯ä¸­æ˜¾ç¤ºï¼Œä»¥å¸®åŠ©ç”¨æˆ·ç†è§£è¿™ä¸ªé€‰é¡¹çš„ç›®çš„ã€‚</p>
<p>ç¤ºä¾‹ç”¨æ³•ï¼š</p>
<pre><code class="language-shell">my-cli --framework react
</code></pre>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>--framework</code>é€‰é¡¹åé¢çš„<code>react</code>æ˜¯ç”¨æˆ·æä¾›çš„å‚æ•°å€¼ï¼Œç”¨æ¥æŒ‡å®šæ‰€é€‰çš„æ¡†æ¶ã€‚</p>
<h4 id="æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯">æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</h4>
<p>ä½¿ç”¨Commanderï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è½»æ¾åœ°ä¸ºæˆ‘ä»¬çš„å‘½ä»¤è¡Œå·¥å…·ç”Ÿæˆå¸®åŠ©ä¿¡æ¯ã€‚åªéœ€åœ¨è„šæœ¬ä¸­è°ƒç”¨<code>program.parse(process.argv)</code>åï¼Œè¿è¡Œæ—¶ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥<code>--help</code>é€‰é¡¹ï¼Œå°†ä¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="language-shell">my-cli --help
</code></pre>
<p>è¿™å°†åœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<pre><code class="language-shell">Usage: my-cli [options]

Options:
  -f --framework &lt;framework&gt;  è®¾ç½®æ¡†æ¶
  -h, --help                 display help for command
</code></pre>
<h4 id="å¤„ç†å‘½ä»¤è¡Œè¾“å…¥">å¤„ç†å‘½ä»¤è¡Œè¾“å…¥</h4>
<p>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€æŸ¥å‘½ä»¤è¡Œè¾“å…¥æ¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰æä¾›<code>-f</code>æˆ–<code>--framework</code>å‚æ•°ï¼ŒCommanderä¼šæç¤ºé”™è¯¯ï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥æ¡†æ¶å‚æ•°ï¼š</p>
<pre><code class="language-shell">my-cli -f
</code></pre>
<p>è¿™å°†å¯¼è‡´ç»ˆç«¯æ˜¾ç¤ºä»¥ä¸‹é”™è¯¯æ¶ˆæ¯ï¼š</p>
<pre><code class="language-shell">error: option '-f --framework &lt;framework&gt;' argument missing
</code></pre>
<p>ç”¨æˆ·å¯ä»¥é€šè¿‡åœ¨<code>-f</code>åé¢è¾“å…¥æ¡†æ¶å‚æ•°æ¥è§£å†³æ­¤é”™è¯¯ï¼Œå¦‚ï¼š</p>
<pre><code class="language-shell">my-cli -f hello
</code></pre>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Commanderè½»æ¾å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Œå¢åŠ å‘½ä»¤å’Œé€‰é¡¹ï¼Œä»¥åŠç”Ÿæˆå¸®åŠ©ä¿¡æ¯ï¼Œä»è€Œæ›´å¥½åœ°æ§åˆ¶å’Œå®šåˆ¶æˆ‘ä»¬çš„å‘½ä»¤è¡Œå·¥å…·çš„è¡Œä¸ºã€‚</p>
<h3 id="å¦‚ä½•å¤„ç†è‡ªå®šä¹‰å‘½ä»¤å‚æ•°">å¦‚ä½•å¤„ç†è‡ªå®šä¹‰å‘½ä»¤å‚æ•°</h3>
<p>åœ¨å‘½ä»¤è¡Œå·¥å…·å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†è‡ªå®šä¹‰çš„å‘½ä»¤å‚æ•°ï¼Œä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•ä½¿ç”¨Node.jså’ŒCommanderåº“æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆ›å»ºä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡è¾“å…¥<code>my-cli create xxx</code>æ¥åˆ›å»ºä¸€ä¸ªé¡¹ç›®ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å°†é€šè¿‡<code>--help</code>å‘½ä»¤è‡ªåŠ¨ç”Ÿæˆå¸®åŠ©ä¿¡æ¯ã€‚</p>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨<code>bin/cli.js</code>ä¸­çš„ä»£ç ï¼š</p>
<pre><code class="language-javascript">#! /usr/bin/env node

const { program } = require('commander');

// å®šä¹‰ä¸€ä¸ªé€‰é¡¹
program.option('-f --framework &lt;framework&gt;', 'è®¾ç½®æ¡†æ¶');

// å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å‘½ä»¤
program
  .command('create &lt;project&gt; [other...]') //å®šä¹‰å‘½ä»¤
  .alias('crt') //è®¾ç½®åˆ«å
  .description('åˆ›å»ºé¡¹ç›®') //å¤‡æ³¨
  .action((project, args) =&gt; { //å›è°ƒå‡½æ•°
    console.log(project);
    console.log(args);
  });

// è§£æå‘½ä»¤è¡Œå‚æ•°
program.parse(process.argv);
</code></pre>
<ul>
<li>
<p>æˆ‘ä»¬é¦–å…ˆå¼•å…¥äº†Commanderåº“ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ªé€‰é¡¹ï¼Œä½¿ç”¨äº†<code>-f</code>ï¼ˆçŸ­æ ¼å¼ï¼‰å’Œ<code>--framework</code>ï¼ˆé•¿æ ¼å¼ï¼‰ï¼Œå…è®¸ç”¨æˆ·è®¾ç½®ä¸€ä¸ªæ¡†æ¶åç§°ä½œä¸ºå‚æ•°ã€‚</p>
</li>
<li>
<p>æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>program.command()</code>å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>create</code>ï¼ˆæˆ–åˆ«å<code>crt</code>ï¼‰çš„è‡ªå®šä¹‰å‘½ä»¤ã€‚è¿™ä¸ªå‘½ä»¤æ¥å—ä¸€ä¸ª<code>project</code>å‚æ•°å’Œå¯é€‰çš„<code>other</code>å‚æ•°ã€‚</p>
</li>
<li>
<p>æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª<code>.action()</code>å›è°ƒå‡½æ•°ï¼Œç”¨äºå¤„ç†å‘½ä»¤çš„å®é™…æ“ä½œã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç®€å•åœ°æ‰“å°äº†<code>project</code>å‚æ•°å’Œ<code>args</code>å‚æ•°ï¼Œä»¥ä¾¿æ¼”ç¤ºå¦‚ä½•è®¿é—®è¿™äº›è‡ªå®šä¹‰å‘½ä»¤å‚æ•°ã€‚</p>
</li>
<li>
<p>æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>program.parse(process.argv)</code>æ¥è§£æå‘½ä»¤è¡Œå‚æ•°ã€‚</p>
</li>
</ul>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•ï¼š</p>
<pre><code class="language-shell">my-cli create myproject otherOptions
</code></pre>
<p>ç»“æœå°†æ˜¯ï¼š</p>
<pre><code class="language-shell">myproject
[ 'otherOptions' ]
</code></pre>
<p>æˆ‘ä»¬æˆåŠŸåœ°æ•è·å’Œå¤„ç†äº†å‘½ä»¤è¡Œå‚æ•°ã€‚</p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œ<code>--help</code>å‘½ä»¤æ¥æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„å¸®åŠ©ä¿¡æ¯ï¼š</p>
<pre><code class="language-shell">my-cli --help
</code></pre>
<p>è¾“å‡ºå†…å®¹ï¼š</p>
<pre><code class="language-shell">Options:
  -f --framwork &lt;framwork&gt;          è®¾ç½®æ¡†æ¶
  -h, --help                        display help for command

Commands:
  create|crt &lt;product&gt; [orther...]  åˆ›å»ºé¡¹ç›®
  help [command]                    display help for command
</code></pre>
<p>ä½ ä¼šå‘ç°ï¼ŒCommanderè‡ªåŠ¨å°†æˆ‘ä»¬çš„è‡ªå®šä¹‰å‘½ä»¤å’Œé€‰é¡¹é›†æˆåˆ°äº†å¸®åŠ©ä¿¡æ¯ä¸­ï¼Œä»¥å¸®åŠ©ç”¨æˆ·äº†è§£å¦‚ä½•æ­£ç¡®ä½¿ç”¨æˆ‘ä»¬çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
<p>é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å­¦åˆ°äº†å¦‚ä½•ä½¿ç”¨Node.jså’ŒCommanderåº“æ¥å¤„ç†è‡ªå®šä¹‰å‘½ä»¤å‚æ•°ï¼Œä»¥åŠå¦‚ä½•ç”Ÿæˆå¸®åŠ©ä¿¡æ¯ï¼Œä½¿æˆ‘ä»¬çš„å‘½ä»¤è¡Œå·¥å…·æ›´åŠ å‹å¥½å’Œæ˜“ç”¨ã€‚</p>
<h3 id="é€»è¾‘ä»£ç æ¨¡å—åŒ–æ‹†åˆ†">é€»è¾‘ä»£ç æ¨¡å—åŒ–æ‹†åˆ†</h3>
<p>åœ¨å¼€å‘å‘½ä»¤è¡Œå·¥å…·æ—¶ï¼Œå°†ä»£ç æ¨¡å—åŒ–æ‹†åˆ†æ˜¯ä¸€ä¸ªè‰¯å¥½çš„å®è·µï¼Œæœ‰åŠ©äºä¿æŒä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å°†æ ¹æ®ä¸åŒçš„åŠŸèƒ½è¿›è¡Œæ‹†åˆ†ï¼Œå¹¶åˆ›å»ºæ¨¡å—åŒ–çš„ä»£ç ç»“æ„ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª<code>lib/core</code>æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä»¥ä¸‹æ¨¡å—ã€‚</p>
<h4 id="1-helpjs-æ¨¡å—">1. <code>help.js</code> æ¨¡å—</h4>
<p>åœ¨<code>lib/core</code>æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª<code>help.js</code>æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-javascript">const setupHelp = (program) =&gt; {
    program.option('-f --framework &lt;framework&gt;', 'è®¾ç½®æ¡†æ¶');
};

module.exports = setupHelp;
</code></pre>
<p>æ­¤æ¨¡å—ç”¨äºé…ç½®å‘½ä»¤è¡Œå·¥å…·çš„å¸®åŠ©é€‰é¡¹ï¼Œå¹¶å°†å…¶å¯¼å‡ºä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨ã€‚</p>
<h4 id="2-mycommanderjs-æ¨¡å—">2. <code>myCommander.js</code> æ¨¡å—</h4>
<p>æ¥ä¸‹æ¥ï¼Œåœ¨<code>lib/core</code>æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª<code>myCommander.js</code>æ–‡ä»¶ï¼š</p>
<pre><code class="language-javascript">const setupMyCommander = (program) =&gt; {
    program.command('create &lt;project&gt; [other...]')
        .alias('crt')
        .description('åˆ›å»ºé¡¹ç›®')
        .action((project, args) =&gt; {
            console.log(project);
            console.log(args);
        });
};

module.exports = setupMyCommander;
</code></pre>
<p>è¿™ä¸ªæ¨¡å—ç”¨äºé…ç½®è‡ªå®šä¹‰å‘½ä»¤ï¼Œå¹¶å°†å…¶å¯¼å‡ºä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨ã€‚</p>
<h4 id="3-actionjs-æ¨¡å—">3. <code>action.js</code> æ¨¡å—</h4>
<p>æœ€åï¼Œåœ¨<code>lib/core</code>æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª<code>action.js</code>æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«å‘½ä»¤çš„å®é™…æ“ä½œé€»è¾‘ï¼š</p>
<pre><code class="language-javascript">const performAction = (project, args) =&gt; {
    console.log(project);
    console.log(args);
};

module.exports = performAction;
</code></pre>
<p>è¿™ä¸ªæ¨¡å—åŒ…å«äº†å®é™…æ“ä½œçš„ä»£ç ï¼Œå¹¶å°†å…¶å¯¼å‡ºä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬åœ¨ <code>/bin/cli.js</code> ä¸­å¼•å…¥è¿™äº›æ¨¡å—ï¼Œå¹¶å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ï¼š</p>
<pre><code class="language-javascript">#! /usr/bin/env node
const { program } = require('commander');

// å¯¼å…¥æ¨¡å—
const setupHelp = require('../lib/core/help');
const setupMyCommander = require('../lib/core/myCommander');
const performAction = require('../lib/core/action');

// é…ç½®å¸®åŠ©é€‰é¡¹
setupHelp(program);

// é…ç½®è‡ªå®šä¹‰å‘½ä»¤
setupMyCommander(program);

// è®¾ç½®å‘½ä»¤çš„å®é™…æ“ä½œ
program.action(performAction);

// è§£æå‘½ä»¤è¡Œå‚æ•°
program.parse(process.argv);
</code></pre>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å°†ä»£ç é€»è¾‘æ¨¡å—åŒ–æ‹†åˆ†ï¼Œä½¿å…¶æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚åŒæ—¶ï¼Œä¹Ÿæä¾›äº†æ›´å¥½çš„å¯æ‰©å±•æ€§ï¼Œä»¥ä¾¿å°†æ¥æ·»åŠ æ›´å¤šåŠŸèƒ½æˆ–å‘½ä»¤æ—¶èƒ½å¤Ÿæ›´è½»æ¾åœ°æ‰©å±•æˆ‘ä»¬çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
<h3 id="å‘½ä»¤è¡Œäº¤äº’é—®ç­”å·¥å…·-inquirer">å‘½ä»¤è¡Œäº¤äº’é—®ç­”å·¥å…·: Inquirer</h3>
<p>é€šå¸¸ï¼Œåœ¨å‘½ä»¤è¡Œä¸­éœ€è¦ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’å¼çš„æ“ä½œï¼Œæ¯”å¦‚è¯¢é—®ç”¨æˆ·ä¸€äº›é—®é¢˜ï¼Œè·å–è¾“å…¥ç­‰ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://www.npmjs.com/package/inquirer">Inquirer</a> åº“æ¥æ–¹ä¾¿åœ°å®ç°è¿™äº›åŠŸèƒ½ã€‚</p>
<h4 id="å®‰è£…-inquirer">å®‰è£… Inquirer</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… Inquirer åº“ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p>
<pre><code class="language-shell">npm install --save inquirer@^8.0.0
</code></pre>
<h4 id="ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</h4>
<p>å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª <code>/test/inquirer.js</code> æ–‡ä»¶æ¥æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<pre><code class="language-javascript">const inquirer = require('inquirer');

inquirer.prompt([
    {
        type: 'input',
        name: 'username',
        message: 'ä½ çš„åå­—',
    }
]).then(res =&gt; {
    console.log(res);
});
</code></pre>
<p>åœ¨å½“å‰æ–‡ä»¶å¤¹å†…è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="language-shell">node inquirer.js
</code></pre>
<p>è¿™å°†æç¤ºä½ è¾“å…¥åå­—ï¼Œç„¶åæ‰“å°å‡ºä½ è¾“å…¥çš„å†…å®¹ï¼š</p>
<pre><code class="language-shell">{ username: '11' }
</code></pre>
<h4 id="åˆ›å»ºä¸€ä¸ªäº¤äº’å¼å‘½ä»¤">åˆ›å»ºä¸€ä¸ªäº¤äº’å¼å‘½ä»¤</h4>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ”¹é€ ä¹‹å‰çš„ <code>create</code> å‘½ä»¤ã€‚</p>
<p>æ‰“å¼€ <code>/lib/core/action.js</code> æ–‡ä»¶ï¼Œå¼•å…¥ <code>inquirer</code>ï¼ŒåŒæ—¶åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º <code>/config.js</code> ç”¨äºä¿å­˜ä¸€äº›é…ç½®é¡¹ï¼š</p>
<pre><code class="language-javascript">/** action.js */
const inquirer = require('inquirer');
const config = require('../../config');

const myAction = (project, args) =&gt; {
    inquirer.prompt([
        {
            type: 'list',
            name: 'framework',
            message: 'è¯·é€‰æ‹©ä½ ä½¿ç”¨çš„æ¡†æ¶',
            choices: config.framework,
        }
    ]).then(res =&gt; {
        console.log(res);
    });
}

module.exports = myAction;
</code></pre>
<p><code>config.js</code> æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-javascript">module.exports = {
    framework: ['egg', 'koa', 'express']
}
</code></pre>
<p>ç„¶ååœ¨ <code>/bin/cli.js</code> æ–‡ä»¶ä¸­å¼•å…¥å¹¶ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼š</p>
<pre><code class="language-javascript">const { program } = require('commander');

const setupHelp = require('../lib/core/help');
const setupMyCommander = require('../lib/core/myCommander');
const performAction = require('../lib/core/action');

setupHelp(program);
setupMyCommander(program);

program.action(performAction);

program.parse(process.argv);
</code></pre>
<p>ç°åœ¨ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="language-shell">my-cli create nodetest
</code></pre>
<p>å°†ä¼šåœ¨æ§åˆ¶å°ä¸­å‡ºç°ä¸€ä¸ªé€‰é¡¹ä¾›ä½ é€‰æ‹©ï¼Œé€‰æ‹©å®Œæˆåå›è½¦ï¼Œä½ å°†å¾—åˆ°ä½ é€‰æ‹©çš„å€¼ï¼š</p>
<pre><code class="language-shell">? è¯·é€‰æ‹©ä½ ä½¿ç”¨çš„æ¡†æ¶ koa
{ framework: 'koa' }
</code></pre>
<p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ Inquirer å®ç°äº†ä¸€ä¸ªäº¤äº’å¼å‘½ä»¤ï¼Œä½¿æˆ‘ä»¬çš„å‘½ä»¤è¡Œå·¥å…·æ›´åŠ çµæ´»å’Œå‹å¥½ã€‚</p>
<blockquote>
<p>å½“ä½¿ç”¨<code>inquirer.prompt()</code>æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œä»¥å®šåˆ¶äº¤äº’å¼çš„æç¤ºã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„é…ç½®é¡¹åŠå…¶è¯´æ˜ï¼š</p>
</blockquote>
<ol>
<li>
<p><code>type</code>ï¼ˆç±»å‹ï¼‰: å®šä¹‰äº†ç”¨æˆ·äº¤äº’çš„ç±»å‹ã€‚å¸¸ç”¨çš„ç±»å‹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>input</code>: æ¥æ”¶ç”¨æˆ·çš„æ–‡æœ¬è¾“å…¥ã€‚</li>
<li><code>list</code>: æä¾›ä¸€ä¸ªåˆ—è¡¨ä¾›ç”¨æˆ·é€‰æ‹©ã€‚</li>
<li><code>checkbox</code>: æä¾›ä¸€ä¸ªå¤šé€‰æ¡†åˆ—è¡¨ä¾›ç”¨æˆ·é€‰æ‹©ã€‚</li>
<li><code>confirm</code>: æä¾›ä¸€ä¸ªæ˜¯/å¦ çš„ç¡®è®¤é€‰æ‹©ã€‚</li>
</ul>
</li>
<li>
<p><code>name</code>ï¼ˆåç§°ï¼‰: å®šä¹‰äº†äº¤äº’ç»“æœåœ¨è¿”å›çš„å¯¹è±¡ä¸­çš„é”®åã€‚</p>
</li>
<li>
<p><code>message</code>ï¼ˆæ¶ˆæ¯ï¼‰: æ˜¾ç¤ºç»™ç”¨æˆ·çš„é—®é¢˜æˆ–æç¤ºä¿¡æ¯ã€‚</p>
</li>
<li>
<p><code>default</code>ï¼ˆé»˜è®¤å€¼ï¼‰: è®¾å®šä¸€ä¸ªé»˜è®¤å€¼ï¼Œå¦‚æœç”¨æˆ·ç›´æ¥æŒ‰ä¸‹å›è½¦ï¼Œåˆ™ä½¿ç”¨è¯¥å€¼ã€‚</p>
</li>
<li>
<p><code>choices</code>ï¼ˆé€‰é¡¹ï¼‰: ç”¨äº<code>list</code>å’Œ<code>checkbox</code>ç±»å‹çš„äº¤äº’ï¼Œæä¾›å¯ä¾›é€‰æ‹©çš„é€‰é¡¹ã€‚</p>
</li>
<li>
<p><code>validate</code>ï¼ˆéªŒè¯ï¼‰: å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºéªŒè¯ç”¨æˆ·çš„è¾“å…¥ï¼Œè¿”å› <code>true</code> è¡¨ç¤ºåˆæ³•ï¼Œè¿”å›é”™è¯¯æ¶ˆæ¯å­—ç¬¦ä¸²è¡¨ç¤ºéæ³•ã€‚</p>
</li>
<li>
<p><code>filter</code>ï¼ˆè¿‡æ»¤ï¼‰: å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œå¤„ç†ï¼Œè¿”å›å¤„ç†åçš„å€¼ã€‚</p>
</li>
<li>
<p><code>when</code>ï¼ˆæ¡ä»¶ï¼‰: å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ ¹æ®å‰ä¸€ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ¥ç¡®å®šæ˜¯å¦éœ€è¦æ˜¾ç¤ºå½“å‰é—®é¢˜ã€‚</p>
</li>
<li>
<p><code>pageSize</code>ï¼ˆåˆ†é¡µå¤§å°ï¼‰: ç”¨äº<code>list</code>ç±»å‹çš„äº¤äº’ï¼Œè®¾ç½®æ˜¾ç¤ºçš„é€‰é¡¹æ•°é‡ã€‚</p>
</li>
<li>
<p><code>prefix</code>ï¼ˆå‰ç¼€ï¼‰: åœ¨é—®é¢˜æ˜¾ç¤ºå‰ï¼Œå¯æ·»åŠ ä¸€ä¸ªå‰ç¼€ã€‚</p>
</li>
<li>
<p><code>suffix</code>ï¼ˆåç¼€ï¼‰: åœ¨é—®é¢˜æ˜¾ç¤ºåï¼Œå¯æ·»åŠ ä¸€ä¸ªåç¼€ã€‚</p>
</li>
<li>
<p><code>transformer</code>ï¼ˆè½¬æ¢å™¨ï¼‰: ç”¨äºå¯¹ç”¨æˆ·è¾“å…¥å’Œäº¤äº’ç»“æœçš„è¿›ä¸€æ­¥å¤„ç†ã€‚</p>
</li>
<li>
<p><code>loop</code>ï¼ˆå¾ªç¯ï¼‰: å½“<code>type</code>ä¸º<code>list</code>æ—¶ï¼Œé€‰æ‹©åˆ°æœ€åä¸€ä¸ªé€‰é¡¹ä¼šå›åˆ°ç¬¬ä¸€ä¸ªé€‰é¡¹ã€‚</p>
</li>
<li>
<p><code>validate</code>ï¼ˆéªŒè¯ï¼‰: å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡ŒéªŒè¯ã€‚</p>
</li>
<li>
<p><code>default</code>ï¼ˆé»˜è®¤å€¼ï¼‰: è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå¦‚æœç”¨æˆ·ç›´æ¥æŒ‰ä¸‹å›è½¦ï¼Œåˆ™ä½¿ç”¨è¯¥å€¼ã€‚</p>
</li>
</ol>
<p>è¿™äº›å‚æ•°å¯ä»¥æ ¹æ®éœ€æ±‚ç»„åˆä½¿ç”¨ï¼Œä»¥å®ç°ä¸°å¯Œçš„äº¤äº’ä½“éªŒã€‚</p>
<p>ç¤ºä¾‹:</p>
<pre><code class="language-javascript">inquirer.prompt([
    {
        type: 'input',
        name: 'username',
        message: 'è¯·è¾“å…¥ä½ çš„åå­—',
        default: 'John Doe', // é»˜è®¤å€¼
        validate: function (value) {
            if (value.length) {
                return true; // è¾“å…¥åˆæ³•
            }
            return 'è¯·è¾“å…¥ä½ çš„åå­—'; // è¾“å…¥éæ³•æ—¶çš„é”™è¯¯æ¶ˆæ¯
        }
    },
    {
        type: 'list',
        name: 'color',
        message: 'é€‰æ‹©ä¸€ç§é¢œè‰²',
        choices: ['Red', 'Green', 'Blue'], // æä¾›çš„é€‰é¡¹
        pageSize: 5 // åˆ†é¡µå¤§å°
    },
    // ...
]).then(answers =&gt; {
    console.log(answers);
});
</code></pre>
<h3 id="å¦‚ä½•ä¸‹è½½è¿œç¨‹é¡¹ç›®ä»£ç ">å¦‚ä½•ä¸‹è½½è¿œç¨‹é¡¹ç›®ä»£ç </h3>
<p><a href="https://www.npmjs.com/package/download-git-repo">download-git-repo</a>æ˜¯ä¸€ä¸ªç”¨äºä» Git ä»“åº“ä¸‹è½½ä»£ç çš„ Node.js æ¨¡å—ã€‚å®ƒå¯ä»¥å°†è¿œç¨‹ä»“åº“ä¸­çš„ä»£ç ä¸‹è½½åˆ°æœ¬åœ°çš„æ–‡ä»¶å¤¹ä¸­ã€‚</p>
<h4 id="å®‰è£…æ’ä»¶">å®‰è£…æ’ä»¶ï¼š</h4>
<pre><code class="language-shell">npm install download-git-repo
</code></pre>
<h4 id="ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</h4>
<p>é¦–å…ˆï¼Œåœ¨æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ <code>/config.js</code> æ–‡ä»¶ä¸­æ·»åŠ äº†è¿œç¨‹é¡¹ç›®çš„ä»“åº“åœ°å€ï¼š</p>
<pre><code class="language-js">module.exports = {
    framwork: ['egg', 'koa', 'express'],
    framworkUrl: {
        'egg': 'https://github.com/LonJinUp/lonjin-helper',
        'koa': 'https://github.com/LonJinUp/wxTabBar',
        'express': 'https://github.com/LonJinUp/vue-prettier-plugin'
    }
}
</code></pre>
<p>æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºäº† <code>/lib/core/download.js</code> æ–‡ä»¶ï¼Œå¼•å…¥äº† <code>download-git-repo</code> å¹¶å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ï¼š</p>
<pre><code class="language-js">const download = require('download-git-repo')
const downFramwork = (url, project) =&gt; {
    download(`direct:${url}`, project, { clone: true }, (error) =&gt; {
        console.log(error)
    })
}

module.exports = downFramwork
</code></pre>
<blockquote>
<p>å…³äº<code>download-git-repo</code>ä¸­<code>download</code>å‚æ•°è¯¦ç»†è§£é‡Šå¦‚ä¸‹ï¼š</p>
</blockquote>
<pre><code class="language-javascript">download(repository, destination, options, callback)
</code></pre>
<ul>
<li>
<p><code>repository</code>: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤º Git ä»“åº“çš„åœ°å€ã€‚å¯ä»¥æ˜¯ HTTPS æˆ–è€… SSH å½¢å¼çš„ Git ä»“åº“åœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯ GitHubã€GitLab æˆ–è€… Bitbucket ç­‰æ‰˜ç®¡æœåŠ¡çš„åœ°å€ã€‚</p>
</li>
<li>
<p><code>destination</code>: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºç›®æ ‡æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œä»£ç å°†ä¼šä¸‹è½½åˆ°è¯¥æ–‡ä»¶å¤¹ä¸­ã€‚</p>
</li>
<li>
<p><code>options</code>: ä¸€ä¸ªåŒ…å«é…ç½®é€‰é¡¹çš„å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥å®šåˆ¶ä¸‹è½½çš„è¡Œä¸ºã€‚å¸¸ç”¨é€‰é¡¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>
<p><code>clone</code>: ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦ä½¿ç”¨ Git çš„å…‹éš†åŠŸèƒ½ï¼Œé»˜è®¤ä¸º <code>false</code>ã€‚å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œå°†ä¼šä½¿ç”¨ Git å…‹éš†æ•´ä¸ªä»“åº“ï¼Œå¦åˆ™å°†ä¼šç›´æ¥ä¸‹è½½ ZIP å½’æ¡£æ–‡ä»¶ï¼ˆé€Ÿåº¦æ›´å¿«ï¼Œä½†ä¸æ”¯æŒç§æœ‰ä»“åº“ï¼‰ã€‚</p>
</li>
<li>
<p><code>checkout</code>: ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºåœ¨ä¸‹è½½åå°†ä¼šæ£€å‡ºçš„åˆ†æ”¯æˆ–æ ‡ç­¾åã€‚</p>
</li>
<li>
<p><code>depth</code>: ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤º Git å…‹éš†æ—¶çš„æ·±åº¦ï¼ˆå³å†å²è®°å½•çš„æ•°é‡ï¼‰ï¼Œé»˜è®¤ä¸º <code>undefined</code>ï¼Œè¡¨ç¤ºå…‹éš†å®Œæ•´çš„å†å²è®°å½•ã€‚</p>
</li>
</ul>
</li>
<li>
<p><code>callback</code>: ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“ä¸‹è½½å®Œæˆæ—¶ä¼šè°ƒç”¨è¯¥å‡½æ•°ï¼Œå¯ä»¥è·å–åˆ°é”™è¯¯ä¿¡æ¯ã€‚</p>
</li>
</ul>
<p>æœ€åï¼Œæˆ‘ä»¬å›åˆ°äº† <code>/lib/core/action.js</code> ä¸­ï¼Œå¯¼å…¥äº†æˆ‘ä»¬ç¼–å†™å¥½çš„å‡½æ•°ï¼Œå¹¶åšäº†ä¸€äº›è°ƒæ•´ã€‚æˆ‘ä»¬ä¹Ÿå°†ä¹‹å‰çš„ <code>inquirer</code> æ”¹æˆäº† <code>await</code> çš„å†™æ³•ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</p>
<pre><code class="language-js">const inquirer = require('inquirer')
const config = require('../../config')
const download = require('./download')

const myAction = async (project, args) =&gt; {
    const answer = await inquirer.prompt([
        {
            type: 'list',
            name: 'framework',
            message: 'è¯·é€‰æ‹©ä½ ä½¿ç”¨çš„æ¡†æ¶',
            choices: config.framework
        }
    ])
    // ä¸‹è½½æ¨¡æ¿
    download(config.frameworkUrl[answer.framework], project)
}

module.exports = myAction
</code></pre>
<p>æœ€åï¼Œæˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="language-shell">my-cli create text-download-1 
</code></pre>
<p>ç„¶åæ ¹æ®ä½ çš„é€‰æ‹©ï¼Œä¼šä¸‹è½½ç›¸åº”çš„è¿œç¨‹ä»£ç ï¼Œå¹¶ä¸”æ–‡ä»¶å¤¹çš„åç§°å°†ä¸ <code>create</code> å‘½ä»¤åé¢çš„å‚æ•°ä¸€è‡´ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ vue2é¡¹ç›®å¦‚ä½•åœ¨è¿è¡Œæ—¶é€šè¿‡prettieræ ¼å¼åŒ–ä»£ç ]]></title>
        <id>https://lonjinup.github.io/vue-prettier-plugin/</id>
        <link href="https://lonjinup.github.io/vue-prettier-plugin/">
        </link>
        <updated>2023-08-17T13:54:43.000Z</updated>
        <content type="html"><![CDATA[<h1 id="vue2é¡¹ç›®å¦‚ä½•åœ¨è¿è¡Œæ—¶é€šè¿‡prettieræ ¼å¼åŒ–ä»£ç ">vue2é¡¹ç›®å¦‚ä½•åœ¨è¿è¡Œæ—¶é€šè¿‡prettieræ ¼å¼åŒ–ä»£ç </h1>
<blockquote>
<p>ä»Šå¤©é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œè€vue2é¡¹ç›®ç”±äºä¹‹å‰æ²¡æœ‰ä½¿ç”¨<code>eslint</code>å’Œ<code>prettier</code>è¿›è¡Œä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–ï¼Œéšç€å¼€å‘äººå‘˜å¢åŠ ï¼Œæ¯ä¸ªå¼€å‘äººå‘˜ä½¿ç”¨çš„ç¼–è¾‘å™¨ä¸åŒã€æ ¼å¼åŒ–æ’ä»¶ä¸åŒï¼Œæäº¤ä»£ç æ—¶å€™è€ä¼šå†²çªï¼Œè°ƒç ”äº†å‡ ä¸ªæ–¹æ¡ˆï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
</blockquote>
<ol>
<li>å›¢é˜Ÿç»Ÿä¸€ä½¿ç”¨<code>vscode</code>ï¼Œæ·»åŠ <code>vscode</code>ä¸­çš„<code>prettier</code>æ’ä»¶ï¼Œæ·»åŠ <code>.vscode</code>æ–‡ä»¶å¤¹ï¼Œç»Ÿä¸€è®¾ç½®é…ç½®æ–‡ä»¶ã€‚</li>
<li>é¡¹ç›®å®‰è£…<code>perttier</code>ï¼Œæäº¤ä»£ç å‰é€šè¿‡å‘½ä»¤è¿›è¡Œä»£ç æ ¼å¼åŒ–ã€‚</li>
<li>é¡¹ç›®å®‰è£…<code>perttier</code>ï¼ŒåŒæ—¶ä½¿ç”¨<code>vscode</code>ä¸­çš„<code>prettier</code>æ’ä»¶ï¼Œè¿è¡Œæ—¶ä¹Ÿå¯ä»¥è¿›è¡Œæ ¼å¼åŒ–ã€‚</li>
<li>é¡¹ç›®å®‰è£…<code>perttier</code>å’Œ<code>eslint</code>ï¼Œé…åˆ<code>vscode</code>ä¸­çš„ä¸¤ä¸ªæ’ä»¶è¿›è¡Œå¤„ç†ã€‚</li>
</ol>
<p>æ–¹æ¡ˆ1å’Œæ–¹æ¡ˆ3æ¯”è¾ƒä¾èµ–ç¼–è¾‘å™¨ï¼Œå¦‚æœå¼€å‘äººå‘˜ä¸ç”¨<code>vscode</code>è¿›è¡Œå¼€å‘ï¼Œé‚£ä¹ˆå°±æ— æ³•è¿›è¡Œæ ¼å¼åŒ–ï¼›æ–¹æ¡ˆ2æ¯æ¬¡æäº¤ä¹‹å‰éƒ½éœ€è¦è¿è¡Œå‘½ä»¤ï¼Œä¸å¤Ÿæ–¹ä¾¿ï¼›æ–¹æ¡ˆ4ä¹Ÿæ¯”è¾ƒä¾èµ–ç¼–è¾‘å™¨ï¼Œè€Œä¸”å¦‚æœä½¿ç”¨<code>eslint</code>ï¼Œä¹‹å‰çš„ä»£ç è‚¯éœ€è¦è¿›è¡Œä¸€äº›å¤„ç†ï¼Œæˆ–è€…æŠŠå¤§éƒ¨åˆ†<code>eslint</code>è§„åˆ™å…³é—­ï¼Œä¸å¤Ÿçµæ´»ï¼Œä¸”æŠ˜è…¾ä¸‹æ¥æ¯”è¾ƒè€—æ—¶ã€‚</p>
<p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ¡ˆï¼Œé…ç½®ç®€å•ï¼Œä¸”ä¸ä¾èµ–ç¼–è¾‘å™¨ä¸Šçš„æ’ä»¶ï¼Œåœ¨è¿è¡Œæ—¶åªè¦ä¿å­˜ä»£ç å³å¯è¿›è¡Œæ ¼å¼åŒ–å‘¢ï¼Ÿ</p>
<h2 id="vue-prettier-plugin">vue-prettier-plugin</h2>
<p>åœ¨é¡¹ç›®åˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸä¸­å¯åŠ¨æ’ä»¶ï¼Œä½¿ç”¨<code>chokidar</code>å¯¹æ•´ä¸ªç›®å½•çš„æ–‡ä»¶è¿›è¡Œç›‘å¬ï¼Œå‘ç°æ–‡ä»¶æœ‰å˜åŒ–å°±ä½¿ç”¨<code>prettier</code>è¿›è¡Œæ ¼å¼åè¿›è¡Œè¦†ç›–ä¿å­˜ã€‚</p>
<p>å®‰è£…æ’ä»¶</p>
<pre><code class="language-shell">npm install vue-prettier-plugin --save-dev
</code></pre>
<p>åœ¨<code>vue.config.js</code>æˆ–<code>webpack.js</code>ä¸­å¼•å…¥æ’ä»¶ï¼Œå¹¶åˆå§‹åŒ–ï¼š</p>
<pre><code class="language-js">const VuePrettierPlugin = require('vue-prettier-plugin')
module.exports = {
  // ...å…¶ä»–é…ç½®
  configureWebpack: {
    plugins: [
      new VuePrettierPlugin(
        {
          // Prettier æ ¼å¼åŒ–é€‰é¡¹
          printWidth: 100,
          tabWidth: 4,
          // ...å…¶ä»–é€‰é¡¹
        },
        'src/',//æ ¼å¼åŒ–æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤ src/
      ),
    ],
  },
};
</code></pre>
<p>è¿è¡Œé¡¹ç›®ï¼Œå¦‚æœä»£ç æœ‰æ›´æ”¹ï¼Œæ’ä»¶å°±ä¼šæ ¹æ®é…ç½®é¡¹è‡ªåŠ¨æ ¼å¼åŒ–æ–‡ä»¶ã€‚</p>
<h2 id="ç»“å°¾">ç»“å°¾</h2>
<p>é€šè¿‡è¿™ä¸ªæ’ä»¶ï¼Œæˆ‘ä»¬å³å¯ä¸ä¾èµ–ç¼–è¾‘å™¨ã€åœ¨è¿è¡Œæ—¶ä¿®æ”¹æ–‡ä»¶å³å¯è¿›è¡Œæ ¼å¼åŒ–ä»£ç ã€‚</p>
<p>æ’ä»¶<code>npm</code>åœ°å€ï¼š <a href="https://www.npmjs.com/package/vue-prettier-plugin?activeTab=readme">vue-prettier-plugin</a><br>
æ’ä»¶<code>github</code>åœ°å€ï¼š <a href="https://github.com/LonJinUp/vue-prettier-plugin">vue-prettier-plugin</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¦‚ä½•å°è£…ä¼˜é›…ã€é«˜æ•ˆçš„uni-appè¯·æ±‚ï¼šè®©å¼€å‘æ›´è½»æ¾]]></title>
        <id>https://lonjinup.github.io/uni-request/</id>
        <link href="https://lonjinup.github.io/uni-request/">
        </link>
        <updated>2023-07-25T07:14:41.000Z</updated>
        <content type="html"><![CDATA[<p>#å°è£…ä¼˜é›…ã€é«˜æ•ˆçš„uni-appè¯·æ±‚ï¼šè®©å¼€å‘æ›´è½»æ¾</p>
<blockquote>
<p>å¤§å®¶å¥½ï¼Œä»Šå¤©æˆ‘æƒ³åˆ†äº«ä¸€äº›å…³äºuni-appå¼€å‘ä¸­å°è£…é«˜æ•ˆã€ä¼˜é›…çš„requestè¯·æ±‚çš„ç»éªŒã€‚ä¹‹å‰æˆ‘åœ¨<a href="https://lonjinup.github.io/uni-app-template-01/">uni-appå¼€å‘å°ç¨‹åºï¼šé¡¹ç›®æ¶æ„ä»¥åŠç»éªŒåˆ†äº«<br>
</a>çš„æ–‡ç« ä¸­ï¼Œå·²ç»åˆ†äº«äº†ä¸€äº›æœ‰ç”¨çš„ç»éªŒæŠ€å·§ï¼ŒåŒ…æ‹¬äºŒæ¬¡å°è£…uni-appçš„APIã€‚ä¸‹é¢æˆ‘å°†è¯¦ç»†ä»‹ç»å¦‚ä½•å°è£…ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“ç”¨çš„requestè¯·æ±‚ï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹ä½ çš„å¼€å‘å·¥ä½œæœ‰æ‰€å¸®åŠ©ã€‚</p>
</blockquote>
<h2 id="ä¸ºä»€ä¹ˆéœ€è¦å°è£…requestè¯·æ±‚">ä¸ºä»€ä¹ˆéœ€è¦å°è£…requestè¯·æ±‚ï¼Ÿ</h2>
<p>åœ¨uni-appå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä¸åç«¯æœåŠ¡å™¨è¿›è¡Œæ•°æ®äº¤äº’ã€‚ä¸ºäº†æé«˜å¼€å‘æ•ˆç‡ã€ä»£ç çš„å¯ç»´æŠ¤æ€§ä»¥åŠé™ä½é‡å¤ä»£ç çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œå°è£…ã€‚</p>
<p>å°è£…requestè¯·æ±‚çš„å¥½å¤„æœ‰å¾ˆå¤šï¼š</p>
<ul>
<li>ç®€åŒ–ä»£ç ï¼šå°†ä¸€äº›é‡å¤æ€§çš„è¯·æ±‚å¤„ç†é€»è¾‘æŠ½ç¦»å‡ºæ¥ï¼Œä½¿å¾—ä¸šåŠ¡ä»£ç æ›´åŠ æ¸…æ™°ç®€æ´ï¼Œæ˜“äºé˜…è¯»å’Œç»´æŠ¤ã€‚</li>
<li>æ˜“äºç®¡ç†ï¼šç»Ÿä¸€ç®¡ç†æ¥å£åœ°å€ã€é”™è¯¯å¤„ç†å’Œè¯·æ±‚æ‹¦æˆªï¼Œæ–¹ä¾¿åæœŸç»´æŠ¤å’Œæ›´æ–°ã€‚<br>
å¢å¼ºå¯æ‰©å±•æ€§ï¼šå¦‚æœåç«¯æ¥å£å‘ç”Ÿå˜åŒ–ï¼Œåªéœ€è¦ä¿®æ”¹è¯·æ±‚å°è£…çš„éƒ¨åˆ†è€Œä¸å½±å“ä¸šåŠ¡ä»£ç ã€‚</li>
<li>æ”¯æŒ asyncã€awaitï¼Œä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œç®€æ´æ€§ã€‚</li>
<li>åœ¨è¯·æ±‚åº“ä¸­å®ç°å…¨å±€çš„ loading åŠŸèƒ½ï¼Œè®©ç”¨æˆ·åœ¨å‘é€è¯·æ±‚æ—¶èƒ½å¤Ÿçœ‹åˆ°åŠ è½½åŠ¨ç”»ï¼Œå¢å¼ºç”¨æˆ·ä½“éªŒã€‚</li>
<li>ç»Ÿä¸€å¤„ç†è¯·æ±‚é”™è¯¯ï¼Œä¾‹å¦‚ç½‘ç»œè¿æ¥å¤±è´¥æ—¶ï¼Œç»™äºˆç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤ºï¼Œæé«˜ç”¨æˆ·æ»¡æ„åº¦ã€‚</li>
<li>è€ƒè™‘å®ç°å¤šç§è¯·æ±‚æ–¹å¼ï¼ŒåŒ…æ‹¬ GETã€POSTã€PUT ç­‰ï¼Œä»¥æ»¡è¶³ä¸åŒåœºæ™¯ä¸‹çš„éœ€æ±‚ã€‚</li>
<li>ä¸ºäº†é¿å…é‡å¤è¯·æ±‚ï¼Œå¯ä»¥å®ç°è¯·æ±‚æ‹¦æˆªåŠŸèƒ½ï¼Œåœ¨è¯·æ±‚å‘é€å‰åˆ¤æ–­æ˜¯å¦å·²ç»åœ¨è¿›è¡Œç›¸åŒçš„è¯·æ±‚ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å–æ¶ˆé‡å¤è¯·æ±‚ã€‚</li>
</ul>
<p>å…ˆä¸Šä¸€ä¸‹æœ€ç»ˆçš„ä½¿ç”¨æ–¹å¼ï¼š</p>
<p>api.js</p>
<pre><code class="language-js">// å¼•å…¥è¯·æ±‚
import request from '@/utils/request'

//æ¥å£ç¤ºä¾‹
export const info = data =&gt; request.post('/v1/api/info', data)
</code></pre>
<p>é¡µé¢ä¸­ä½¿ç”¨</p>
<pre><code class="language-js">&lt;script&gt;
import { info } from '@/api/user.js'
export default {
	methods: {
		async getUserinfo() {
			let res = await info()
		}
	}
}
&lt;/script&gt;
</code></pre>
<h2 id="coding">coding</h2>
<h3 id="1åˆ›å»ºåŸºç¡€è¯·æ±‚">1.åˆ›å»ºåŸºç¡€è¯·æ±‚</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥äº†ä¸€äº›å…¬å…±æ–¹æ³•ï¼Œæ¯”å¦‚<code>toast</code>ç”¨äºæ˜¾ç¤ºæç¤ºä¿¡æ¯ï¼Œ<code>clearStorageSync</code>å’Œ<code>getStorageSync</code>ç”¨äºæ“ä½œæœ¬åœ°ç¼“å­˜ï¼Œè¿˜æœ‰<code>useRouter</code>ç”¨äºè·³è½¬é¡µé¢ç­‰ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>baseRequest</code>çš„å¼‚æ­¥å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶å››ä¸ªå‚æ•°ï¼š<code>url</code>è¡¨ç¤ºè¯·æ±‚çš„åœ°å€ï¼Œ<code>method</code>è¡¨ç¤ºè¯·æ±‚æ–¹æ³•ï¼Œé»˜è®¤<code>GET</code>è¯·æ±‚ï¼Œ<code>data</code>è¡¨ç¤ºè¦å‘é€çš„æ•°æ®ï¼Œé»˜è®¤ä¸ºç©ºå¯¹è±¡ï¼Œ<code>loading</code>è¡¨ç¤ºæ˜¯å¦æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼Œé»˜è®¤ä¸º<code>true</code>ã€‚</p>
<p>åœ¨å‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œç”¨äºæ”¯æŒ<code>async</code> ã€<code>await</code>è°ƒç”¨ã€‚</p>
<p>åœ¨å¼‚æ­¥è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>uni.request</code>æ–¹æ³•å‘é€è¯·æ±‚ã€‚æˆ‘ä»¬åœ¨è¯·æ±‚ä¸­ä¼ å…¥äº†è¯·æ±‚åœ°å€ã€è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚å¤´ã€æ•°æ®ã€å’Œè¶…æ—¶æ—¶é—´ç­‰ä¿¡æ¯ã€‚</p>
<p>å¦‚æœè¯·æ±‚æˆåŠŸï¼Œå¹¶ä¸”çŠ¶æ€ç ä¸º<code>200</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šå¤„ç†è¿”å›çš„æ•°æ®ã€‚è¿™é‡Œçš„å¤„ç†é€»è¾‘å¯ä»¥æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚æ¥ä¿®æ”¹ã€‚å¦‚æœè¿”å›çš„<code>resultCode</code>ä¸º<code>PA-G998</code>(ä¸šåŠ¡é€»è¾‘)ï¼Œè¡¨ç¤ºç”¨æˆ·æœªç™»å½•æˆ–ç™»å½•è¿‡æœŸï¼Œæˆ‘ä»¬ä¼šæ¸…é™¤æœ¬åœ°ç¼“å­˜å¹¶è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬ä¼šå°†è¯·æ±‚æˆåŠŸè¿”å›çš„æ•°æ®ä¼ é€’ç»™Promiseå¯¹è±¡çš„resloveæ–¹æ³•ã€‚</p>
<p>å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œæˆ‘ä»¬ä¼šæ˜¾ç¤ºç½‘ç»œè¿æ¥å¤±è´¥çš„æç¤ºï¼Œå¹¶å°†é”™è¯¯ä¿¡æ¯ä¼ é€’ç»™<code>Promise</code>å¯¹è±¡çš„<code>reject</code>æ–¹æ³•ã€‚</p>
<pre><code class="language-js">import {toast, clearStorageSync, getStorageSync, useRouter} from './utils' // å…¬å…±æ–¹æ³•
import {BASE_URL} from '@/config/index' //è·å–è¯·æ±‚åŸŸå

const baseRequest = async (url, method, data = {}, loading = true) =&gt;{
	let header = {}
	return new Promise((reslove, reject) =&gt; {
		uni.request({
			url: BASE_URL + url,
			method: method || 'GET',
			header: header,
			timeout: 10000,
			data: data || {},
			success: (successData) =&gt; {
				const res = successData.data
				if(successData.statusCode == 200){
					// ä¸šåŠ¡é€»è¾‘ï¼Œè‡ªè¡Œä¿®æ”¹
					if(res.resultCode == 'PA-G998'){
						clearStorageSync()
						useRouter('/pages/login/index', 'reLaunch')
					}else{
						reslove(res.data)
					}
				}else{
					toast('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
					reject(res)
				}
			},
			fail: (msg) =&gt; {
				toast('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
				reject(msg)
			}
		})
	})
}
</code></pre>
<h3 id="2ç®€åŒ–å…¥å‚">2.ç®€åŒ–å…¥å‚</h3>
<p>ä¸Šé¢åªæ˜¯å°è£…äº†ä¸€ä¸ªæœ€æœ€åŸºç¡€çš„è¯·æ±‚ï¼Œè¯¥æ–¹æ³•æ¥å—çš„å‚æ•°æ¯”è¾ƒå¤šï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦å»åšä¸€æ¬¡ç®€åŒ–å‚æ•°çš„æ“ä½œï¼š</p>
<p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º<code>request</code>çš„å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨<code>forEach</code>æ–¹æ³•éå†åŒ…å«ä¸åŒ<code>HTTP</code>è¯·æ±‚æ–¹æ³•çš„æ•°ç»„ã€‚å¯¹äºæ¯ä¸ªHTTPè¯·æ±‚æ–¹æ³•ï¼Œå®ƒä¼šå®šä¹‰ä¸€ä¸ªå¯¹åº”çš„å‡½æ•°ï¼Œå¹¶å°†å…¶ä½œä¸º<code>request</code>å¯¹è±¡çš„å±æ€§ã€‚</p>
<p>è¿™æ ·ï¼Œåœ¨ä½¿ç”¨<code>request</code>å¯¹è±¡æ—¶ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨<code>request.GET()</code>ã€<code>request.POST()</code>ç­‰æ–¹æ³•æ¥å‘èµ·ä¸åŒç±»å‹çš„HTTPè¯·æ±‚ï¼Œè€Œä¸éœ€è¦æ¯æ¬¡éƒ½æ˜¾å¼åœ°æŒ‡å®šè¯·æ±‚çš„æ–¹æ³•ã€‚è¿™æ ·å¯ä»¥ä½¿ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºç»´æŠ¤ã€‚</p>
<p>æœ€åå¯¼å‡º<code>request</code>å¯¹è±¡</p>
<pre><code class="language-js">const request = {}

['options', 'get', 'post', 'put', 'head', 'delete', 'trace', 'connect'].forEach((method) =&gt; {
	request[method] = (api, data, loading) =&gt; baseRequest(api, method, data, loading)
})

export default request
</code></pre>
<p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<p><code>/api/user.js</code> æ–‡ä»¶</p>
<pre><code class="language-js">import request from '@/utils/request'

//ä¸ªäººä¿¡æ¯
export const info = data =&gt; request.post('/v1/api/info', data)
</code></pre>
<p>é¡µé¢ä½¿ç”¨ï¼š</p>
<pre><code class="language-js">import { info } from '@/api/user.js'
export default {
	onLoad() {
		this.getUserinfo()
	},
	methods: {
		async getUserinfo() {
			let res = await info()
		}
	}
}
</code></pre>
<h3 id="ç¦æ­¢é‡å¤è¯·æ±‚">ç¦æ­¢é‡å¤è¯·æ±‚</h3>
<p>ä¸ºäº†èŠ‚çœç½‘ç»œèµ„æºã€æé«˜æ€§èƒ½å’Œå“åº”é€Ÿåº¦ä»¥åŠé¿å…æ•°æ®é”™è¯¯ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å‘èµ·çš„è¯·æ±‚åšä¸€äº›é™åˆ¶æ¥é¿å…é‡å¤è¯·æ±‚ï¼Œå¸¸è§çš„é™åˆ¶æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p>1.ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµï¼šå¯ä»¥ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµçš„æŠ€æœ¯æ¥æ§åˆ¶è¯·æ±‚çš„è§¦å‘é¢‘ç‡ï¼Œç¡®ä¿åœ¨ä¸€æ®µæ—¶é—´å†…åªå‘èµ·ä¸€æ¬¡è¯·æ±‚ã€‚<br>
2.è®¾ç½®è¯·æ±‚é”ï¼šå¯ä»¥åœ¨å‘èµ·è¯·æ±‚ä¹‹å‰è®¾ç½®ä¸€ä¸ªè¯·æ±‚é”ï¼Œé˜²æ­¢é‡å¤è§¦å‘è¯·æ±‚ã€‚<br>
3.åˆç†è®¾è®¡é¡µé¢å’Œäº¤äº’é€»è¾‘ï¼šåœ¨é¡µé¢è®¾è®¡å’Œäº¤äº’é€»è¾‘ä¸­ï¼Œåˆç†å®‰æ’è¯·æ±‚çš„æ—¶æœºï¼Œé¿å…ä¸å¿…è¦çš„é‡å¤è¯·æ±‚ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨å°è£…çš„æ¥å£è¯·æ±‚ä¸­æ·»åŠ ä¸€ä¸ªè¯·æ±‚é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰å½“å‰å‘èµ·ä¸”æ²¡æœ‰è¿”å›ç»“æœçš„ï¼Œå°±ä¸å…è®¸å†æ¬¡è¯·æ±‚ï¼Œå…·ä½“å®ç°æ€è·¯å¦‚ä¸‹ï¼š</p>
<p>1.åˆ›å»ºä¸€ä¸ªå­˜æ”¾å”¯ä¸€IDçš„<code>Map</code>å¯¹è±¡<br>
2.å½“è¯·æ±‚æ¥å£æ—¶å€™é€šè¿‡æ‹¿åˆ°çš„<code>method</code>ã€<code>url</code>ã€<code>params</code>ã€æ¥ç”Ÿæˆå”¯ä¸€<code>ID</code><br>
3.è¯·æ±‚å®Œæˆåï¼ŒæŠŠå½“å‰<code>ID</code>ä»å¯¹è±¡ä¸­åˆ é™¤ã€‚</p>
<p>æˆ‘ä»¬æŠŠæ£€æµ‹å”¯ä¸€<code>ID</code>è¿™ä¸ªåŠŸèƒ½æç‚¼å‡ºæ¥ï¼Œå•ç‹¬å»å°è£…ä¸€ä¸ª<code>class</code>å»å®ç°ï¼›å…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<p>æ–°å»º<code>/utils/requestManager.js</code>æ–‡ä»¶ï¼Œåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶åˆå§‹åŒ–ä¸€ä¸ªåä¸º<code>idMap</code>çš„å¯¹è±¡ï¼Œæœ€åå¯¼å‡ºå¯¹è±¡</p>
<pre><code class="language-js">class RequestManager {
    constructor() {
        this.idMap = new Map()
    }
}

export default RequestManager
</code></pre>
<p>æ ¹æ®<code>method</code>ã€<code>url</code>ã€<code>params</code>ã€æ¥ç”Ÿæˆå”¯ä¸€<code>ID</code>ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬çš„<code>params</code>éœ€è¦è¿›è¡Œåºåˆ—åŒ–å¤„ç†ï¼Œä¸ç„¶å¦‚æœåŒä¸€ä¸ªæ¥å£ã€ç›¸åŒçš„è¯·æ±‚æ–¹å¼ã€å‚æ•°é¡ºåºä¸åŒä¹Ÿä¼šåˆ¤æ–­ä¸ºä¸åŒçš„è¯·æ±‚ã€‚</p>
<pre><code class="language-js">class RequestManager {
    /**
     * ç”Ÿæˆå”¯ä¸€IDçš„æ–¹æ³•
     * @param {string} method - è¯·æ±‚æ–¹æ³•
     * @param {string} url - è¯·æ±‚URL
     * @param {object} params - è¯·æ±‚å‚æ•°
     * @returns {string} - ç”Ÿæˆçš„å”¯ä¸€ID
     */
    generateUniqueId(method, url, params) {
        const idString = `${method}-${url}-${this.serializeObject(params)}`
        let id = 0;
        for (let i = 0; i &lt; idString.length; i++) {
            id = ((id &lt;&lt; 5) - id) + idString.charCodeAt(i)
            id |= 0;
        }
        return id.toString()
    }

	 /**
     * åºåˆ—åŒ–å¯¹è±¡ä¸ºå­—ç¬¦ä¸²
     * @param {object} obj - è¦åºåˆ—åŒ–çš„å¯¹è±¡
     * @returns {string} - åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²
     */
    serializeObject(obj) {
        const keys = Object.keys(obj).sort()
        const serializedObj = {}
        for (let key of keys) {
            const value = obj[key]
            if (value !== null &amp;&amp; typeof value === 'object') {
                serializedObj[key] = this.serializeObject(value)
            } else {
                serializedObj[key] = value
            }
        }
        return JSON.stringify(serializedObj)
    }
}
</code></pre>
<p>å†™å®Œç”Ÿæˆæ–¹æ³•ï¼Œç›¸å¯¹åº”çš„å®ç°ä¸€ä¸‹åˆ é™¤æ–¹æ³•ï¼š</p>
<pre><code class="language-js">class RequestManager {
    /**
     * æ ¹æ®IDåˆ é™¤mapå¯¹è±¡ä¸­çš„è¯·æ±‚ä¿¡æ¯
     * @param {string} id - è¦åˆ é™¤çš„å”¯ä¸€ID
     */
    deleteById(id) {
        this.idMap.delete(id)
    }
}
</code></pre>
<p>ä¸Šé¢å°±å®ç°äº†åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¸‹é¢æˆ‘ä»¬å†™ä¸€ä¸ªæ–¹æ³•ï¼Œå»ç»„åˆä¸€ä¸‹ä¸Šé¢çš„åŠŸèƒ½ï¼Œç®€åŒ–ä½¿ç”¨ï¼š</p>
<pre><code class="language-JS">class RequestManager {
    /**
     * ç”Ÿæˆå”¯ä¸€IDï¼Œå¹¶å°†IDå’Œè¯·æ±‚ä¿¡æ¯å­˜å‚¨åˆ°mapå¯¹è±¡ä¸­
     * @param {string} method - è¯·æ±‚æ–¹æ³•
     * @param {string} url - è¯·æ±‚URL
     * @param {object} params - è¯·æ±‚å‚æ•°
     * @returns {string|boolean} - ç”Ÿæˆçš„å”¯ä¸€IDï¼Œå¦‚æœå­˜åœ¨ç›¸åŒidåˆ™è¿”å›false
     */
    generateId(method, url, params) {
        const id = this.generateUniqueId(method, url, params)
        if (this.idMap.has(id)) {
            return false
        }
        this.idMap.set(id, { method, url, params })
        return id
    }
}
</code></pre>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬çš„æ–¹æ³•å°±å†™å®Œäº†ï¼Œä¸‹é¢æ¥çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ï¼š</p>
<pre><code class="language-js">//å¼•å…¥æ–¹æ³•
import RequestManager from '@/utils/requestManager.js' 

const manager = new RequestManager() //åˆ›å»º

const baseRequest = async (url, method, data = {}, loading = true) =&gt;{

	// ç”Ÿæˆå”¯ä¸€ID, å¦‚æœè¿”å›false ä»£è¡¨é‡å¤è¯·æ±‚
	let requestId = manager.generateId(method, url, data)
	if(!requestId) {
		console.log('é‡å¤è¯·æ±‚')
		return false
	}
	return new Promise((reslove, reject) =&gt; {
		uni.request({
			complete: ()=&gt;{
				// è¯·æ±‚å®Œæˆï¼Œæ¸…é™¤å½“å‰è¯·æ±‚çš„å”¯ä¸€ID
				manager.deleteById(requestId)
			},
		})
	})
}
</code></pre>
<h3 id="æ·»åŠ å…¨å±€loading">æ·»åŠ å…¨å±€loading</h3>
<p>æ·»åŠ å…¨å±€<code>loading</code>å°±æ¯”è¾ƒç®€å•äº†ï¼Œæˆ‘ä»¬å‰é¢å®šä¹‰äº†å…¥å‚æ•°<code>loading</code>ï¼Œå¦‚æœä¸º<code>true</code>ï¼Œåœ¨åˆ›å»º<code>Promise</code>åï¼Œè°ƒç”¨<code>uni.showLoading</code>å³å¯ã€‚<br>
åŒæ—¶éœ€è¦åœ¨<code>uni.request</code>ä¸­æ·»åŠ <code>complete</code>æ–¹æ³•ï¼Œåœ¨è¯·æ±‚å®Œæˆåå»å…³é—­<code>loading</code>ã€‚</p>
<pre><code class="language-js">const baseRequest = async (url, method, data = {}, loading = true) =&gt;{
	return new Promise((reslove, reject) =&gt; {
		// å¼€å¯loading
		loading &amp;&amp; uni.showLoading({title: 'loading'})
		uni.request({
			// ...
			complete: ()=&gt;{
				// å…³é—­loading
				uni.hideLoading()
			},
			// ...çœç•¥ä¸‹æ–¹ä»£ç 
		})
	})
}
</code></pre>
<h2 id="ç»“å°¾">ç»“å°¾</h2>
<p>æ‰€æœ‰ä»£ç å·²æ”¾åˆ°<code>github</code>ï¼›è¯·è®¿é—® <a href="https://github.com/LonJinUp/uni-app-template">uni-app-template</a>ï¼Œå¦‚æœè§‰å¾—ä¸åšï¼Œè®°å¾—ç»™ä¸ª<code>star</code></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ã€nodeå­¦ä¹ -01ã€‘node.jsåŸºç¡€]]></title>
        <id>https://lonjinup.github.io/node-01/</id>
        <link href="https://lonjinup.github.io/node-01/">
        </link>
        <updated>2023-05-10T16:00:32.000Z</updated>
        <content type="html"><![CDATA[<h1 id="nodeåŸºç¡€">nodeåŸºç¡€</h1>
<h2 id="nodeæ˜¯ä»€ä¹ˆ">nodeæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<blockquote>
<p>Node.js ä¸æ˜¯ä¸€é—¨è¯­è¨€ï¼Œæ˜¯ä¸€ä¸ªè¿è¡Œæ—¶ï¼Œå’Œæµè§ˆå™¨æ›´åƒï¼Œåªä¸è¿‡è¿è¡Œåœ¨æœåŠ¡ç«¯ã€‚<br>
è¿™ä¸ªè¿è¡Œæ—¶çš„æ–¹è¨€æ˜¯ JavaScriptï¼ˆä¸åŒ…å« BOMã€DOM APIï¼Œå¢åŠ äº† Streamã€ç½‘ç»œç­‰ APIï¼‰ã€‚<br>
Node.js æ˜¯é  Chrome V8 å¼•æ“è¿è¡Œ JavaScriptã€‚</p>
</blockquote>
<blockquote>
<p>å¯¹åº”åˆ° Java æˆ‘ä»¬å¯ä»¥ç†è§£ Node.js æ˜¯ JDKï¼Œè£…ä¸Šå°±èƒ½åœ¨æœåŠ¡ç«¯è·‘ JavaScript ä»£ç äº†ã€‚Chrome å’Œ Node.js åŒæ ·æ˜¯ JavaScript è¿è¡Œæ—¶ï¼Œéƒ½ä½¿ç”¨äº† V8 å¼•æ“ï¼Œä¸»è¦åŒºåˆ«åœ¨äº V8 åªå®ç°äº† ECMAScript çš„æ•°æ®ç±»å‹ã€å¯¹è±¡å’Œæ–¹æ³•ï¼ŒChrome è¿è¡Œæ—¶æä¾›äº† Windowã€DOMã€BOMï¼Œè€Œ Node.js è¿è¡Œæ—¶æä¾›äº†globalã€ Bufferã€net ç­‰æ¨¡å—</p>
</blockquote>
<h2 id="nodeå¯ä»¥å¹²ä»€ä¹ˆ">nodeå¯ä»¥å¹²ä»€ä¹ˆï¼Ÿ</h2>
<ul>
<li>åç«¯webæœåŠ¡å™¨å¼€å‘ä¸ç½‘ç»œçˆ¬è™«å¼€å‘</li>
<li>è„šæ‰‹æ¶å‘½ä»¤è¡Œå·¥å…·å¼€å‘</li>
<li>å›¾å½¢ç•Œé¢åº”ç”¨ç¨‹åºå¼€å‘</li>
</ul>
<h2 id="ç¯å¢ƒæ­å»ºä¸åŸºç¡€å…¥é—¨">ç¯å¢ƒæ­å»ºä¸åŸºç¡€å…¥é—¨</h2>
<h2 id="å®‰è£…node">å®‰è£…node</h2>
<p>æ‰“å¼€ <a href="https://nodejs.org/zh-cn">node.js</a>å®˜ç½‘ï¼Œé€‰æ‹©é•¿æœŸç»´æŠ¤ç‰ˆè¿›è¡Œå®‰è£…ã€‚</p>
<p>ç»ˆç«¯ä¸‹è¾“å…¥</p>
<pre><code class="language-node">node -v
</code></pre>
<p>å¯ä»¥è¾“å‡ºç‰ˆæœ¬å·å³å¯è¯æ˜å®‰è£…æˆåŠŸ</p>
<h2 id="å¦‚ä½•ä½¿ç”¨nodejs-è¿è¡Œjavascriptä»£ç ">å¦‚ä½•ä½¿ç”¨node.js è¿è¡ŒJavaScriptä»£ç </h2>
<ul>
<li>æ–°å»º <code>index.js</code> æ–‡ä»¶ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</li>
</ul>
<pre><code class="language-js">let a = 1
console.log(a)
</code></pre>
<ul>
<li>ç»ˆç«¯ä¸‹è¾“å…¥ï¼š</li>
</ul>
<pre><code class="language-js">node index.js
</code></pre>
<p>æ§åˆ¶å°å°±ä¼šæ‰“å‡º<code>1</code></p>
<h2 id="æ–‡ä»¶æ“ä½œä¸æ¨¡å—åŒ–çš„æ¦‚å¿µ">æ–‡ä»¶æ“ä½œä¸æ¨¡å—åŒ–çš„æ¦‚å¿µ</h2>
<h3 id="è¯»å–æ–‡ä»¶å†…å®¹">è¯»å–æ–‡ä»¶å†…å®¹</h3>
<p>æ–°å»º<code>read.js</code>ï¼Œå¼•å…¥<code>fs</code>æ¨¡å—ï¼Œé€šè¿‡<code>fs</code>ä¸‹çš„<code>readFile</code>è¿›è¡Œè¯»å–ï¼š</p>
<pre><code class="language-js">// å¼•å…¥fs æ¨¡å—
var fs = require('fs')

// æ–‡ä»¶è·¯å¾„ ç¼–ç æ ¼å¼ å›è°ƒå‡½æ•°ï¼ˆå¼‚å¸¸ï¼Œæ–‡ä»¶å†…å®¹ï¼‰
fs.readFile('./index.txt', 'utf8', function (error, data) {
    console.log(error) // null
    console.log(data) // txt æ–‡ä»¶ä¸­çš„å†…å®¹
})
</code></pre>
<h3 id="å†™å…¥æ–‡ä»¶å†…å®¹">å†™å…¥æ–‡ä»¶å†…å®¹</h3>
<p>å†™å…¥æ–‡ä»¶ä¾æ—§é€šè¿‡<code>fs</code>ä¸‹çš„<code>writeFile</code>æ¥å®ç°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">// å¼•å…¥fs æ¨¡å—
var fs = require('fs')

// æ–‡ä»¶è·¯å¾„ å†…å®¹ å›è°ƒå‡½æ•°ï¼ˆå¼‚å¸¸ï¼‰
fs.writeFile('./index.txt', 'hello lonjin', function (error) {
    !error &amp;&amp; console.log('å†™å…¥æˆåŠŸ')
})
</code></pre>
<h3 id="è¿½åŠ å†…å®¹">è¿½åŠ å†…å®¹</h3>
<p>é€šè¿‡ä¸Šé¢å†…å®¹æˆ‘ä»¬å¯ä»¥å®Œæˆæ–‡ä»¶çš„è¯»å–ä¸å†™å…¥ï¼Œé‚£ä¹ˆè¿½åŠ å°±æ¯”è¾ƒç®€å•äº†ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">// å¼•å…¥fs æ¨¡å—
var fs = require('fs')

fs.readFile('./index.txt', 'utf8', function (error, data) {
    if (!error) {
        let newData = data + new Date()
        fs.writeFile('./index.txt', newData, function (error) {
            !error &amp;&amp; console.log('è¿½åŠ æˆåŠŸ')
        })
    }
}) 
</code></pre>
<h3 id="æ¨¡å—åŒ–ç¼–ç¨‹çš„æ¦‚å¿µ">æ¨¡å—åŒ–ç¼–ç¨‹çš„æ¦‚å¿µ</h3>
<p>å½“æˆ‘ä»¬åœ¨<code>Node.js</code>ä¸­å†™ä»£ç æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦ä½¿ç”¨ä¸åŒçš„æ¨¡å—æ¥å®Œæˆä¸åŒçš„ä»»åŠ¡ã€‚<code>require('fs')</code>å°±æ˜¯<code>Node.js</code>ä¸­çš„æ¨¡å—ç³»ç»Ÿï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥å¼•å…¥å…¶ä»–æ¨¡å—ï¼Œä¾‹å¦‚fsæ¨¡å—æ¥è¿›è¡Œæ–‡ä»¶æ“ä½œã€‚</p>
<p>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æ¨¡å—åŒ–å‘¢ï¼Ÿåœ¨<code>JavaScript</code>ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ‰€æœ‰ä»£ç éƒ½å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆæ–‡ä»¶å°†å˜å¾—éå¸¸å¤§ä¸”éš¾ä»¥ç»´æŠ¤ã€‚åŒæ—¶ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦åœ¨å¤šä¸ªæ–‡ä»¶ä¸­é‡å¤ä½¿ç”¨æŸä¸ªåŠŸèƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨æ¯ä¸ªæ–‡ä»¶ä¸­éƒ½å†™å…¥è¿™ä¸ªåŠŸèƒ½ï¼Œè¿™æ ·ä¼šå¯¼è‡´ä»£ç å†—ä½™å’Œç»´æŠ¤æˆæœ¬çš„å¢åŠ ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§èƒ½å¤Ÿæ‹†åˆ†ä»£ç ã€ç›¸äº’ç‹¬ç«‹ã€å¯¼å…¥å¯¼å‡ºçš„æ–¹å¼æ¥è¿›è¡Œæ¨¡å—åŒ–ç¼–ç¨‹ã€‚</p>
<p>åœ¨<code>JavaScript</code>ä¸­ï¼Œæœ‰å¤šç§æ¨¡å—åŒ–çš„æ¦‚å¿µï¼Œæ¯”å¦‚CommonJSã€AMDã€ES6ç­‰ã€‚<code>Node.js</code>é‡‡ç”¨äº†CommonJSè§„èŒƒï¼Œå³é€šè¿‡<code>require()</code>æ¥å¼•å…¥æ¨¡å—ï¼Œé€šè¿‡<code>module.exports</code>æ¥å¯¼å‡ºæ¨¡å—ã€‚åœ¨ES6ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>import</code>å’Œ<code>export</code>æ¥è¿›è¡Œæ¨¡å—åŒ–ç¼–ç¨‹ã€‚è€ŒAMDåˆ™æ˜¯å¦å¤–ä¸€ç§æ¨¡å—åŒ–æ–¹æ¡ˆï¼Œå®ƒé‡‡ç”¨äº†å¼‚æ­¥æ¨¡å—å®šä¹‰ï¼Œé€‚åˆåœ¨æµè§ˆå™¨ç«¯è¿›è¡Œæ¨¡å—åŒ–ç¼–ç¨‹ã€‚</p>
<p>é€šä¿—ä¸€ç‚¹çš„è¯´ï¼Œæ¨¡å—åŒ–ç¼–ç¨‹å…¶å®å°±æ˜¯æ‹†åˆ†ä»£ç ã€ç›¸äº’ç‹¬ç«‹ã€å¯¼å…¥å¯¼å‡ºï¼›å¥½æ¯”é€ è½¦ï¼Œæ±½è½¦è½®èƒç®—ä¸€ä¸ªæ¨¡å—ï¼Œæ±½è½¦å¼•æ“ç®—ä¸€ä¸ªæ¨¡å—ã€æ±½è½¦è½¦ä½“ç®—ä¸€ä¸ªæ¨¡å—ï¼Œé€šè¿‡å„ä¸ªæ¨¡å—çš„ç»„è£…ï¼Œæœ€ç»ˆç”Ÿäº§å‡ºä¸€è¾†æ±½è½¦ã€‚<code>JavaScript</code>ä¸­çš„æ¨¡å—åŒ–çš„æ¦‚å¿µä¹Ÿæ˜¯è¿‘å‡ å¹´æ‰å‡ºç°çš„ï¼Œä¹‹å‰çš„jså¹¶æ²¡æœ‰æ¨¡å—åŒ–çš„æ¦‚å¿µã€‚</p>
<h2 id="npmåŒ…ç®¡ç†å™¨">npmåŒ…ç®¡ç†å™¨</h2>
<blockquote>
<p>npmï¼ˆNode Package Managerï¼‰æ˜¯ Node.js çš„åŒ…ç®¡ç†å™¨ï¼Œç”¨äºç®¡ç†å’Œå…±äº« JavaScript ä»£ç ã€‚å®ƒæ˜¯ Node.js å®˜æ–¹æä¾›çš„é»˜è®¤åŒ…ç®¡ç†å·¥å…·ï¼Œç”¨äºå®‰è£…ã€å‘å¸ƒã€æ›´æ–°å’Œç®¡ç† JavaScript åŒ…å’Œä¾èµ–é¡¹ã€‚</p>
</blockquote>
<h3 id="ä½œç”¨">ä½œç”¨</h3>
<ul>
<li>åŒ…ç®¡ç†ï¼šnpm å…è®¸å¼€å‘è€…åœ¨é¡¹ç›®ä¸­å®‰è£…ã€æ›´æ–°å’Œå¸è½½ä¾èµ–çš„ç¬¬ä¸‰æ–¹åŒ…æˆ–æ¨¡å—ï¼Œæä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹å¼æ¥ç®¡ç†é¡¹ç›®çš„ä¾èµ–å…³ç³»ã€‚</li>
<li>ä»£ç å…±äº«ï¼šå¼€å‘è€…å¯ä»¥é€šè¿‡ npm å‘å¸ƒè‡ªå·±ç¼–å†™çš„æ¨¡å—æˆ–åº”ç”¨ï¼Œå¹¶å°†å…¶å…±äº«ç»™å…¶ä»–å¼€å‘è€…ä½¿ç”¨ã€‚</li>
<li>ç‰ˆæœ¬æ§åˆ¶ï¼šnpm æä¾›äº†ä¸°å¯Œçš„ç‰ˆæœ¬ç®¡ç†åŠŸèƒ½ï¼Œå¼€å‘è€…å¯ä»¥æŒ‡å®šå®‰è£…ç‰¹å®šç‰ˆæœ¬çš„åŒ…ï¼Œä»¥ç¡®ä¿é¡¹ç›®çš„ç¨³å®šæ€§å’Œå…¼å®¹æ€§ã€‚</li>
</ul>
<h3 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</h3>
<ul>
<li><code>npm init</code>ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œç”Ÿæˆ package.json æ–‡ä»¶ã€‚</li>
<li><code>npm install</code>ï¼šå®‰è£…é¡¹ç›®ä¾èµ–ï¼Œæ ¹æ® package.json ä¸­çš„é…ç½®è‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…ä¾èµ–ã€‚</li>
<li><code>npm install &lt;package&gt;</code>ï¼šå®‰è£…æŒ‡å®šçš„åŒ…ã€‚</li>
<li><code>npm install --save-dev &lt;package&gt;</code>ï¼šå®‰è£…å¼€å‘ç¯å¢ƒä¾èµ–ï¼Œä»…åœ¨å¼€å‘é˜¶æ®µä½¿ç”¨ã€‚</li>
<li><code>npm update</code>ï¼šæ›´æ–°é¡¹ç›®ä¾èµ–çš„åŒ…åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚</li>
<li><code>npm uninstall &lt;package&gt;</code>ï¼šå¸è½½æŒ‡å®šçš„åŒ…ã€‚</li>
<li><code>npm run &lt;script&gt;</code>ï¼šè¿è¡Œé¡¹ç›®ä¸­å®šä¹‰çš„è„šæœ¬å‘½ä»¤ï¼Œå¯ä»¥åœ¨ package.json çš„ scripts éƒ¨åˆ†å®šä¹‰è‡ªå®šä¹‰å‘½ä»¤ã€‚</li>
<li><code>npm publish</code>ï¼šå°†è‡ªå·±ç¼–å†™çš„æ¨¡å—å‘å¸ƒåˆ° npm å…¬å…±æ³¨å†Œè¡¨ï¼Œä¾›å…¶ä»–äººä½¿ç”¨ã€‚</li>
<li><code>npm search</code> <package>ï¼šåœ¨ npm æ³¨å†Œè¡¨ä¸­æœç´¢æŒ‡å®šçš„åŒ…ã€‚</li>
<li><code>npm outdated</code>ï¼šæ£€æŸ¥é¡¹ç›®ä¸­å·²å®‰è£…åŒ…çš„æ›´æ–°çŠ¶æ€ã€‚<br>
è¿™åªæ˜¯ä¸€äº›å¸¸ç”¨çš„ npm å‘½ä»¤ï¼Œnpm è¿˜æä¾›äº†å…¶ä»–è®¸å¤šå‘½ä»¤å’ŒåŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚å‚è€ƒå®˜æ–¹æ–‡æ¡£æˆ–ä½¿ç”¨ <code>npm help</code> å‘½ä»¤è·å–æ›´å¤šä¿¡æ¯ã€‚</li>
</ul>
<h2 id="ç®¡ç†npmåŒ…">ç®¡ç†npmåŒ…</h2>
<p>æ–°å»ºä¸€ä¸ª<code>time</code>æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ä¸‹å»ºç«‹<code>index.js</code>ï¼Œä¸‹é¢æˆ‘ä»¬è¾“å‡ºä¸€ä¸ªå½“å‰æ—¥æœŸï¼š</p>
<pre><code class="language-js">let time = Date.now()
console.log(time) //1692708681030
</code></pre>
<p>å¦‚æœæˆ‘ä»¬æƒ³è¾“å‡ºä¸€ä¸ª<code>å¹´-æœˆ-æ—¥ æ—¶ï¼šåˆ†ï¼šç§’</code>çš„æ ¼å¼ï¼Œåˆ™å¯ä»¥åˆ©ç”¨<code>npm</code>ä¸Šçš„åŒ…è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚<code>moment</code>ã€‚</p>
<p>å®‰è£…ï¼š</p>
<pre><code class="language-shell">npm i moment
</code></pre>
<p>å¼•å…¥&amp;&amp;ä½¿ç”¨ï¼š</p>
<pre><code class="language-js">const moment = require('moment')

let time = Date.now()
console.log(moment(time).format('YYYY-MM-DD HH:mm:ss')) //2023-08-22 20:51:21
</code></pre>
<p>è¿™å°±æ˜¯<code>npm</code>åŒ…æœ€ç®€å•çš„ä¸€ä¸ªä½¿ç”¨ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[uni-appå¼€å‘å°ç¨‹åºï¼šé¡¹ç›®æ¶æ„ä»¥åŠç»éªŒåˆ†äº«]]></title>
        <id>https://lonjinup.github.io/uni-app-template-01/</id>
        <link href="https://lonjinup.github.io/uni-app-template-01/">
        </link>
        <updated>2023-02-21T07:40:10.000Z</updated>
        <content type="html"><![CDATA[<h1 id="uni-appå¼€å‘å°ç¨‹åºé¡¹ç›®æ¶æ„ä»¥åŠç»éªŒåˆ†äº«">uni-appå¼€å‘å°ç¨‹åºï¼šé¡¹ç›®æ¶æ„ä»¥åŠç»éªŒåˆ†äº«</h1>
<blockquote>
<p><code>2022</code>å¹´çš„æ—¶å€™ï¼Œå…¬å¸ä¸ºäº†å¿«é€Ÿå®Œæˆäº§å“å¹¶ä¸Šçº¿ï¼Œæ‰€ä»¥é€‰ç”¨å¾®ä¿¡å°ç¨‹åºä¸ºè½½ä½“ï¼›ç”±äºåæœŸè¿˜æ˜¯æ‰“ç®—å¼€å‘<code>App</code>ï¼›è™½ç„¶å…¬å¸æœ‰<code>ios</code>å’Œ<code>Android</code>ï¼Œä½†æ˜¯å¦‚æœèƒ½ä¸€å¥—ä»£ç æ‰“åŒ…å¤šç«¯ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥è§£å†³æˆæœ¬ã€‚å‰ç«¯æŠ€æœ¯æ ˆä¹Ÿæ˜¯<code>vue</code>ï¼Œåœ¨è€ƒå¯Ÿé€‰æ‹©äº†<code>uni-app</code>ã€‚åæ¥å¤šä¸ªå°ç¨‹åºé¡¹ç›®éƒ½é‡‡ç”¨äº†<code>uni-app</code>å¼€å‘ï¼Œç§¯ç´¯äº†ä¸€å®šçš„ç»éªŒä»¥åŠå°è£…äº†è¾ƒå¤šä¸šåŠ¡ç»„ä»¶ï¼Œè¿™é‡Œå°±åˆ†äº«ä¸€ä¸‹<code>uni-app</code>é¡¹ç›®çš„æ•´ä½“æ¶æ„ã€æ–¹æ³•å°è£…ç»„ä»¶åº“é€‰æ‹©ä»¥åŠæ³¨æ„äº‹é¡¹ã€‚å…¨æ–‡ä»£ç éƒ½ä¼šæ”¾åˆ°<code>github</code>ï¼Œå…ˆèµåçœ‹ï¼Œæœˆå…¥ç™¾ä¸‡ï¼</p>
</blockquote>
<h2 id="åˆ›å»ºé¡¹ç›®">åˆ›å»ºé¡¹ç›®</h2>
<p><code>uni-app</code>æä¾›äº†ä¸¤ç§åˆ›å»ºé¡¹ç›®çš„æ–¹å¼ï¼š</p>
<ul>
<li>1.é€šè¿‡<a href="https://zh.uniapp.dcloud.io/quickstart-hx.html">HBuilderX</a>å¯è§†åŒ–å·¥å…·åˆ›å»º</li>
<li>2.é€šè¿‡<a href="https://zh.uniapp.dcloud.io/quickstart-cli.html">vue-cli</a>å‘½ä»¤åˆ›å»º</li>
</ul>
<blockquote>
<p>âš ï¸éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€å®šè¦æ ¹æ®é¡¹ç›®éœ€æ±‚æ¥é€‰æ‹©é¡¹ç›®çš„åˆ›å»ºæ–¹å¼ï¼›å¦‚æœåªæ˜¯å•ç‹¬çš„å¼€å‘<code>å°ç¨‹åº</code>æˆ–<code>App</code>ï¼Œä¸”å¼€å‘ç¯å¢ƒå•ä¸€ï¼Œå¯ä»¥ä½¿ç”¨<code>HBuilderX</code>å¯è§†åŒ–å·¥å…·åˆ›å»ºã€‚å¦‚æœå¤šç«¯å¼€å‘ï¼Œä»¥åŠåŒä¸€å¥—ä»£ç å¯èƒ½ä¼šæ‰“åŒ…ç”Ÿæˆ<code>å¤šä¸ª</code>å°ç¨‹åºå»ºè®®ä½¿ç”¨<code>vue-cli</code>è¿›è¡Œåˆ›å»ºï¼Œä¸ç„¶åæœŸæƒ³æè‡ªåŠ¨åŒ–æ„å»ºä»¥åŠæŒ‰æŒ‡å®šæ¡ä»¶è¿›è¡Œç¼–è¯‘æ¯”è¾ƒç—›è‹¦ã€‚å…³äºæŒ‰æ¡ä»¶ç¼–è¯‘ï¼Œæ–‡ç« åé¢ä¼šæœ‰è¯¦ç»†è¯´æ˜ã€‚</p>
</blockquote>
<p>ä½¿ç”¨<code>vue-cli</code>å®‰è£…å’Œè¿è¡Œï¼š</p>
<p>1.å…¨å±€å®‰è£… vue-cli</p>
<pre><code class="language-js">npm install -g @vue/cli
</code></pre>
<p>2.åˆ›å»ºuni-app</p>
<pre><code class="language-js">vue create -p dcloudio/uni-preset-vue é¡¹ç›®åç§°
</code></pre>
<p>3.è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹</p>
<pre><code class="language-js">cd é¡¹ç›®åç§°
</code></pre>
<p>4.è¿è¡Œé¡¹ç›®ï¼Œå¦‚æœæ˜¯å·²å¾®ä¿¡å°ç¨‹åºä¸ºä¸»ï¼Œå¯ä»¥åœ¨<code>package.json</code>ä¸­çš„å‘½ä»¤æ”¹ä¸ºï¼š</p>
<pre><code class="language-json">&quot;scripts&quot;: {
    &quot;serve&quot;: &quot;npm run dev:mp-weixin&quot;
}
</code></pre>
<p>ç„¶åæ‰§è¡Œ</p>
<pre><code class="language-js">npm run serve
</code></pre>
<p>ä½¿ç”¨<code>cli</code>åˆ›å»ºé¡¹ç›®é»˜è®¤ä¸å¸¦<code>css</code>é¢„ç¼–è¯‘ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ä¸€ä¸‹ï¼Œè¿™é‡Œå·²<code>sass</code>ä¸ºä¾‹ï¼š</p>
<pre><code class="language-js">npm i sass --save-dev
npm i sass-loader --save-dev
</code></pre>
<h2 id="æ•´ä½“é¡¹ç›®æ¶æ„">æ•´ä½“é¡¹ç›®æ¶æ„</h2>
<p>é€šè¿‡<code>HBuilderX</code>æˆ–è€…<code>vue-cli</code>åˆ›å»ºçš„é¡¹ç›®ï¼Œç›®å½•ç»“æ„æœ‰ç¨è®¸ä¸åŒï¼Œä½†åŸºæœ¬æ²¡ä»€ä¹ˆå·®å¼‚ï¼Œè¿™é‡Œå°±æŒ‰<code>vue-cli</code>åˆ›å»ºçš„é¡¹ç›®ä¸ºä¾‹ï¼Œæ•´ä½“æ¶æ„é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-tree">    â”œâ”€â”€dist ç¼–è¯‘åçš„æ–‡ä»¶è·¯å¾„
    â”œâ”€â”€package.json é…ç½®é¡¹
	â”œâ”€â”€src æ ¸å¿ƒå†…å®¹
        â”œâ”€â”€api é¡¹ç›®æ¥å£
        â”œâ”€â”€components å…¨å±€å…¬å…±ç»„ä»¶
        â”œâ”€â”€config é¡¹ç›®é…ç½®æ–‡ä»¶
        â”œâ”€â”€pages ä¸»åŒ…
        â”œâ”€â”€static å…¨å±€é™æ€èµ„æº
        â”œâ”€â”€store vuex
        â”œâ”€â”€mixins å…¨å±€æ··å…¥
        â”œâ”€â”€utils å…¬å…±æ–¹æ³•
        â”œâ”€â”€App.vue åº”ç”¨é…ç½®ï¼Œé…ç½®Appå…¨å±€æ ·å¼ä»¥åŠç›‘å¬
        â”œâ”€â”€main.js Vueåˆå§‹åŒ–å…¥å£æ–‡ä»¶
        â”œâ”€â”€manifest.json é…ç½®åº”ç”¨åç§°ã€appidç­‰æ‰“åŒ…ä¿¡æ¯
        â”œâ”€â”€pages.json é…ç½®é¡µé¢è·¯ç”±ã€å¯¼èˆªæ¡ã€é€‰é¡¹å¡ç­‰é¡µé¢ç±»ä¿¡æ¯
        â””â”€â”€uni.scss å…¨å±€æ ·å¼
</code></pre>
<h2 id="å°è£…æ–¹æ³•">å°è£…æ–¹æ³•</h2>
<p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚åœ¨å¼€å‘ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€äº›å…¨å±€é€šç”¨çš„æ–¹æ³•è¿›è¡Œå°è£…ï¼Œä»¥åŠæŠŠ<code>uni-app</code>æä¾›çš„<code>api</code>è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œæ–¹ä¾¿ä½¿ç”¨ã€‚å…¨å±€çš„å…¬å…±æ–¹æ³•æˆ‘ä»¬éƒ½ä¼šæ”¾åˆ°<code>/src/utils</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</p>
<h3 id="å°è£…å¸¸ç”¨æ–¹æ³•">å°è£…å¸¸ç”¨æ–¹æ³•</h3>
<p>ä¸‹é¢è¿™äº›æ–¹æ³•éƒ½æ”¾åœ¨<code>/src/utils/utils.js</code>ä¸­ï¼Œæ–‡ç« æœ«å°¾ä¼šæä¾›<code>github</code>é“¾æ¥æ–¹ä¾¿æŸ¥çœ‹ã€‚å¦‚æœé¡¹ç›®è¾ƒå¤§ï¼Œå»ºè®®æŠŠæ–¹æ³•æ ¹æ®åŠŸèƒ½å®šä¹‰ä¸åŒçš„<code>js</code>æ–‡ä»¶ã€‚</p>
<p>å°ç¨‹åº<code>Toast</code>æç¤º</p>
<pre><code class="language-js">/**
 * æç¤ºæ–¹æ³•
 * @param {String} title æç¤ºæ–‡å­—
 * @param {String}  icon iconå›¾ç‰‡
 * @param {Number}  duration æç¤ºæ—¶é—´
 */
export function toast(title, icon = 'none', duration = 1500) {
	if(title) {
		uni.showToast({
		    title,
		    icon,
		    duration
		})
	}
}
</code></pre>
<p>ç¼“å­˜æ“ä½œï¼ˆè®¾ç½®/è·å–/åˆ é™¤/æ¸…ç©ºï¼‰</p>
<pre><code class="language-js">/**
 * ç¼“å­˜æ“ä½œ
 * @param {String} val
 */
export function setStorageSync(key, data) {
    uni.setStorageSync(key, data)
}

export function getStorageSync(key) {
    return uni.getStorageSync(key)
}

export function removeStorageSync(key) {
    return uni.removeStorageSync(key)
}

export function clearStorageSync() {
    return uni.clearStorageSync()
}
</code></pre>
<p>é¡µé¢è·³è½¬</p>
<pre><code class="language-js">/**
 * é¡µé¢è·³è½¬
 * @param {'navigateTo' | 'redirectTo' | 'reLaunch' | 'switchTab' | 'navigateBack' | number } url  è½¬è·³è·¯å¾„
 * @param {String} params è·³è½¬æ—¶æºå¸¦çš„å‚æ•°
 * @param {String} type è½¬è·³æ–¹å¼
 **/
export function useRouter(url, params = {}, type = 'navigateTo') {
    try {
        if (Object.keys(params).length) url = `${url}?data=${encodeURIComponent(JSON.stringify(params))}`
        if (type === 'navigateBack') {
            uni[type]({ delta: url })
        } else {
            uni[type]({ url })
        }
    } catch (error) {
        console.error(error)
    }
}
</code></pre>
<p>å›¾ç‰‡é¢„è§ˆ</p>
<pre><code class="language-js">/**
 * é¢„è§ˆå›¾ç‰‡
 * @param {Array} urls å›¾ç‰‡é“¾æ¥
 */
export function previewImage(urls, itemList = ['å‘é€ç»™æœ‹å‹', 'ä¿å­˜å›¾ç‰‡', 'æ”¶è—']) {
    uni.previewImage({
        urls,
        longPressActions: {
            itemList,
            fail: function (error) {
                console.error(error,'===previewImage')
            }
        }
    })
}
</code></pre>
<p>å›¾ç‰‡ä¸‹è½½</p>
<pre><code class="language-js">/**
 * ä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°
 * @param {String} filePath å›¾ç‰‡ä¸´æ—¶è·¯å¾„
 **/
export function saveImage(filePath) {
    if (!filePath) return false
    uni.saveImageToPhotosAlbum({
        filePath,
        success: (res) =&gt; {
            toast('å›¾ç‰‡ä¿å­˜æˆåŠŸ', 'success')
        },
        fail: (err) =&gt; {
            if (err.errMsg === 'saveImageToPhotosAlbum:fail:auth denied' || err.errMsg === 'saveImageToPhotosAlbum:fail auth deny') {
                uni.showModal({
                    title: 'æç¤º',
                    content: 'éœ€è¦æ‚¨æˆæƒä¿å­˜ç›¸å†Œ',
                    showCancel: false,
                    success: (modalSuccess) =&gt; {
                        uni.openSetting({
                            success(settingdata) {
                                if (settingdata.authSetting['scope.writePhotosAlbum']) {
                                    uni.showModal({
                                        title: 'æç¤º',
                                        content: 'è·å–æƒé™æˆåŠŸ,å†æ¬¡ç‚¹å‡»å›¾ç‰‡å³å¯ä¿å­˜',
                                        showCancel: false
                                    })
                                } else {
                                    uni.showModal({
                                        title: 'æç¤º',
                                        content: 'è·å–æƒé™å¤±è´¥ï¼Œå°†æ— æ³•ä¿å­˜åˆ°ç›¸å†Œå“¦~',
                                        showCancel: false
                                    })
                                }
                            },
                            fail(failData) {
                                console.log('failData', failData)
                            }
                        })
                    }
                })
            }
        }
    })
}
</code></pre>
<p>æ›´å¤šå‡½æ•°å°±ä¸åœ¨æ–‡ç« ä¸­å±•ç¤ºäº†ï¼Œå·²ç»æ”¾åˆ°<code>/src/utils/utils,js</code>é‡Œé¢ï¼Œå…·ä½“å¯ä»¥åˆ°githubæŸ¥çœ‹ã€‚</p>
<h3 id="è¯·æ±‚å°è£…">è¯·æ±‚å°è£…</h3>
<p>ä¸ºäº†å‡å°‘åœ¨é¡µé¢ä¸­çš„è¯·æ±‚ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯¹<code>uni-app</code>æä¾›çš„è¯·æ±‚æ–¹å¼è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œåœ¨<code>/src/utils</code>æ–‡ä»¶å¤¹ä¸‹å»ºç«‹<code>request.js</code>ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">
import {toast, clearStorageSync, getStorageSync, useRouter} from './utils'
import {BASE_URL} from '@/config/index'

const baseRequest = async (url, method, data, loading = true) =&gt;{
	header.token = getStorageSync('token') || ''
	return new Promise((reslove, reject) =&gt; {
		loading &amp;&amp; uni.showLoading({title: 'loading'})
		uni.request({
			url: BASE_URL + url,
			method: method || 'GET',
			header: header,
			timeout: 10000,
			data: data || {},
			success: (successData) =&gt; {
				const res = successData.data
				uni.hideLoading()
				if(successData.statusCode == 200){
                    // è¿™é‡Œæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å»è°ƒæ•´
					if(res.resultCode == 'PA-G998'){
						clearStorageSync()
						useRouter('/pages/login/index', 'reLaunch')
					}else{
						reslove(res.data)
					}
				}else{
					toast('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
					reject(res)
				}
			},
			fail: (msg) =&gt; {
				uni.hideLoading()
				toast('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
				reject(msg)
			}
		})
	})
}

const request = {};

['options', 'get', 'post', 'put', 'head', 'delete', 'trace', 'connect'].forEach((method) =&gt; {
	request[method] = (api, data, loading) =&gt; baseRequest(api, method, data, loading)
})

export default request
</code></pre>
<p>è¯·æ±‚å°è£…å¥½ä»¥åï¼Œæˆ‘ä»¬åœ¨<code>/src/api</code>æ–‡ä»¶å¤¹ä¸‹æŒ‰ä¸šåŠ¡æ¨¡å—å»ºç«‹å¯¹åº”çš„<code>api</code>æ–‡ä»¶ï¼Œæ‹¿è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£ä¸¾ä¾‹å­ï¼š</p>
<p>åœ¨<code>/src/api</code>æ–‡ä»¶å¤¹ä¸‹å»ºç«‹<code>user.js</code>ï¼Œç„¶åå¼•å…¥<code>request.js</code></p>
<pre><code class="language-js">import request from '@/utils/request'

//ä¸ªäººä¿¡æ¯
export const info = data =&gt; request.post('/v1/api/info', data)
</code></pre>
<p>åœ¨é¡µé¢ä¸­ç›´æ¥ä½¿ç”¨ï¼š</p>
<pre><code class="language-js">import {info} from '@/api/user.js'

export default {
	methods: {
		async getUserinfo() {
			let info = await info()
			console.log('ç”¨æˆ·ä¿¡æ¯==', info)
		}
	}
}
</code></pre>
<h2 id="è‡ªå®šä¹‰tabbar">è‡ªå®šä¹‰<code>tabBar</code></h2>
<p>å†™<code>uni-app</code>æˆ–è€…<code>å°ç¨‹åº</code>åŸºæœ¬é¿ä¸å¼€è¿™ä¸ªè¯é¢˜äº†ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œå®˜æ–¹æä¾›çš„<code>tabBar</code>æ–¹æ¡ˆå¹¶ä¸èƒ½æ»¡è¶³äº§å“éœ€æ±‚/uiè¦æ±‚ï¼Œå®˜æ–¹ä¹Ÿæä¾›äº†<a href="https://uniapp.dcloud.net.cn/collocation/pages.html#tabbar">è‡ªå®šä¹‰tabBar</a>çš„æ–¹æ¡ˆï¼Œä½†æ­¤æ–¹æ¡ˆæœ‰å¾ˆå¤šå¼Šç«¯ï¼Œæ¯”å¦‚ï¼šåˆ‡æ¢æ—¶å€™ä¼š<code>tabBar</code>ä¼šæœ‰æ˜æ˜¾çš„é—ªåŠ¨ã€‚å¯ä»¥å‚è€ƒä¹‹å‰å†™çš„æ–‡ç« <a href="https://juejin.cn/post/6976072584127315999">å°ç¨‹åºè‡ªå®šä¹‰TabBar å¦‚ä½•å®ç°â€œkeep-aliveâ€</a>ï¼Œæ–‡ç« ä¸­æ˜¯åŸç”Ÿå°ç¨‹åºï¼Œä½†æ€è·¯åœ¨<code>uni-app</code>ä¸­åŒæ ·é€‚ç”¨ï¼Œå¦‚æœæ„Ÿå…´è¶£ï¼Œå¯ä»¥è¯„è®ºåŒºæé—®ã€‚</p>
<h2 id="ç‰ˆæœ¬åˆ‡æ¢">ç‰ˆæœ¬åˆ‡æ¢</h2>
<p>å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œéœ€è¦æ ¹æ®ä¸åŒçš„ç¯å¢ƒå»åˆ‡æ¢ä¸åŒçš„è¯·æ±‚åŸŸåã€<code>APPID</code>ç­‰å­—æ®µï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡ç¯å¢ƒå˜é‡æ¥è¿›è¡ŒåŒºåˆ†ã€‚ä¸‹é¢æ¡ˆä¾‹æˆ‘ä»¬å°±åˆ†ä¸ºä¸‰ä¸ªç¯å¢ƒï¼šå¼€å‘ç¯å¢ƒ(<code>dev</code>)ã€æµ‹è¯•ç¯å¢ƒ(<code>test</code>)ã€ç”Ÿäº§ç¯å¢ƒ(<code>prod</code>)ã€‚</p>
<h3 id="å»ºç«‹envæ–‡ä»¶">å»ºç«‹<code>env</code>æ–‡ä»¶</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•å»ºç«‹ä¸‹é¢ä¸‰ä¸ªæ–‡ä»¶å¹¶å†™å…¥å†…å®¹(å¸¸é‡åè¦ä»¥VUEå¼€å¤´å‘½å)ï¼š</p>
<p><code>.env.dev</code>(å¼€å‘ç¯å¢ƒ)</p>
<pre><code class="language-ini">VUE_APP_MODE=build
VUE_APP_ID=wxbb53ae105735a06b
VUE_APP_BASE=https://www.baidu.dev.com
</code></pre>
<p><code>.env.test</code>(æµ‹è¯•ç¯å¢ƒ)</p>
<pre><code class="language-ini">VUE_APP_MODE=build
VUE_APP_ID=wxbb53ae105735a06c
VUE_APP_BASE=https://www.baidu.test.com
</code></pre>
<p><code>.env.prod</code>(ç”Ÿäº§ç¯å¢ƒ)</p>
<pre><code class="language-ini">VUE_APP_MODE=wxbb53ae105735a06d
VUE_APP_ID=prod
VUE_APP_BASE=https://www.baidu.prod.com
</code></pre>
<h3 id="ä¿®æ”¹packagejsonæ–‡ä»¶">ä¿®æ”¹<code>package.json</code>æ–‡ä»¶</h3>
<pre><code class="language-json">&quot;scripts&quot;: {
    &quot;dev:mp-weixin&quot;: &quot;cross-env UNI_PLATFORM=mp-weixin vue-cli-service uni-build --watch --mode dev&quot;,
    &quot;build:mp-weixin&quot;: &quot;cross-env UNI_PLATFORM=mp-weixin vue-cli-service uni-build --watch --mode prod&quot;
},
</code></pre>
<p>ç„¶åæ‰§è¡Œ</p>
<pre><code class="language-js">npm run dev:mp-weixin
</code></pre>
<p>åœ¨<code>/src/pages/index/index.vue</code>ä¸‹ï¼Œæ‰“å°ï¼š</p>
<pre><code class="language-js">onLoad() {
    console.log(process.env.VUE_APP_MODE, '====VUE_APP_BASE')
    console.log(process.env.VUE_APP_BASE, '====VUE_APP_BASE')
},
</code></pre>
<p>æ­¤æ—¶è¾“å‡ºç»“æœå°±æ˜¯</p>
<pre><code class="language-js">dev ====VUE_APP_BASE
https://www.baidu.dev.com ====VUE_APP_BASE
</code></pre>
<h2 id="åŠ¨æ€ä¿®æ”¹appid">åŠ¨æ€ä¿®æ”¹appid</h2>
<p>å¦‚æœåŒä¸€å¥—ä»£ç ï¼Œéœ€è¦æ‰“åŒ…ç”Ÿæˆå¤šä¸ªå°ç¨‹åºï¼Œå°±éœ€è¦åŠ¨æ€ä¿®æ”¹<code>appid</code>äº†ï¼›æ–‡ç« å¼€å¤´è¯´è¿‡appidåœ¨<code>/src/manifest.json</code>æ–‡ä»¶ä¸­é…ç½®ï¼Œä½†<code>json</code>æ–‡ä»¶åˆä¸èƒ½ç›´æ¥å†™å˜é‡ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å‚è€ƒ<a href="https://uniapp.dcloud.net.cn/collocation/vue-config.html">å®˜æ–¹</a> æå‡ºçš„è§£å†³æ–¹æ¡ˆï¼šå»ºç«‹<code>vue.config.js</code>æ–‡ä»¶ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ã€‚</p>
<p>åœ¨æ ¹ç›®å½•ä¸‹å»ºç«‹<code>vue.config.js</code>æ–‡ä»¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="language-js">// è¯»å– manifest.json ï¼Œä¿®æ”¹åé‡æ–°å†™å…¥
const fs = require('fs')

const manifestPath = './src/manifest.json'
let Manifest = fs.readFileSync(manifestPath, { encoding: 'utf-8' })
function replaceManifest(path, value) {
    const arr = path.split('.')
    const len = arr.length
    const lastItem = arr[len - 1]
    let i = 0
    let ManifestArr = Manifest.split(/\n/)
    for (let index = 0; index &lt; ManifestArr.length; index++) {
        const item = ManifestArr[index]
        if (new RegExp(`&quot;${arr[i]}&quot;`).test(item)) ++i
        if (i === len) {
            const hasComma = /,/.test(item)
            ManifestArr[index] = item.replace(
            new RegExp(`&quot;${lastItem}&quot;[\\s\\S]*:[\\s\\S]*`),
            `&quot;${lastItem}&quot;: ${value}${hasComma ? ',' : ''}`
            )
            break
        }
    }

Manifest = ManifestArr.join('\n')
}
// è¯»å–ç¯å¢ƒå˜é‡å†…å®¹
replaceManifest('mp-weixin.appid', `&quot;${process.env.VUE_APP_ID}&quot;`)

fs.writeFileSync(manifestPath, Manifest, {
  flag: 'w'
})
</code></pre>
<p>å¦‚æœæ˜¯é€šè¿‡<a href="https://zh.uniapp.dcloud.io/quickstart-hx.html">HBuilderX</a>å¯è§†åŒ–å·¥å…·åˆ›å»ºçš„é¡¹ç›®ï¼Œåˆ™æ— æ³•å»è‡ªåŠ¨æ ¹æ®ç¯å¢ƒå»ä¿®æ”¹<code>appid</code>ï¼Œåªèƒ½å»æ‰‹åŠ¨ä¿®æ”¹ã€‚</p>
<h2 id="ç»„ä»¶åº“">ç»„ä»¶åº“</h2>
<p><code>uni-app</code>æœ€å—æ¬¢è¿çš„å¯èƒ½å°±æ˜¯æ’ä»¶å¸‚åœºäº†ï¼Œæ’ä»¶å¸‚åœºæä¾›äº†å¾ˆå¤šä¼˜ç§€çš„æ’ä»¶/ç»„ä»¶åº“ä¾›æˆ‘ä»¬é€‰æ‹©ï¼Œæ¯”è¾ƒç«çš„å°±æ˜¯è‡ªå®¶çš„<a href="https://ext.dcloud.net.cn/plugin?id=55">uni-ui</a>ä»¥åŠ<a href="https://ext.dcloud.net.cn/plugin?id=1593">uView UI</a>ï¼Œå¤§éƒ¨åˆ†ç»„ä»¶è¿˜æ˜¯æ¯”è¾ƒå¥½ç”¨çš„ï¼Œå¦‚æœåšä¸­å¤§å‹é¡¹ç›®ä»¥åŠUIè¦æ±‚è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯æ¯”è¾ƒæ¨èè‡ªå·±æ­ä¸€å¥—ç»„ä»¶åº“ï¼Œæ–¹ä¾¿æ‰©å±•ä»¥åŠç»´æŠ¤ã€‚</p>
<h2 id="ç»“å°¾">ç»“å°¾</h2>
<p>å…³äº<code>uni-app</code>é¡¹ç›®çš„èµ·æ­¥å·¥ä½œå°±åˆ°è¿™é‡Œäº†ï¼Œåé¢æœ‰æœºä¼šå†™ä¸€å¥—å®Œæ•´çš„<code>uni</code>æ­å»ºç”µå•†å°ç¨‹åºé¡¹ç›®ï¼Œè®°å¾—å…³æ³¨ã€‚ä»£ç å·²ç»æäº¤åˆ°<a href="https://github.com/LonJinUp/uni-app-template">github</a>ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ç‚¹ä¸ª<code>star</code>!</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä¼˜ç§€æŠ€æœ¯åšå®¢çš„æŒç»­åˆ›ä½œæŠ€å·§]]></title>
        <id>https://lonjinup.github.io/blogstudy/</id>
        <link href="https://lonjinup.github.io/blogstudy/">
        </link>
        <updated>2023-01-15T06:46:45.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å¦‚ä½•å†™ä½œå¦‚ä½•æŒç»­æ€§åˆ›ä½œ">å¦‚ä½•å†™ä½œï¼Ÿå¦‚ä½•æŒç»­æ€§åˆ›ä½œ</h1>
<blockquote>
<p>æœ€è¿‘çœ‹äº†<code>å¼ é‘«æ—­</code>å¤§ä½¬å†™çš„<code>ã€ŠæŠ€æœ¯å†™ä½œæŒ‡å—ã€‹</code>ï¼›åœ¨è¿™é‡Œæ€»ç»“ä¸€ä¸‹ï¼Œé¡ºä¾¿èŠä¸€èŠå†™åšå®¢è¿™ä¸ªè¯é¢˜ã€‚</p>
</blockquote>
<h2 id="ä¸ºä»€ä¹ˆè¦å†™">ä¸ºä»€ä¹ˆè¦å†™</h2>
<p>å…³äºä¸ºä»€ä¹ˆè¦å†™åšå®¢ï¼Œæ¯ä¸ªäººéƒ½æœ‰ä¸åŒçš„ç­”æ¡ˆï¼›æœ‰çš„äººå¯èƒ½æ˜¯ä¸ºäº†è®°å½•ä¸€ä¸‹å­¦ä¹ æ€»ç»“ï¼Œæœ‰çš„äººå¯èƒ½æ˜¯å¸Œæœ›è‡ªå·±çš„æ–‡ç« å¯ä»¥ç»™åˆ«äººå¸¦æ¥ä¸€å®šçš„å¸®åŠ©ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸ºäº†è·å¾—ä¸€å®šçš„çŸ¥ååº¦ï¼Œå‘å±•è‡ªåª’ä½“ã€‚<br>
æˆ‘ä¸ºä»€ä¹ˆè¦å†™åšå®¢å‘¢ï¼Ÿè¿™å¾—ä»åˆšå…¥è¡Œè¯´èµ·äº†ã€‚åˆšå…¥è¡Œçš„å‰ä¸¤å¹´æ„Ÿè§‰éå¸¸è¿·èŒ«ï¼Œå‘†çš„å…¬å¸æŠ€æœ¯è€æ—§ï¼Œåªèƒ½åœ¨ä¸‹ç­æ—¶é—´å»è‡ªå·±å­¦ä¹ ï¼Œé‚£æ—¶å€™åŸºæœ¬éƒ½æ˜¯çœ‹åˆ«äººçš„è§†é¢‘è¯¾ç¨‹ï¼›å­¦ä¹ è¿‡ç¨‹ä¸­è®°å½•ç¬”è®°æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚å†åæ¥æ¥è§¦äº†<code>æ˜é‡‘</code>ï¼Œå‘ç°äº†å¾ˆå¤šä¼˜è´¨æ–‡ç« ï¼Œæ‰€ä»¥å†™åšå®¢çš„å¿µå¤´æ„ˆæ¼”æ„ˆçƒˆã€‚æ‰€ä»¥å°±åœ¨ç½‘ä¸Šç®€å•çš„æ­å»ºäº†ä¸€ä¸ªåšå®¢ã€‚</p>
<h2 id="å¦‚ä½•å®šæ ‡é¢˜">å¦‚ä½•å®šæ ‡é¢˜</h2>
<p>è™½ç„¶å¸¸è¯´<code>å†…å®¹ä¸ºç‹</code>ï¼Œä½†æ˜¯å¥½çš„æ ‡é¢˜èƒ½è®©ä½ çš„æ–‡ç« æœ‰æ›´å¤šçš„ç‚¹å‡»ç‡ï¼Œå¦‚æœæ ‡é¢˜ä¸å¸å¼•äººï¼Œé‚£ä¹ˆè¯»è€…å¯èƒ½éƒ½ä¸ä¼šç‚¹è¿›è¯¦æƒ…å»çœ‹ã€‚æˆ‘æƒ³å¾ˆå¤šäººèµ·æ ‡é¢˜æ—¶å€™éƒ½ä¼šå¤´ç–¼ï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿç»å¸¸å›°æ‰°ç€æˆ‘ï¼Œå¦‚ä½•èƒ½è®©æ ‡é¢˜æ›´æœ‰å¸å¼•åŠ›ã€‚ä¸‹é¢åˆ†äº«ä¸€ä¸‹æˆ‘èµ·æ ‡é¢˜çš„ä¸€äº›ç»éªŒå’Œæ–¹æ³•ã€‚</p>
<h3 id="æ ‡é¢˜ä¸æ–‡ç« å…³è”">æ ‡é¢˜ä¸æ–‡ç« å…³è”</h3>
<p>é¦–å…ˆæˆ‘å¾ˆè®¨åŒæ ‡é¢˜å…šï¼Œæ ‡é¢˜ä¸ºæ·±å…¥äº†è§£xxxxï¼Œç»“æœè¿›å»æŸ¥çœ‹æ–‡ç« æ²¡æœ‰ä¸€ç‚¹æ·±åº¦ï¼Œè¿™æ ·çš„æ–‡ç« å¾ˆè®©äººè®¨åŒï¼Œæ‰€ä»¥æˆ‘å»ºè®®æ–‡ç« æ ‡é¢˜æœ€èµ·ç è¦ç¬¦åˆå†…å®¹ã€‚åŒæ—¶æ ‡é¢˜å†…å°½é‡åŒ…å«æ•´ç¯‡æ–‡ç« çš„å…³é”®å­—ï¼Œè¿™æ ·ä¾¿äºæœç´¢å¼•æ“æŠ“å–ï¼ŒåŒæ—¶ä¹Ÿè€ƒè™‘ç”¨æˆ·æœç´¢ä¹ æƒ¯ã€‚ä¸‹é¢ç”¨æˆ‘ä¹‹å‰å†™çš„ä¸€ç¯‡æ–‡ç« <a href="https://juejin.cn/post/6963194943506645005">å°ç¨‹åºå®ç°TabBaråˆ›æ„åŠ¨ç”»(æ–‡æœ«é™„å®Œæ•´æºä»£ç )</a>æ¥ä¸¾ä¾‹å­ã€‚</p>
<p>å…ˆè§£æä¸€ä¸‹æ ‡é¢˜å…³é”®è¯ï¼š<code>å°ç¨‹åº</code>ã€<code>TabBar</code>ã€<code>åˆ›æ„åŠ¨ç”»</code>ã€<code>é™„å®Œæ•´æºä»£ç </code>ï¼Œè¿™ä¸ªæ ‡é¢˜åŸºæœ¬ä¸Šæ¶µç›–äº†æˆ‘ä¸Šé¢è®²çš„è¦é¢†ï¼Œè€Œä¸”å¾ˆç¬¦åˆç”¨æˆ·çš„æœç´¢ä¹ æƒ¯ï¼Œç”¨æˆ·æœç´¢<code>å°ç¨‹åºTabBaråŠ¨ç”»</code>ã€<code>å°ç¨‹åºTabBaræŠ€å·§</code>ç­‰åŸºæœ¬éƒ½å¯ä»¥æ˜¾ç¤ºåœ¨ç¬¬ä¸€ä½ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ef76b692bbe3454d9f8c4b860dbacaaf~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<h3 id="é€‚å½“æ€§çš„ä¿®é¥°">é€‚å½“æ€§çš„ä¿®é¥°</h3>
<p>å¦‚æœå‘å¸ƒåœ¨ç¬¬ä¸‰æ–¹å¹³å°ï¼Œæœ‰æ—¶å€™æ ‡é¢˜èµ·çš„å¤ªè¿‡æ­»æ¿ç‚¹å‡»ç‡å°‘çš„å¯æ€œï¼›åœ¨æ˜é‡‘ä¸Šçœ‹è¿‡ä¸å°‘ä¼˜ç§€çš„æ ‡é¢˜ï¼Œæœ¬äººè¿™æ–¹é¢ç»éªŒä¹Ÿä¸æ˜¯å¾ˆå¤šï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹æ˜é‡‘2022æ¦œå•ï¼š</p>
<figure data-type="image" tabindex="2"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fedee45199e84c7b94ae3be22232c3ce~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p>æ€»ç»“ä¸€ä¸‹ï¼šè¿™äº›æ ‡é¢˜è¦ä¹ˆæ˜¯ç–‘é—®å¥ï¼Ÿå¼•èµ·è¯»è€…çš„å¥½å¥‡å¿ƒï¼›è¦ä¹ˆå°±æ˜¯äº‹ä»¶çš„èµ·å› +è§£å†³æ–¹æ¡ˆ+ç»“æœã€‚</p>
<h3 id="ä½¿ç”¨é»‘ç§‘æŠ€">ä½¿ç”¨é»‘ç§‘æŠ€</h3>
<p>å‰æ®µæ—¶é—´å¤§ç«çš„<code>openai</code>ä¸å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†å—ï¼Ÿä¸‹é¢è¯•ä¸€ä¸‹æ•ˆæœï¼š</p>
<figure data-type="image" tabindex="3"><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df0aa31b0719449ba4ec4fa50e1ffdb2~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></figure>
<p>ä¼˜åŒ–è¿‡çš„æ ‡é¢˜ï¼ŒåŸºæœ¬ä¸Šæ¯”æˆ‘ä¹‹å‰èµ·çš„æ ‡é¢˜è¦å¥½ä¸€äº›ï¼Œå†è‡ªå·±ä¿®æ”¹ä¿®æ”¹å°±å¯ä»¥ç›´æ¥ç”¨äº†ã€‚</p>
<h2 id="å†™ä½œæ¡†æ¶">å†™ä½œæ¡†æ¶</h2>
<p>ä¸€ç¯‡å¥½æ–‡ç« ä¸€å®šå…·å¤‡ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<ul>
<li>1.æ–‡ç« è¿è´¯ï¼Œå‰åå‘¼åº”ï¼Œåœ¨æ•´ç¯‡æ–‡ç« ä¸­ï¼Œæ¯æ®µæ–‡å­—æœ€å¥½æœ‰ä¸€å®šçš„è¿è´¯æ€§ï¼Œä¹Ÿå°±æ˜¯å°æ—¶å€™å†™ä½œæ–‡è€å¸ˆç»å¸¸æåˆ°çš„æ‰¿ä¸Šå¯ä¸‹ã€‚</li>
<li>2.çªå‡ºé‡ç‚¹ï¼Œåœ¨å†™æ–‡ç« æ—¶å€™ä¸€å®šä¸è¦å¿˜äº†æ ¸å¿ƒä¸»é¢˜ï¼Œåˆ‡è®°ä¸è¦è„±ç¦»æ–‡ç« ä¸»é¢˜ã€‚æ‰€ä»¥åœ¨å†™æ–‡ç« ä¹‹å‰ï¼Œå¯ä»¥ç»™è‡ªå·±åˆ—ä¸€ä¸ªå¤§çº²ï¼Œé¿å…å†™ç€å†™ç€è·‘é¢˜äº†ã€‚</li>
</ul>
<h3 id="å…·ä½“çš„å†™ä½œå¥—è·¯">å…·ä½“çš„å†™ä½œå¥—è·¯</h3>
<p>ä¸‹é¢ç½—åˆ—äº†ä¸åŒç±»å‹æ–‡ç« çš„å†™ä½œæ¡†æ¶ï¼Œå¤§å®¶å†™æ–‡ç« æ—¶å€™å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š</p>
<h4 id="1æŠ€æœ¯ç§‘æ™®">1.æŠ€æœ¯ç§‘æ™®</h4>
<figure data-type="image" tabindex="4"><a href="https://imgse.com/i/pSQs941"><img src="https://s1.ax1x.com/2023/01/15/pSQs941.png" alt="pSQs941.png" loading="lazy"></a></figure>
<h3 id="2åŸç†å‰–æ">2.åŸç†å‰–æ</h3>
<figure data-type="image" tabindex="5"><a href="https://imgse.com/i/pSQsP9x"><img src="https://s1.ax1x.com/2023/01/15/pSQsP9x.png" alt="pSQsP9x.png" loading="lazy"></a></figure>
<h3 id="3åŠŸèƒ½å®ç°">3.åŠŸèƒ½å®ç°</h3>
<figure data-type="image" tabindex="6"><a href="https://imgse.com/i/pSQsSE9"><img src="https://s1.ax1x.com/2023/01/15/pSQsSE9.png" alt="pSQsSE9.png" loading="lazy"></a></figure>
<h3 id="4ä½¿ç”¨æ•™ç¨‹">4.ä½¿ç”¨æ•™ç¨‹</h3>
<figure data-type="image" tabindex="7"><a href="https://imgse.com/i/pSQrxHJ"><img src="https://s1.ax1x.com/2023/01/15/pSQrxHJ.png" alt="pSQrxHJ.png" loading="lazy"></a></figure>
<h3 id="5é—®é¢˜è§£å†³">5.é—®é¢˜è§£å†³</h3>
<figure data-type="image" tabindex="8"><a href="https://imgse.com/i/pSQspNR"><img src="https://s1.ax1x.com/2023/01/15/pSQspNR.png" alt="pSQspNR.png" loading="lazy"></a></figure>
<h2 id="å¦‚ä½•åšæŒ">å¦‚ä½•åšæŒ</h2>
<p>è¯´å®è¯ï¼ŒåšæŒä¸€ä¸ªäº‹æƒ…æ˜¯éå¸¸éš¾çš„ï¼Œå°¤å…¶æ˜¯å†™ä½œè¿™ç§äº‹æƒ…ã€‚å› ä¸ºå†™ä½œç»™ä½œè€…å¸¦æ¥çš„æ±‡æŠ¥/åé¦ˆçŸ­æœŸå†…è¡¨ç°ä¸å‡ºæ¥ï¼Œä¸€æ—¦æ²¡æœ‰ç»“æœåé¦ˆï¼Œæ…¢æ…¢å°±ä¼šå¤±å»å…´è¶£ã€‚æ¯”å¦‚æ¸¸æˆï¼›åœ¨æˆ‘ä»¬ç©æ¸¸æˆæ—¶å€™ä¸ºä»€ä¹ˆèƒ½å¤Ÿé‚£ä¹ˆä¸Šç˜¾å‘¢ï¼Ÿå› ä¸ºçŸ­æœŸå†…çš„ä»˜å‡ºéƒ½ä¼šå¸¦æ¥ä¸€å®šçš„ç»“æœåé¦ˆã€‚æ—¢ç„¶æˆ‘ä»¬å¯ä»¥ä¹æ­¤ä¸ç–²çš„ç©æ¸¸æˆã€åˆ·è§†é¢‘ã€è¿½å‰§ï¼Œé‚£ä¹ˆæˆ‘ç›¸ä¿¡ä¹Ÿå¯ä»¥è¿›è¡ŒåšæŒå†™ä½œã€‚</p>
<p>å…³äºè¿™æ–¹é¢çš„ç»éªŒï¼Œæœ¬äººä¹Ÿä¸æ˜¯å¾ˆå¤šï¼›ä»Šå¹´ä¹Ÿæ²¡å†™å‡ ç¯‡æ–‡ç« ã€‚ä¸è¿‡è¿˜æ˜¯åœ¨<code>2023</code>å¹´æ‰“ç®—åšæŒä¸€ä¸‹å†™ä½œã€‚è¿™é‡Œæˆ‘æ€»ç»“äº†ä¸€ä¸‹<code>å¼ é‘«æ—­</code>å¤§ä½¬æä¾›çš„æ–¹æ³•ï¼š</p>
<ul>
<li>å¤šå¤šå¥–åŠ±è‡ªå·±ï¼Œæ¯å†™å®Œä¸€ç¯‡æ–‡ç« ï¼Œéƒ½è¦ç»™è‡ªå·±ä¸€äº›å¥–åŠ±ï¼Œæ¯”æ–¹è¯´å¥–åŠ±è‡ªå·±ç©ä¸€ç›˜æ¸¸æˆ</li>
<li>å­¦ä¼šä»»åŠ¡åˆ†è§£ï¼Œæ¯”å¦‚æ¯å¤©ååœ°é“ä¸Šç­æ—¶å€™å…ˆç½—åˆ—ä¸€ä¸‹æ–‡ç« é€‰é¢˜/æ¡†æ¶ï¼Œåœ¨å…¬å¸æ‘¸é±¼æ—¶å€™å¯ä»¥æœé›†ä¸€ä¸‹ç›¸å…³èµ„æ–™ï¼Œä¸‹ç­åƒå®Œé¥­å†ä¸€æ°”å‘µæˆã€‚</li>
<li>æ•¢äºæ”¾çºµè‡ªå·±ï¼Œå¦‚æœå¹³æ—¶å·¥ä½œæˆ–è€…åŠ ç­å¤ªå¿™ï¼Œç¡®å®æ²¡æœ‰æ—¶é—´ï¼›ä¹Ÿä¸å¿…å‹‰å¼ºè‡ªå·±ï¼Œè¯¥æ”¾æ¾çš„æ—¶å€™å°±æ”¾æ¾ã€‚</li>
</ul>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>å†™æŠ€æœ¯ç±»åšå®¢ï¼Œå½“æ—¶å¯èƒ½ä¸ä¼šæœ‰ä»€ä¹ˆæŠ€æœ¯åé¦ˆï¼Œä½†æ˜¯åªè¦ä½ èƒ½åšæŒ<code>1å‘¨</code>ä¸€ç¯‡çš„ç¨³å®šæ›´æ–°ï¼Œ<code>2</code>å¹´å†…ç»å¯¹å¯ä»¥è¶…è¿‡ç»å¤§å¤šæ•°äººã€‚è€Œä¸”ä½ çš„åšå®¢æœ‰ä¸€å®šçš„æ›å…‰ï¼Œä¹Ÿå¯èƒ½ä¼šç»™ä½ å¸¦æ¥ä¸€äº›ä¸é”™çš„å·¥ä½œæœºä¼šã€‚ä¸ç®¡å‡ºäºä»€ä¹ˆåŸå› ï¼Œå¸Œæœ›å„ä½å¯ä»¥åšæŒè¾“å‡ºï¼ŒåŠ æ²¹å§ï¼</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[vuepressè‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°github]]></title>
        <id>https://lonjinup.github.io/vuepress-setting/</id>
        <link href="https://lonjinup.github.io/vuepress-setting/">
        </link>
        <updated>2022-12-12T13:53:53.000Z</updated>
        <content type="html"><![CDATA[<h1 id="vuepressè‡ªåŠ¨åŒ–éƒ¨ç½²github">vuepressè‡ªåŠ¨åŒ–éƒ¨ç½²github</h1>
<blockquote>
<p>æœ€è¿‘æ‰“ç®—æŠŠä¸€äº›é¡¹ç›®ä¸­å¸¸ç”¨çš„å‡½æ•°æ–¹æ³•ç»Ÿä¸€å°è£…ä¸€ä¸‹ï¼ŒåŒæ—¶å‘å¸ƒåˆ°npmï¼Œä»¥ä¾¿äºé¡¹ç›®ä¸­ä½¿ç”¨ã€‚<code>vuepress</code>ä½¿ç”¨ä¸Šç›¸å¯¹ç®€å•ï¼Œå°±ä¸åšè¿‡å¤šçš„æ¼”ç¤ºäº†ï¼Œè¿™é‡Œä¸»è¦è®²è§£ä¸€ä¸‹å¦‚ä½•è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°<code>github</code>,ç”Ÿæˆé¢„è§ˆåœ°å€ã€‚</p>
</blockquote>
<h2 id="ç”Ÿæˆtoken">ç”ŸæˆTOKEN</h2>
<ul>
<li>ç™»å½•<code>github</code>ï¼Œç‚¹å‡»å³ä¾§å¤´åƒ,ç‚¹å‡»Settings</li>
<li>å·¦ä¾§èœå•ä¸‹æ‰¾åˆ° Developer settingsï¼Œç‚¹å‡»è¿›å…¥</li>
<li>åœ¨ Personal access tokens åˆ†ç±»ä¸‹æ‰¾åˆ° Tokens (classic)ï¼Œç‚¹å‡»è¿›å…¥</li>
<li>ç‚¹å‡» Generate new token æŒ‰é’®ï¼Œç‚¹å‡» Generate new token (classic)</li>
<li>è®¾ç½® tokenåç§°ä¸º <code>ACCESS_TOKEN</code>ï¼ŒæŠŠç”Ÿæˆçš„tokenå¤åˆ¶ä¸€ä¸‹</li>
</ul>
<h2 id="è®¾ç½®token">è®¾ç½®TOKEN</h2>
<ul>
<li>è¿›è¯¥é¡¹ç›®çš„ä»“åº“ä¸­ï¼Œç‚¹å‡»settings</li>
<li>ç‚¹å‡»å·¦ä¾§ Secrets</li>
<li>ç‚¹å‡»å³ä¾§æŒ‰é’® new repository secret</li>
<li>åˆ›å»ºçš„åå­—å’Œ .yml ä¸­çš„ secret.xxx è¦å¯¹åº”ï¼Œå€¼å°±å†™åˆšåˆšç”Ÿæˆçš„ Github å¯†é’¥</li>
</ul>
<h2 id="åˆ›å»ºé…ç½®æ–‡ä»¶">åˆ›å»ºé…ç½®æ–‡ä»¶</h2>
<ul>
<li>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶</li>
</ul>
<pre><code class="language-js">.github/workflows/jekyll-gh-pages.yml
</code></pre>
<ul>
<li>æ·»åŠ é…ç½®</li>
</ul>
<pre><code class="language-yml"># action çš„åç§°
name: Deploy GitHub Pages

# è§¦å‘æ¡ä»¶ï¼šåœ¨ push åˆ° master åˆ†æ”¯å
on:
  push:
    branches:
      - master

# ä»»åŠ¡
jobs:
  build-and-deploy:
    # æœåŠ¡å™¨ç¯å¢ƒï¼šæœ€æ–°ç‰ˆ Ubuntu
    runs-on: ubuntu-latest
    steps:
      # æ‹‰å–ä»£ç 
      - name: Checkout
        uses: actions/checkout@v2
        with:
          persist-credentials: false

      # ç”Ÿæˆé™æ€æ–‡ä»¶
      - name: Build
        run: npm install &amp;&amp; npm run docs:build

      # éƒ¨ç½²åˆ° GitHub Pages
      - name: Deploy
        # ä½¿ç”¨åˆ«äººå†™å¥½çš„ä¸€ä¸ª action
        uses: JamesIves/github-pages-deploy-action@releases/v3
        with:
          # è¿™é‡Œçš„ ACCESS_TOKEN åå­—éœ€è¦å’Œä¸‹æ–‡ä¸­çš„ç›¸å¯¹åº”
          ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}
          # æ‰“åŒ…åçš„æ–‡ä»¶éƒ¨ç½²åˆ°å“ªä¸ªåˆ†æ”¯ä¸Š
          BRANCH: gh-pages
          # æ‰“åŒ…åçš„æ–‡ä»¶åœ¨å“ªé‡Œ
          FOLDER: docs/.vuepress/dist

</code></pre>
<h2 id="è®¾ç½®github-pages">è®¾ç½®GitHub Pages</h2>
<ul>
<li>è¿›è¯¥é¡¹ç›®çš„ä»“åº“ä¸­ï¼Œç‚¹å‡»settings</li>
<li>ç‚¹å‡»é¡¹ç›®å·¦ä¾§çš„Pages</li>
<li>æ‰¾åˆ°Build and deploymentè¿™ä¸€é¡¹ï¼ŒSourceé€‰æ‹©<code>Deploy from a branch</code></li>
<li>Branché€‰æ‹©<code>gh-pages</code> <code>/(root)</code>ç„¶åä¿å­˜å³å¯</li>
</ul>
<h2 id="ç»“å°¾">ç»“å°¾</h2>
<blockquote>
<p>åˆ°è¿™é‡Œå°±å·²ç»é…ç½®ç»“æŸäº†ï¼Œåªè¦masteråˆ†æ”¯æœ‰å˜åŒ–ï¼Œå°±ä¼šè‡ªåŠ¨åŒ–æ‰§è¡Œä¸€æ¬¡ï¼Œç”Ÿæˆæ–°çš„æ–‡æ¡£ã€‚</p>
</blockquote>
]]></content>
    </entry>
</feed>